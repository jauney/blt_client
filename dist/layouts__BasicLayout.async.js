(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"/5VO":function(e,t,a){"use strict";a("g9YV");var n=a("wCAj"),r=(a("+L6B"),a("2/Rp")),o=(a("P2fV"),a("NJEC")),l=a("gWZ8"),i=a.n(l),c=(a("2qtc"),a("kLXV")),s=(a("5NDa"),a("5rEg")),d=a("p0pE"),u=a.n(d),p=a("2Taf"),m=a.n(p),h=a("vZ4D"),f=a.n(h),y=a("l4Ni"),w=a.n(y),g=a("ujKo"),b=a.n(g),v=a("MhPg"),x=a.n(v),S=(a("y8nQ"),a("Vl3Y")),_=a("Y/ft"),C=a.n(_),E=a("q1tI"),k=a.n(E),L=a("ckwQ"),M=a.n(L),O=k.a.createContext(),D=function(e){var t=e.form,a=(e.index,C()(e,["form","index"]));return k.a.createElement(O.Provider,{value:t},k.a.createElement("tr",a))},V=S["a"].create()(D),I=function(e){function t(){var e,a;m()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=w()(this,(e=b()(t)).call.apply(e,[this].concat(r))),a.state={editing:!1},a.toggleEdit=function(){var e=!a.state.editing;a.setState({editing:e},function(){e&&a.input.focus()})},a.onRadioChange=function(e){console.log(e.target.value)},a.save=function(e){var t=a.props,n=t.record,r=t.handleSave;a.form.validateFields(function(t,a){console.log(a),t&&t[e.currentTarget.id]||r(u()({},n,a))})},a.renderCell=function(e){a.form=e;var t,n=a.props,r=n.children,o=n.dataIndex,l=n.record,i=n.title;a.state.editing;return console.log(o),t="mobile"==o?k.a.createElement(S["a"].Item,{style:{margin:0}},e.getFieldDecorator(o,{rules:[{required:!0,message:"".concat(i," is required.")}],initialValue:l[o]})(k.a.createElement(s["a"],{onBlur:a.save}))):r,t},a}return x()(t,e),f()(t,[{key:"render",value:function(){var e=this.props,t=(e.editable,e.dataIndex,e.title,e.record,e.index,e.handleSave,e.children,e.form,C()(e,["editable","dataIndex","title","record","index","handleSave","children","form"]));return k.a.createElement("td",t,k.a.createElement(O.Consumer,null,this.renderCell))}}]),t}(k.a.Component),T=function(e){function t(e){var a;m()(this,t),a=w()(this,b()(t).call(this,e)),a.notifyParantDataSource=function(e){var t=a.props.notifyDataSource;"function"==typeof t&&t(e)},a.handleDelete=function(e){var t=a.state,n=t.dataSource,r=void 0===n?[]:n,o=t.selectedRowKeys,l=void 0===o?[]:o;r=r.filter(function(t){return t.mobile_id!==e});var i=!1;r.forEach(function(e){1==e.mobile_type&&(i=!0)}),!i&&r.length>0&&(r[0].mobile_type=1,l=[r[0].mobile_id]),a.setState({dataSource:r,selectedRowKeys:l}),a.notifyParantDataSource(r)},a.handleAdd=function(){var e=a.state,t=e.count,n=e.dataSource,r=n.filter(function(e){return!e.mobile});if(r.length>0)c["a"].info({content:"\u8bf7\u586b\u5199\u65b0\u6dfb\u52a0\u7684\u624b\u673a\u53f7"});else{var o={mobile_id:"TMP-".concat((new Date).getTime()),mobile:"",mobile_type:0};a.setState({dataSource:[].concat(i()(n),[o]),count:t+1}),a.notifyParantDataSource([].concat(i()(n),[o]))}},a.handleSave=function(e){var t=i()(a.state.dataSource),n=t.findIndex(function(t){return e.mobile_id===t.mobile_id}),r=t[n];t.splice(n,1,u()({},r,e)),a.setState({dataSource:t}),a.notifyParantDataSource(t)},a.updateMobileType=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=a.state.dataSource,n=void 0===t?[]:t;n.forEach(function(t){e.includes(t.mobile_id)?t.mobile_type=1:t.mobile_type=0}),a.setState({dataSource:n}),a.notifyParantDataSource(n)},a.rowRadioSelected=function(e){var t=a.state.selectedRowKeys;t.length?-1===t.indexOf(e["mobile_id"])&&t.splice(0,1,e["mobile_id"]):t.push(e["mobile_id"]),a.updateMobileType(t),a.setState({selectedRowKeys:t})},a.onSelectedRowKeysChange=function(e){a.updateMobileType(e),a.setState({selectedRowKeys:e})};var n=e.dataSource||[],r=[];return n.forEach(function(e){1==e.mobile_type&&r.push(e.mobile_id)}),a.state={dataSource:n,count:n.length,selectedRowKeys:r},a.columns=[{title:"\u624b\u673a\u53f7",dataIndex:"mobile",width:"65%",editable:!0},{title:"\u64cd\u4f5c",dataIndex:"mobile_id",render:function(e,t){var n=a.state.dataSource,r=void 0===n?[]:n;return r.length>=1?k.a.createElement(o["a"],{title:"\u786e\u5b9a\u5220\u9664?",onConfirm:function(){return a.handleDelete(t.mobile_id)}},k.a.createElement("a",null,"\u5220\u9664")):null}}],a}return x()(t,e),f()(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.dataSource,o=t.selectedRowKeys,l={body:{row:V,cell:I}},i=this.columns.map(function(t){return t.editable?u()({},t,{onCell:function(a){return{record:a,editable:t.editable,dataIndex:t.dataIndex,title:t.title,handleSave:e.handleSave}}}):t}),c={selectedRowKeys:o,type:"radio",onChange:this.onSelectedRowKeysChange,columnTitle:"\u9ed8\u8ba4"};return k.a.createElement("div",null,k.a.createElement(n["a"],{components:l,rowClassName:function(){return"editable-row"},className:M.a.dataTable,bordered:!0,dataSource:a,columns:i,rowKey:"mobile_id",rowSelection:c,footer:function(){return k.a.createElement(r["a"],{onClick:e.handleAdd,type:"primary"},"\u6dfb\u52a0")}}))}}]),t}(k.a.Component);t["a"]=T},"0Vxr":function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d,u,p,m,h,f,y,w,g,b=a("bx4M"),v=(a("+L6B"),a("2/Rp")),x=a("p0pE"),S=a.n(x),_=(a("miYZ"),a("tsqr")),C=(a("iQDF"),a("+eQT")),E=(a("O3gP"),a("lrIw")),k=(a("2qtc"),a("kLXV")),L=a("d6i3"),M=a.n(L),O=a("1l/V"),D=a.n(O),V=(a("14J3"),a("BMrR")),I=(a("jCWc"),a("kPKH")),T=a("2Taf"),F=a.n(T),N=a("vZ4D"),A=a.n(N),R=a("l4Ni"),z=a.n(R),H=a("ujKo"),P=a.n(H),Y=a("MhPg"),j=a.n(Y),B=(a("7Kak"),a("9yH6")),q=(a("OaEy"),a("2fM7")),K=(a("5NDa"),a("5rEg")),U=(a("FJo9"),a("L41K")),Z=(a("y8nQ"),a("Vl3Y")),G=a("q1tI"),Q=a.n(G),X=a("MuoO"),W=a("wd/R"),J=a.n(W),$=a("CkN6"),ee=(a("zHco"),a("gA67")),te=a.n(ee),ae=(a("17x9"),a("S+eF"),a("XS0u")),ne=Z["a"].Item,re=(U["a"].Step,K["a"].TextArea,q["a"].Option),oe=(B["a"].Group,JSON.parse(localStorage.getItem("site")||"{}")),le=(JSON.parse(localStorage.getItem("user")||"{}"),n=Object(X["connect"])(function(e){var t=e.untrunkorder;return{untrunkorder:t}}),r=Z["a"].create(),n(o=r((l=function(e){function t(e){var a;return F()(this,t),a=z()(this,P()(t).call(this,e)),a.getModalContent=function(){var e=a.props,t=e.form.getFieldDecorator,n=e.receiverList;return Q.a.createElement(Z["a"],{layout:"inline"},Q.a.createElement(V["a"],{gutter:{md:8,lg:24,xl:48}},Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u63a5\u8d27\u4eba"},t("receiver_id",{})(Q.a.createElement(q["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"}},n.map(function(e){return Q.a.createElement(re,{key:e.courier_id,value:e.courier_id},e.courier_name)})))))))},a.onOkHandler=function(e){e.preventDefault();var t=a.props,n=t.dispatch,r=t.form,o=t.receiverList,l=t.selectedRows,i=t.onReceiverModalCancel;r.validateFields(function(){var e=D()(M.a.mark(function e(t,a){var r,c,s;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:return r=l.map(function(e){return e.order_id}),c=o.filter(function(e){if(e.courier_id==a.receiver_id)return e}),a.order_id=r,a.receiver_name=c[0]&&c[0].courier_name,console.log(a),e.next=9,n({type:"untrunkorder/changeOrderReceiverAction",payload:a});case 9:s=e.sent,0==s.code&&i();case 11:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a.state={},a}return j()(t,e),A()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onReceiverModalCancel;return Q.a.createElement(k["a"],{title:"\u66f4\u6539\u63a5\u8d27\u4eba",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",className:te.a.standardListForm,width:640,destroyOnClose:!0,visible:t,onOk:this.onOkHandler,onCancel:a},this.getModalContent())}}]),t}(G["PureComponent"]),o=l))||o),i=Object(X["connect"])(function(e){var t=e.trunkorder;return{trunkorder:t}}),c=Z["a"].create(),i(s=c((d=function(e){function t(e){var a;return F()(this,t),a=z()(this,P()(t).call(this,e)),a.onCarChange=function(e){for(var t,n=a.props,r=n.driverList,o=n.form,l=0;l<r.length;l++){var i=r[l];if(i.driver_plate==e){t=i;break}}t||o.setFieldsValue({driver_id:"",driver_name:"",driver_mobile:""})},a.onCarSelect=function(e,t){for(var n,r=t.props,o=a.props,l=o.driverList,i=o.form,c=0;c<l.length;c++){var s=l[c];if(s.driver_id==r.driverid){n=s;break}}n&&i.setFieldsValue({driver_name:n.driver_name,driver_mobile:n.driver_mobile})},a.renderCustomerOption=function(e){var t=E["a"].Option;return Q.a.createElement(t,{key:e.driver_id,driverid:e.driver_id,value:"".concat(e.driver_id),text:e.driver_plate},e.driver_plate)},a.getModalContent=function(){var e=a.props,t=e.form.getFieldDecorator,n=(e.branchCompanyList,e.currentCompany,e.driverList),r=e.lastCar,o={};return n.forEach(function(e){e.driver_id==r.driver_id&&Number(r.car_status)<3&&(o=e)}),Q.a.createElement(Z["a"],{layout:"inline",className:te.a.modalForm},Q.a.createElement(V["a"],{gutter:{md:8,lg:24,xl:48}},Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u8f66\u724c\u53f7"},t("driver_id",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u6536\u8f66\u724c\u53f7"}],initialValue:"".concat(r.driver_id||"")})(Q.a.createElement(E["a"],{size:"large",style:{width:"100%"},dataSource:n.map(a.renderCustomerOption),onSelect:a.onCarSelect,onChange:a.onCarChange,placeholder:"\u8bf7\u8f93\u5165",optionLabelProp:"text",filterOption:function(e,t){return-1!==t.props.children.indexOf(e)}}," ")))),Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u8f66\u4e3b\u59d3\u540d"},t("driver_name",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8f66\u4e3b\u59d3\u540d"}],initialValue:o.driver_name})(Q.a.createElement(K["a"],{placeholder:"\u8bf7\u8f93\u5165"}))))),Q.a.createElement(V["a"],null,Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u8054\u7cfb\u7535\u8bdd"},t("driver_mobile",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8054\u7cfb\u7535\u8bdd"}],initialValue:o.driver_mobile})(Q.a.createElement(K["a"],{placeholder:"\u8bf7\u8f93\u5165"})))),Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u8d27\u8f66\u7f16\u53f7"},t("car_code",{initialValue:r.car_code,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8d27\u8f66\u7f16\u53f7"}]})(Q.a.createElement(K["a"],{placeholder:"\u8bf7\u8f93\u5165",disabled:!0}))))),Q.a.createElement(V["a"],null,Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u62c9\u8d27\u65e5\u671f"},t("car_date",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u62c9\u8d27\u65e5\u671f"}],initialValue:J()((new Date).getTime())})(Q.a.createElement(C["a"],{placeholder:"\u8bf7\u9009\u62e9",format:"YYYY-MM-DD",style:{width:"100%"}})))),Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u8d27\u8f66\u8d39\u7528"},t("car_fee",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8d27\u8f66\u8d39\u7528"}],initialValue:r.car_fee||""})(Q.a.createElement(K["a"],{placeholder:"\u8bf7\u8f93\u5165"}))))))},a.onOkHandler=function(e){e.preventDefault();var t=a.props,n=(t.dispatch,t.form),r=t.driverList,o=void 0===r?[]:r,l=t.onOk;n.validateFields(function(){var e=D()(M.a.mark(function e(t,a){var n,r;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:n=a,n.car_date&&n.car_date.valueOf&&(n.car_date="".concat(n.car_date.valueOf())),r=o.filter(function(e){if(e.driver_id==n.driver_id)return e}),r.length<=0?(n.driver_plate=n.driver_id,n.driver_id=0):(n.driver_plate=r[0].driver_plate,n.driver_id=Number(n.driver_id)),n.car_fee=Number(n.car_fee||0),n.car_code=n.car_code+"",l(n);case 9:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a}return j()(t,e),A()(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancel;return Q.a.createElement(k["a"],{title:"\u8d27\u7269\u88c5\u8f66",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",className:te.a.standardListForm,width:700,destroyOnClose:!0,visible:t,onOk:this.onOkHandler,onCancel:a},this.getModalContent())}}]),t}(G["PureComponent"]),s=d))||s)||s),ie=(u=Object(X["connect"])(function(e){var t=e.trunkedorder;return{trunkedorder:t}}),p=Z["a"].create(),u(m=p((h=function(e){function t(e){var a;return F()(this,t),a=z()(this,P()(t).call(this,e)),a.getModalContent=function(){var e=a.props,t=e.form.getFieldDecorator,n=e.currentCompany,r=e.lastCar;return Q.a.createElement(Z["a"],{layout:"inline"},Q.a.createElement(V["a"],{gutter:{md:8,lg:24,xl:48}},Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u5206\u516c\u53f8"},n.company_name)),Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u8f66\u724c\u53f7"},r.driver_plate)),Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u8f66\u4e3b\u59d3\u540d"},r.driver_name)),Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u8054\u7cfb\u7535\u8bdd"},r.driver_mobile)),Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u8d27\u8f66\u7f16\u53f7"},r.car_code)),Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u62c9\u8d27\u65e5\u671f"},J()(Number(r.car_date||0)).format("YYYY-MM-DD HH:mm:ss"))),Q.a.createElement(I["a"],{md:12,sm:24},Q.a.createElement(ne,{label:"\u8d27\u8f66\u8d39\u7528"},t("car_fee",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8d27\u8f66\u8d39\u7528"}],initialValue:r.car_fee})(Q.a.createElement(K["a"],{placeholder:"\u8bf7\u8f93\u5165"}))))))},a.onOkHandler=function(e){e.preventDefault();var t=a.props,n=t.dispatch,r=t.form,o=t.onEntrunkModalCancel,l=t.lastCar,i=t.onSearch;r.validateFields(function(){var e=D()(M.a.mark(function e(t,a){var r;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:return a.car_fee=Number(a.car_fee),a.confirm=1,e.next=6,n({type:"trunkedorder/updateCarFeeAction",payload:{car:Object.assign(l,a)}});case 6:r=e.sent,0==r.code&&(_["a"].success("\u8fd0\u8d39\u7ed3\u7b97\u6210\u529f"),i(),o());case 8:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a.state={},a}return j()(t,e),A()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onEntrunkModalCancel;return Q.a.createElement(k["a"],{title:"\u8d27\u7269\u88c5\u8f66",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",className:te.a.standardListForm,width:700,destroyOnClose:!0,visible:t,onOk:this.onOkHandler,onCancel:a},this.getModalContent())}}]),t}(G["PureComponent"]),m=h))||m)||m),ce=(f=Object(X["connect"])(function(e){var t=e.customer,a=e.driver,n=e.company,r=e.trunkedorder,o=e.site,l=e.car,i=e.receiver,c=e.loading;return{customer:t,driver:a,company:n,trunkedorder:r,site:o,car:l,receiver:i,loading:c.models.rule}}),y=Z["a"].create(),f(w=y((g=function(e){function t(){var e,a;F()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=z()(this,(e=P()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],current:1,pageSize:20,entrunkModalVisible:!1,departModalVisible:!1,cancelDepartModalVisible:!1,arriveModalVisible:!1,cancelArriveModalVisible:!1,cancelEntrunkModalVisible:!1,currentCompany:{},currentShipSite:{}},a.columns=[{title:"\u8d27\u5355\u53f7",width:"80px",sorter:!0,dataIndex:"order_code",align:"right",render:function(e){return"".concat(e)},needTotal:!0},{title:"\u53d1\u8d27\u5ba2\u6237",width:"80px",sorter:!0,dataIndex:"sendcustomer_name"},{title:"\u6536\u83b7\u5ba2\u6237",width:"80px",sorter:!0,dataIndex:"getcustomer_name"},{title:"\u5e94\u6536\u8d27\u6b3e",width:"80px",sorter:!0,dataIndex:"order_amount"},{title:"\u5b9e\u6536\u8d27\u6b3e",width:"80px",sorter:!0,dataIndex:"order_real"},{title:"\u6298\u540e\u8fd0\u8d39",width:"80px",dataIndex:"trans_discount"},{title:"\u8fd0\u8d39\u65b9\u5f0f",width:"80px",dataIndex:"trans_type",sorter:!0,render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t}},{title:"\u57ab\u4ed8",width:"80px",dataIndex:"order_advancepay_amount"},{title:"\u9001\u8d27\u8d39",width:"80px",dataIndex:"deliver_amount"},{title:"\u4fdd\u4ef7\u8d39",width:"80px",dataIndex:"insurance_fee"},{title:"\u8d27\u7269\u540d\u79f0",width:"150px",dataIndex:"order_name"},{title:"\u5f55\u7968\u65f6\u95f4",width:"170px",dataIndex:"create_date",render:function(e){return Q.a.createElement("span",null,J()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss"))}},{title:"\u53d1\u8f66\u65f6\u95f4",width:"170px",dataIndex:"depart_date",render:function(e){return Q.a.createElement("span",null,J()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss"))}},{title:"\u7ad9\u70b9",width:"80px",dataIndex:"site_name"},{title:"\u4e2d\u8f6c",width:"80px",dataIndex:"transfer_type",render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t}},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.setCurrentCompany=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 2==ae["a"].company_type?(a.setState({currentCompany:ae["a"]}),ae["a"]):e&&e.length>0?(a.setState({currentCompany:e[0]}),e[0]):{}},a.getDriverList=function(){var e=a.props,t=e.dispatch,n=(e.form,a.state.currentCompany);t({type:"driver/getDriverListAction",payload:{pageNo:1,pageSize:500,company_id:n.company_id}})},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;a.getLastCarInfo(),o.validateFields(function(a,n){if(!a){Object.keys(n).forEach(function(e){n[e]||delete n[e]});var o=Object.assign({filter:n},e);r({type:"trunkedorder/getOrderListAction",payload:S()({pageNo:t||i,pageSize:c},o)}),r({type:"trunkedorder/getOrderStatisticAction",payload:S()({},o)})}})},a.handleStandardTableChange=function(){var e=D()(M.a.mark(function e(t,n,r){var o,l,i;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(o=a.state.pageSize,l={},i=1,r.field&&(l={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==o){e.next=10;break}return i=1,e.next=8,a.setState({pageSize:t.pageSize});case 8:e.next=11;break;case 10:t&&t.current&&(i=t.current);case 11:return e.next=13,a.setState({current:i});case 13:a.getOrderList(l,i);case 14:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.handleFormReset=function(){var e=a.props,t=e.form,n=e.dispatch;t.resetFields(),a.setState({formValues:{}}),n({type:"rule/fetch",payload:{}})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onCompanySelect=function(){var e=D()(M.a.mark(function e(t,n){var r,o,l;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,r.dispatch,o=r.company.branchCompanyList,r.form,l=o.filter(function(e){if(e.company_id==t)return e}),l.length>0&&a.setState({currentCompany:l[0]}),a.getLastCarInfo(),a.getDriverList();case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onShipSiteSelect=function(){var e=D()(M.a.mark(function e(t){var n,r,o,l,i;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.site.entrunkSiteList,r=void 0===n?[]:n,o={},l=0;case 3:if(!(l<r.length)){e.next=11;break}if(i=r[l],i.site_id!=t){e.next=8;break}return o=i,e.abrupt("break",11);case 8:l++,e.next=3;break;case 11:return e.next=13,a.setState({currentShipSite:o});case 13:a.getLastCarInfo();case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.getLastCarInfo=function(){var e=D()(M.a.mark(function e(t){var n,r,o,l,i,c,s,d,u,p,m;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.currentCompany,c=void 0===i?{}:i,s=l.currentShipSite,d=void 0===s?{}:s,u=o.getFieldValue("car_code"),p={company_id:t||c.company_id,shipsite_id:d.site_id},u&&(p.car_code=u),e.next=7,r({type:"car/getLastCarCodeAction",payload:p});case 7:return m=e.sent,e.abrupt("return",m);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.onCancelEntrunkOk=D()(M.a.mark(function e(){var t,n,r,o,l,i;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props,n=t.dispatch,r=t.car.lastCar,o=a.state.selectedRows,l=o.map(function(e){return e.order_id}),e.next=5,n({type:"trunkedorder/cancelEntrunkAction",payload:{order_id:l,car:r}});case 5:i=e.sent,0==i.code?(_["a"].success("\u53d6\u6d88\u88c5\u8f66\u6210\u529f\uff01"),a.onCancelEntrunkCancel()):_["a"].error(i.msg);case 7:case"end":return e.stop()}},e)})),a.onCancelEntrunk=D()(M.a.mark(function e(){var t,n;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.selectedRows,n=!0,t.forEach(function(e){e.order_status>=3&&(n=!1)}),n){e.next=6;break}return _["a"].error("\u5df2\u53d1\u8f66\u8ba2\u5355\u4e0d\u80fd\u53d6\u6d88\u88c5\u8f66"),e.abrupt("return");case 6:a.setState({cancelEntrunkModalVisible:!0});case 7:case"end":return e.stop()}},e)})),a.onCancelEntrunkCancel=D()(M.a.mark(function e(){return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelEntrunkModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDepark=D()(M.a.mark(function e(){return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({departModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDepartCancel=D()(M.a.mark(function e(){return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({departModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDepartOk=function(){var e=D()(M.a.mark(function e(t){var n,r,o,l,i,c,s;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props,r=n.dispatch,o=n.car.lastCar,l=a.state,i=l.currentCompany,c=l.currentShipSite,t.shipsite_id=c.site_id,t.shipsite_name=c.site_name,t.company_id=i.company_id,e.next=7,r({type:"trunkedorder/departOrderAction",payload:{car_id:o.car_id,car:t}});case 7:s=e.sent,0==s.code?(_["a"].success("\u53d1\u8f66\u6210\u529f\uff01"),a.getLastCarInfo(),a.onDepartCancel(),a.handleSearch()):_["a"].error(s.msg);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCancelDepark=D()(M.a.mark(function e(){return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelDepartModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onCancelDepartCancel=D()(M.a.mark(function e(){return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelDepartModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelDepartOk=D()(M.a.mark(function e(){var t,n,r,o,l;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props,n=t.dispatch,r=t.car.lastCar,o=a.state.currentCompany,e.next=4,n({type:"trunkedorder/updateCarStatusAction",payload:{car_id:r.car_id,car_status:2,car_code:r.car_code,company_id:o.company_id}});case 4:l=e.sent,0==l.code?(_["a"].success("\u53d6\u6d88\u53d1\u8f66\u6210\u529f\uff01"),a.getLastCarInfo(),a.onCancelDepartCancel()):_["a"].error(l.msg);case 6:case"end":return e.stop()}},e)})),a.onArrive=D()(M.a.mark(function e(){return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({arriveModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onArriveCancel=D()(M.a.mark(function e(){return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({arriveModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onArriveOk=D()(M.a.mark(function e(){var t,n,r,o,l,i,c;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props,n=t.dispatch,r=t.car.lastCar,o=a.state,l=o.currentCompany,i=o.currentShipSite,e.next=4,n({type:"trunkedorder/updateCarStatusAction",payload:{car_id:r.car_id,car_status:4,car_code:r.car_code,company_id:l.company_id,shipsite_id:i.site_id}});case 4:if(c=e.sent,0!=c.code){e.next=12;break}return _["a"].success("\u5230\u8f66\u786e\u8ba4\u6210\u529f\uff01"),e.next=9,n({type:"car/getLastCarCodeAction",payload:{company_id:l.company_id,shipsite_id:i.site_id}});case 9:a.onArriveCancel(),e.next=13;break;case 12:_["a"].error(c.msg);case 13:case"end":return e.stop()}},e)})),a.onCancelArrive=D()(M.a.mark(function e(){return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelArriveModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onCancelArriveCancel=D()(M.a.mark(function e(){return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelArriveModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelArriveOk=D()(M.a.mark(function e(){var t,n,r,o,l,i,c;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props,n=t.dispatch,r=t.car.lastCar,o=a.state,l=o.currentCompany,i=o.currentShipSite,e.next=4,n({type:"trunkedorder/updateCarStatusAction",payload:{car_id:r.car_id,car_status:3,car_code:r.car_code,company_id:l.company_id,shipsite_id:i.site_id}});case 4:if(c=e.sent,0!=c.code){e.next=12;break}return _["a"].success("\u53d6\u6d88\u5230\u8f66\u6210\u529f\uff01"),e.next=9,n({type:"car/getLastCarCodeAction",payload:{company_id:l.company_id,shipsite_id:i.site_id}});case 9:a.onCancelArriveCancel(),e.next=13;break;case 12:_["a"].error(c.msg);case 13:case"end":return e.stop()}},e)})),a.onCarFeeModalShow=function(){a.setState({entrunkModalVisible:!0})},a.onCancelCarFeeConfirmModalShow=function(){var e=a.props.car.lastCar;k["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u8981\u53d6\u6d88\u7b2c ".concat(e.car_code," \u8f66\u7684\u8fd0\u8d39\u4e48"),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onCancelCarFeeConfirm})},a.onCancelCarFeeConfirm=D()(M.a.mark(function e(){var t,n,r,o;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props,n=t.dispatch,r=t.car.lastCar,e.next=3,n({type:"trunkedorder/updateCarFeeAction",payload:{car:Object.assign(r,{confirm:0})}});case 3:o=e.sent,0==o.code&&(_["a"].success("\u53d6\u6d88\u8fd0\u8d39\u7ed3\u7b97\u6210\u529f"),a.getLastCarInfo());case 5:case"end":return e.stop()}},e)})),a.onEntrunkModalCancel=function(){a.setState({entrunkModalVisible:!1})},a.tableFooter=function(){var e=a.props.trunkedorder,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=e.totalInsurancefee,l=(e.totalRealTransAmount,e.totalRealOrderAmount,e.totalAdvancepayAmount),i=e.totalDeliverAmount;return Q.a.createElement("div",{className:te.a.tableFooter},Q.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),Q.a.createElement("span",{className:te.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),Q.a.createElement("span",{className:te.a.footerSplit},"\u57ab\u4ed8\u603b\u989d\uff1a",l||"0"),Q.a.createElement("span",{className:te.a.footerSplit},"\u9001\u8d27\u8d39\u603b\u989d\uff1a",i||"0"),Q.a.createElement("span",{className:te.a.footerSplit},"\u4fdd\u4ef7\u8d39\u603b\u989d\uff1a",o||"0"),Q.a.createElement("span",{className:te.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return j()(t,e),A()(t,[{key:"componentDidMount",value:function(){var e=D()(M.a.mark(function e(){var t,a,n,r;return M.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getCompanyList",payload:{}});case 3:return a=e.sent,e.next=6,t({type:"site/getSiteListAction",payload:{}});case 6:return n=e.sent,this.setCurrentCompany(a),n&&n.length>0&&(r=n.filter(function(e){return 3==e.site_type||2==e.site_type}),r.length>0&&this.setState({currentShipSite:r[0]})),e.next=11,this.getLastCarInfo();case 11:this.getOrderList(),this.getDriverList();case 13:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.company.branchCompanyList,n=e.site,r=n.entrunkSiteList,o=n.siteList,l=e.car.lastCar,i=void 0===l?{}:l,c=this.state,s=c.currentCompany,d=void 0===s?{}:s,u=c.currentShipSite,p=void 0===u?{}:u;return Q.a.createElement(Z["a"],{onSubmit:this.handleSearch,layout:"inline"},Q.a.createElement(ne,{label:"\u5206\u516c\u53f8"},t("company_id",{initialValue:d.company_id})(Q.a.createElement(q["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,allowClear:1==ae["a"].company_type,style:{width:"100px"}},(1==ae["a"].company_type?a:[ae["a"]]).map(function(e){return Q.a.createElement(re,{key:e.company_id,value:e.company_id},e.company_name)})))),1==ae["a"].company_type&&Q.a.createElement(ne,{label:"\u7ad9\u70b9"},t("site_id",{})(Q.a.createElement(q["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},allowClear:!0},(3!=oe.site_type?[oe]:o).map(function(e){return Q.a.createElement(re,{key:e.site_id,value:e.site_id},e.site_name)})))),Q.a.createElement(ne,{label:"\u914d\u8f7d\u90e8"},t("shipsite_id",{initialValue:p.site_id})(Q.a.createElement(q["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onShipSiteSelect,style:{width:"100px"},allowClear:!0},(r||[]).map(function(e){return Q.a.createElement(re,{key:e.site_id,value:e.site_id},e.site_name)})))),Q.a.createElement(ne,{label:"\u8d27\u8f66\u7f16\u53f7"},t("car_code",{initialValue:i.car_code})(Q.a.createElement(K["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"100px"}}))),Q.a.createElement(ne,null,Q.a.createElement(v["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.trunkedorder,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.company.branchCompanyList),l=t.car,i=l.carList,c=l.lastCar,s=t.driver.driverList,d=t.loading,u=this.state,p=u.selectedRows,m=u.current,h=u.pageSize,f=u.entrunkModalVisible,y=u.currentCompany,w=u.departModalVisible,g=u.cancelDepartModalVisible,x=u.arriveModalVisible,S=u.cancelArriveModalVisible,_=u.cancelEntrunkModalVisible,C=!0;return["site_searchuser"].indexOf(CacheRole.role_value)>=0&&(C=!1),c.car_status<2&&2==ae["a"].company_type&&(C=!1),Q.a.createElement("div",null,Q.a.createElement(b["a"],{bordered:!1},Q.a.createElement("div",{className:te.a.tableList},Q.a.createElement("div",{className:te.a.tableListForm},this.renderForm()),C&&Q.a.createElement("div",{className:te.a.tableListOperator},0==c.confirm&&2==ae["a"].company_type&&Q.a.createElement(v["a"],{type:"primary",onClick:this.onCarFeeModalShow},"\u8d27\u8f66\u8fd0\u8d39\u7ed3\u7b97"),1==c.confirm&&2==ae["a"].company_type&&Q.a.createElement(v["a"],{type:"primary",onClick:this.onCancelCarFeeConfirmModalShow},"\u53d6\u6d88\u8d27\u8f66\u8fd0\u8d39\u7ed3\u7b97"),c.car_status<3&&1==ae["a"].company_type&&Q.a.createElement(v["a"],{onClick:this.onDepark},"\u53d1\u8f66"),3==c.car_status&&1==ae["a"].company_type&&Q.a.createElement(v["a"],{onClick:this.onCancelDepark},"\u53d6\u6d88\u53d1\u8f66"),3==c.car_status&&1!=ae["a"].company_type&&Q.a.createElement(v["a"],{onClick:this.onArrive},"\u5230\u8f66\u786e\u8ba4"),4==c.car_status&&1!=ae["a"].company_type&&Q.a.createElement(v["a"],{onClick:this.onCancelArrive},"\u53d6\u6d88\u5230\u8f66"),p.length>0&&Q.a.createElement("span",null,1==ae["a"].company_type&&Q.a.createElement(v["a"],{onClick:this.onCancelEntrunk},"\u53d6\u6d88\u8d27\u7269\u88c5\u8f66"),Q.a.createElement(v["a"],{onClick:this.onPrintOrder},"\u8d27\u7269\u6e05\u5355\u6253\u5370"),Q.a.createElement(v["a"],{onClick:this.onDownloadOrder},"\u8d27\u7269\u6e05\u5355\u4e0b\u8f7d"))),Q.a.createElement($["a"],{className:te.a.dataTable,scroll:{x:900,y:350},selectedRows:p,loading:d,rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:h,current:m,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},rowClassNameHandler:function(e,t){return 6===e.order_status?te.a.settleColor:7===e.order_status?te.a.payColor:""},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange})),this.tableFooter()),Q.a.createElement(ie,{modalVisible:f,selectedRows:p,branchCompanyList:o,currentCompany:y,onEntrunkModalCancel:this.onEntrunkModalCancel,carList:i,lastCar:c,onSearch:this.handleSearch}),Q.a.createElement(le,{modalVisible:w,carList:i,lastCar:c,driverList:s,onOk:this.onDepartOk,onCancel:this.onDepartCancel}),Q.a.createElement(k["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:g,onOk:this.onCancelDepartOk,onCancel:this.onCancelDepartCancel},Q.a.createElement("p",null,"".concat(y.company_name,"\uff0c\u7b2c ").concat(c.car_code," \u8f66")),Q.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u53d1\u8f66\u4e48\uff1f")),Q.a.createElement(k["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:x,onOk:this.onArriveOk,onCancel:this.onArriveCancel},Q.a.createElement("p",null,"".concat(c.shipsite_name,"\u2014\u300b").concat(y.company_name,"\uff0c\u7b2c ").concat(c.car_code," \u8f66")),Q.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8be5\u8f66\u5df2\u7ecf\u62b5\u8fbe\u4e86\u4e48\uff1f")),Q.a.createElement(k["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:S,onOk:this.onCancelArriveOk,onCancel:this.onCancelArriveCancel},Q.a.createElement("p",null,"".concat(y.company_name,"\uff0c\u7b2c ").concat(c.car_code," \u8f66")),Q.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u8be5\u8f66\u62b5\u8fbe\u72b6\u6001\u4e48\uff1f")),Q.a.createElement(k["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:_,onOk:this.onCancelEntrunkOk,onCancel:this.onCancelEntrunkCancel},Q.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u53d6\u6d88\u52fe\u9009\u7684 ","".concat(p.length),"\u5355 \u8d27\u7269\u88c5\u8f66\u4e48\uff1f")))}}]),t}(G["PureComponent"]),w=g))||w)||w);t["default"]=ce},"0iT5":function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("miYZ"),a("tsqr")),p=a("d6i3"),m=a.n(p),h=a("1l/V"),f=a.n(h),y=(a("2qtc"),a("kLXV")),w=(a("5NDa"),a("5rEg")),g=a("jehZ"),b=a.n(g),v=(a("14J3"),a("BMrR")),x=(a("jCWc"),a("kPKH")),S=(a("+L6B"),a("2/Rp")),_=(a("O3gP"),a("lrIw")),C=a("p0pE"),E=a.n(C),k=a("2Taf"),L=a.n(k),M=a("vZ4D"),O=a.n(M),D=a("l4Ni"),V=a.n(D),I=a("ujKo"),T=a.n(I),F=a("MhPg"),N=a.n(F),A=(a("OaEy"),a("2fM7")),R=(a("y8nQ"),a("Vl3Y")),z=a("q1tI"),H=a.n(z),P=a("MuoO"),Y=a("wd/R"),j=a.n(Y),B=a("B797"),q=a("CkN6"),K=a("82qg"),U=a("b5ys"),Z=a.n(U),G=(a("S+eF"),a("XS0u")),Q=R["a"].Item,X=A["a"].Option,W=(n=R["a"].create(),n((o=function(e){function t(e){var a;return L()(this,t),a=V()(this,T()(t).call(this,e)),a.onAbnormalSelect=function(e,t){a.setState({abnormal_type_id:t.props.abnormal_type_id,abnormal_type:t.props.text})},a.onDownAccountHandler=function(){var e=a.props,t=e.onAddAbnormal,n=e.form,r=e.abnormalTypes,o=void 0===r?[]:r;n.validateFields(function(e,a){var n;e||(o.forEach(function(e){e.abnormal_type_id==a.abnormal_type_id&&(n=e)}),n||(n={abnormal_type:a.abnormal_type_id,abnormal_type_id:0}),t(E()({abnormal_reason:a.abnormal_reason},n)))})},a.renderCustomerOption=function(e){var t=_["a"].Option;return H.a.createElement(t,{key:e.abnormal_type_id,abnormal_type_id:e.abnormal_type_id,text:e.abnormal_type,value:"".concat(e.abnormal_type_id)},e.abnormal_type)},a.state={abnormal_type_id:"",abnormal_type:""},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return N()(t,e),O()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.downCancel,n=e.selectedRows,r=e.form,o=e.abnormalTypes;Object(B["b"])(n),n.length>0&&n[0],this.state.agencyFee;return H.a.createElement(y["a"],{destroyOnClose:!0,title:"\u4e0b\u8d26",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[H.a.createElement(S["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),H.a.createElement(S["a"],{key:"btn-save",type:"primary",onClick:this.onDownAccountHandler},"\u4fdd \u5b58")],width:800,className:Z.a.modalForm},H.a.createElement(R["a"],null,H.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(x["a"],null,H.a.createElement(Q,{labelCol:{span:3,offset:2},label:"\u5f02\u5e38\u5355\u53f7"},n.length))),H.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(x["a"],null,H.a.createElement(Q,b()({},this.formItemLayout,{label:"\u5f02\u5e38\u7c7b\u578b"}),r.getFieldDecorator("abnormal_type_id",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u5f02\u5e38\u7c7b\u578b"}]})(H.a.createElement(_["a"],{size:"large",style:{width:"100%"},dataSource:o.map(this.renderCustomerOption),onSelect:this.onAbnormalSelect,placeholder:"\u8bf7\u8f93\u5165",optionLabelProp:"text",filterOption:function(e,t){return-1!==t.props.children.indexOf(e)}}))))),H.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(x["a"],null,H.a.createElement(Q,{labelCol:{span:3,offset:2},label:"\u5f02\u5e38\u539f\u56e0"},r.getFieldDecorator("abnormal_reason",{initialValue:""})(H.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}})))))))}}]),t}(z["PureComponent"]),r=o))||r),J=(l=Object(P["connect"])(function(e){var t=e.common,a=e.customer,n=e.company,r=e.abnormal,o=e.site,l=e.car,i=e.receiver,c=e.loading;return{common:t,customer:a,company:n,abnormal:r,site:o,car:l,receiver:i,loading:c.models.rule}}),i=R["a"].create(),l(c=i((s=function(e){function t(){var e,a;L()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=V()(this,(e=T()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,settleModalVisible:!1,downModalVisible:!1,signModalVisible:!1,cancelSignModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1},a.columns=[{title:"\u8d27\u5355\u53f7",dataIndex:"order_code",width:"80px",align:"right",render:function(e){return"".concat(e)},needTotal:!0},{title:"\u53d1\u8d27\u5ba2\u6237",dataIndex:"sendcustomer_name",width:"80px"},{title:"\u6536\u83b7\u5ba2\u6237",dataIndex:"getcustomer_name",sorter:!0,width:"80px"},{title:"\u5e94\u6536\u8d27\u6b3e",dataIndex:"order_amount",width:"80px"},{title:"\u5b9e\u6536\u8d27\u6b3e",dataIndex:"order_real",width:"80px"},{title:"\u6298\u540e\u8fd0\u8d39",dataIndex:"trans_discount",width:"80px"},{title:"\u8fd0\u8d39\u65b9\u5f0f",dataIndex:"trans_type",width:"80px",render:function(e){return 1==e?"\u73b0\u4ed8":2==e?"\u56de\u4ed8":"\u63d0\u4ed8"}},{title:"\u57ab\u4ed8",dataIndex:"order_advancepay_amount",width:"80px"},{title:"\u9001\u8d27\u8d39",dataIndex:"deliver_amount",width:"80px"},{title:"\u4fdd\u4ef7\u8d39",dataIndex:"insurance_fee",width:"80px"},{title:"\u8d27\u7269\u540d\u79f0",dataIndex:"order_name",sorter:!0,width:"150px"},{title:"\u5f55\u7968\u65f6\u95f4",dataIndex:"create_date",width:"170px",render:function(e){return H.a.createElement("span",null,e&&j()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss"))}},{title:"\u7ad9\u70b9",dataIndex:"site_name",width:"80px"},{title:"\u4e2d\u8f6c",dataIndex:"transfer_type",width:"80px",render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t}},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.setCurrentCompany=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 2==G["a"].company_type?(a.setState({currentCompany:G["a"]}),G["a"]):e&&e.length>0?(a.setState({currentCompany:e[0]}),e[0]):{}},a.handleFormReset=function(){var e=a.props,t=e.form,n=e.dispatch;t.resetFields(),a.setState({formValues:{}}),n({type:"rule/fetch",payload:{}})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchGetCustomerList=function(){var e=f()(m.a.mark(function e(t){var n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=f()(m.a.mark(function e(t,n){var r,o;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.company.branchCompanyList,o=r.filter(function(e){if(e.company_id==t)return e}),o.length>0&&a.setState({currentCompany:o[0]});case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){n.order_status=[3,5],n.abnormal_status=0,Object.keys(n).forEach(function(e){n[e]||delete n[e]});var o=Object.assign({filter:n},e);r({type:"abnormal/getOrderListAction",payload:E()({pageNo:t||i,pageSize:c},o)}),r({type:"abnormal/getOrderStatisticAction",payload:E()({},o)})}})},a.handleStandardTableChange=function(){var e=f()(m.a.mark(function e(t,n,r){var o,l,i,c;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onAddAbnormal=function(){var e=f()(m.a.mark(function e(t){var n,r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.selectedRows,o=r.map(function(e){return e.order_id}),e.next=5,n({type:"abnormal/addAbnormalAction",payload:E()({abnormal_status:1,order_id:o},t)});case 5:l=e.sent,0==l.code?(u["a"].success("\u6dfb\u52a0\u5f02\u5e38\u6210\u529f\uff01"),a.handleSearch(),a.onAddAbnormalCancel()):u["a"].error(l.msg);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onAddAbnormalModal=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onAddAbnormalCancel=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrint=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=f()(m.a.mark(function e(){var t,n,r;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"settle/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(u["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):u["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=f()(m.a.mark(function e(){var t,n,r;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"settle/downloadAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(u["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):u["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onUpdateOrderModalShow()},a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.abnormal,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=e.totalInsurancefee,l=e.totalAdvancepayAmount,i=e.totalDeliverAmount;return H.a.createElement("div",{className:Z.a.tableFooter},H.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u57ab\u4ed8\u603b\u989d\uff1a",l||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u9001\u8d27\u8d39\u603b\u989d\uff1a",i||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u4fdd\u4ef7\u8d39\u603b\u989d\uff1a",o||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return N()(t,e),O()(t,[{key:"componentDidMount",value:function(){var e=f()(m.a.mark(function e(){var t,a,n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"abnormal/initOrderListAction"});case 3:return e.next=5,t({type:"company/getBranchCompanyList",payload:E()({},G["a"])});case 5:return a=e.sent,e.next=8,t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}});case 8:return e.sent,n=this.setCurrentCompany(a),e.next=12,t({type:"abnormal/getAbnormalTypeListAction",payload:{pageNo:1,pageSize:100,company_id:n.company_id}});case 12:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=(a.entrunkSiteList,a.siteList),r=e.company.branchCompanyList,o={};return r.length>0&&(o.initialValue=r[0].company_id||""),H.a.createElement(R["a"],{onSubmit:this.handleSearch,layout:"inline"},H.a.createElement(Q,{label:"\u5206\u516c\u53f8"},t("company_id",o)(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"}},r.map(function(e){return H.a.createElement(X,{key:e.company_id,value:e.company_id},e.company_name)})))),H.a.createElement(Q,{label:"\u8fd0\u5355\u53f7"},t("order_code",{})(H.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),H.a.createElement(Q,{label:"\u7ad9\u70b9"},t("site_id",{initialValue:G["c"].site_id})(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"}},n.map(function(e){return H.a.createElement(X,{key:e.site_id,value:e.site_id},e.site_name)})))),H.a.createElement(Q,null,H.a.createElement(S["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.abnormal,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.loading),l=t.abnormal.abnormalTypes,i=this.state,c=i.selectedRows,s=i.accountStatistic,u=i.current,p=i.pageSize,m=i.updateOrderModalVisible,h=i.settleModalVisible,f=i.downModalVisible,w=i.signModalVisible,g=i.cancelSignModalVisible,b=i.downloadModalVisible,v=i.printModalVisible,x=i.record,_=!0;return["site_searchuser"].indexOf(G["b"].role_value)>=0&&(_=!1),H.a.createElement("div",null,H.a.createElement(d["a"],{bordered:!1},H.a.createElement("div",{className:Z.a.tableList},H.a.createElement("div",{className:Z.a.tableListForm},this.renderForm()),H.a.createElement("div",{className:Z.a.tableListOperator},c.length>0&&_&&H.a.createElement("span",null,H.a.createElement(S["a"],{onClick:this.onAddAbnormalModal},"\u6dfb\u52a0\u4e3a\u5f02\u5e38"))),H.a.createElement(q["a"],{selectedRows:c,loading:o,className:Z.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:p,current:u,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick})),this.tableFooter()),H.a.createElement(K["a"],{modalVisible:m,record:x,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch}),H.a.createElement(W,{modalVisible:f,onAddAbnormal:this.onAddAbnormal,downCancel:this.onAddAbnormalCancel,selectedRows:c,abnormalTypes:l}),H.a.createElement(y["a"],{title:"\u53d6\u6d88\u7ed3\u8d26",visible:h,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:this.onSettleOk,onCancel:this.onSettleCancel},H.a.createElement("p",null,"\u53d6\u6d88\u7ed3\u7b97\u8d27\u6b3e\u6761\u6570".concat(c.length,"\uff0c\u53d6\u6d88\u7ed3\u7b97\u603b\u989d ").concat(s.totalAccount," ")),H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u4e48\uff1f")),H.a.createElement(y["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:w,onOk:this.onSignOk,onCancel:this.onSignCancel},H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7b7e\u5b57\u4e48\uff1f")),H.a.createElement(y["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:g,onOk:this.onCancelSignOk,onCancel:this.onCancelSignCancel},H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u7b7e\u5b57\u4e48\uff1f")),H.a.createElement(y["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:v,onOk:this.onPrintOk,onCancel:this.onPrintCancel},H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),H.a.createElement(y["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:b,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(z["PureComponent"]),c=s))||c)||c);t["default"]=J},"2uC3":function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=a("p0pE"),p=a.n(u),m=a("rlhR"),h=a.n(m),f=(a("2qtc"),a("kLXV")),y=(a("14J3"),a("BMrR")),w=(a("jCWc"),a("kPKH")),g=a("jehZ"),b=a.n(g),v=(a("5NDa"),a("5rEg")),x=(a("+L6B"),a("2/Rp")),S=a("d6i3"),_=a.n(S),C=(a("miYZ"),a("tsqr")),E=a("1l/V"),k=a.n(E),L=a("2Taf"),M=a.n(L),O=a("vZ4D"),D=a.n(O),V=a("l4Ni"),I=a.n(V),T=a("ujKo"),F=a.n(T),N=a("MhPg"),A=a.n(N),R=(a("OaEy"),a("2fM7")),z=(a("y8nQ"),a("Vl3Y")),H=(a("iQDF"),a("+eQT")),P=a("q1tI"),Y=a.n(P),j=a("MuoO"),B=(a("wd/R"),a("B797"),a("CkN6")),q=a("/5VO"),K=a("sOv7"),U=a.n(K),Z=(a("S+eF"),a("XS0u")),G=(H["a"].RangePicker,z["a"].Item),Q=R["a"].Option,X=(n=z["a"].create(),n((o=function(e){function t(e){var a;return M()(this,t),a=I()(this,F()(t).call(this,e)),a.onAddHandler=function(){var e,t=a.props,n=t.handleSearch,r=t.form,o=t.record,l=t.dispatch,i=t.onCancelModal,c=t.currentCompany,s=t.currentSite,d=t.customerTypes,u=a.state.dataSource,p=void 0===u?[]:u,m=p.length<=0?o.customerMobiles:p;m.forEach(function(t){t.mobile_id&&"".concat(t.mobile_id).indexOf("TMP-")>=0&&(t.mobile_id=0),1==t.mobile_type&&(e=t),delete t.__typename}),!e&&m.length>0&&(e=m[0],m[0].mobile_type=1),r.validateFields(function(){var t=k()(_.a.mark(function t(a,r){var u,p,h;return _.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=2;break}return t.abrupt("return");case 2:if(r.customer_mobile=e&&e.mobile||"",r.customerMobiles=m,r.company_id=c.company_id,r.site_id=s.site_id||0,d.forEach(function(e){e.customertype==r.customer_type&&(u=e)}),!u&&d.length>0&&(u=d[0]),u&&(r.customer_type=u.customertype,r.customertype_name=u.customertype_name,r.trans_vip_ratio=u.trans_vip_ratio),h="\u6dfb\u52a0\u6210\u529f",o&&o.customer_id){t.next=16;break}return t.next=13,l({type:"customer/createCustomerAction",payload:{customer:r,type:1}});case 13:p=t.sent,t.next=20;break;case 16:return t.next=18,l({type:"customer/updateCustomerAction",payload:{customer_id:[o.customer_id],customer:r,type:1}});case 18:p=t.sent,h="\u4fee\u6539\u6210\u529f";case 20:p&&0==p.code?(i(),n(),C["a"].success(h)):C["a"].error("\u6dfb\u52a0\u5931\u8d25");case 21:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}())},a.notifyDataSource=function(e){console.log(99988888),a.setState({dataSource:e})},a.state={dataSource:[]},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a.col2Layout={md:10,sm:26},a}return A()(t,e),D()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelModal,n=e.record,r=e.form,o=(e.mobileList,e.customerTypes),l=void 0===o?[]:o;return console.log(n),Y.a.createElement(f["a"],{destroyOnClose:!0,title:"\u6dfb\u52a0\u53d1\u8d27\u5ba2\u6237",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[Y.a.createElement(x["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),Y.a.createElement(x["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:U.a.modalForm},Y.a.createElement(z["a"],null,Y.a.createElement(y["a"],{gutter:{md:8,lg:24,xl:48}},Y.a.createElement(w["a"],this.col2Layout,Y.a.createElement(G,b()({},this.formItemLayout,{label:"\u59d3\u540d"}),r.getFieldDecorator("customer_name",{initialValue:n.customer_name,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u59d3\u540d"}]})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}})))),Y.a.createElement(w["a"],this.col2Layout,Y.a.createElement(G,b()({},this.formItemLayout,{label:"\u7c7b\u578b"}),r.getFieldDecorator("customer_type",{initialValue:n.customer_type})(Y.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"},allowClear:!0},l.map(function(e){return Y.a.createElement(Q,{key:e.customertype,value:e.customertype},e.customertype_name)})))))),Y.a.createElement(y["a"],{gutter:{md:8,lg:24,xl:48}},Y.a.createElement(w["a"],this.col2Layout,Y.a.createElement(G,b()({},this.formItemLayout,{label:"\u8d26\u6237"}),r.getFieldDecorator("bank_account",{initialValue:n.bank_account})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"200px"}})))),Y.a.createElement(w["a"],this.col2Layout,Y.a.createElement(G,b()({},this.formItemLayout,{label:"\u5730\u5740"}),r.getFieldDecorator("customer_address",{initialValue:n.customer_address})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"250px"}}))))),Y.a.createElement(y["a"],{gutter:{md:8,lg:24,xl:48}},Y.a.createElement(w["a"],this.col2Layout,Y.a.createElement(G,b()({},this.formItemLayout,{label:"\u767b\u5f55\u8d26\u53f7"}),r.getFieldDecorator("username",{initialValue:n.username})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}})))),Y.a.createElement(w["a"],this.col2Layout,Y.a.createElement(G,b()({},this.formItemLayout,{label:"\u5bc6\u7801"}),r.getFieldDecorator("password",{initialValue:n.password})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))))),Y.a.createElement(y["a"],{gutter:{md:8,lg:24,xl:48}},Y.a.createElement(w["a"],{span:20},Y.a.createElement(G,{wrapperCol:{span:16},labelCol:{span:4},label:"\u5907\u6ce8"},r.getFieldDecorator("remark",{initialValue:n.remark})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),Y.a.createElement(y["a"],{gutter:{md:8,lg:24,xl:48}},Y.a.createElement(w["a"],{span:20},Y.a.createElement(G,{wrapperCol:{span:16},labelCol:{span:4},label:"\u624b\u673a\u53f7"},Y.a.createElement(q["a"],{dataSource:n.customerMobiles,notifyDataSource:this.notifyDataSource}))))))}}]),t}(P["PureComponent"]),r=o))||r),W=(l=Object(j["connect"])(function(e){var t=e.customer,a=e.company,n=e.site,r=e.receiver,o=e.loading;return{customer:t,company:a,site:n,receiver:r,loading:o.models.rule}}),i=z["a"].create(),l(c=i((s=function(e){function t(){var e,a;M()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=I()(this,(e=F()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},addModalVisible:!1,currentCompany:{},currentSite:{}},a.columns=[{title:"\u5ba2\u6237\u7c7b\u578b",dataIndex:"customertype_name",sorter:!0,align:"right",width:"80px"},{title:"\u59d3\u540d",dataIndex:"customer_name",width:"80px"},{title:"\u7535\u8bdd",dataIndex:"customer_mobile",width:"100px"},{title:"\u8d26\u6237",dataIndex:"bank_account",width:"150px"},{title:"\u7ad9\u70b9",dataIndex:"site_names",width:"100px",sorter:!0,render:function(e){return"".concat(e)}},{title:"\u8fd0\u8d39\u603b\u989d",dataIndex:"total_trans",width:"80px",sorter:!0},{title:"\u7968\u6570",dataIndex:"order_num",width:"80px",sorter:!0},{title:"\u6536\u8d27\u5730\u5740",dataIndex:"customer_address",width:"150px"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchGetCustomerList=function(){var e=k()(_.a.mark(function e(t){var n;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onSiteSelect=function(){var e=k()(_.a.mark(function e(t,n){var r,o;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.site.siteList,o=void 0===r?[]:r,o.forEach(function(e){e.site_id==t&&a.setState({currentCompany:{company_id:e.company_id},currentSite:e})});case 2:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.setState({current:1}),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){var o=Object.assign({filter:n,type:1},e);r({type:"customer/queryCustomerListAction",payload:p()({pageNo:t||i,pageSize:c},o)})}})},a.handleStandardTableChange=function(){var e=k()(_.a.mark(function e(t,n,r){var o,l,i,c;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onAddModalShow=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",t=a.state,n=t.currentCompany,r=t.currentSite,o=void 0===r?{}:r;if(n.company_id){if("edit"!=e){if(!o.site_id)return void f["a"].info({content:"\u8bf7\u5148\u9009\u62e9\u7ad9\u70b9"});a.setState({record:{}})}a.setState({addModalVisible:!0})}else f["a"].info({content:"\u8bf7\u5148\u9009\u62e9\u5206\u516c\u53f8"})},a.onAddModalCancel=function(){a.setState({addModalVisible:!1})},a.onDelCustomer=function(){var e=a.props.dispatch,t=a.state.selectedRows,n=(h()(a),[]);t.forEach(function(e){n.push(e.customer_id)}),f["a"].confirm({content:"\u786e\u5b9a\u5220\u9664\u6240\u9009\u8bb0\u5f55\u4e48\uff1f",onOk:function(){var t=k()(_.a.mark(function t(){var r;return _.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e({type:"customer/updateCustomerAction",payload:{customer:{is_delete:1},customer_id:n,type:1}});case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:r=t.t0,0==r.code?(C["a"].success("\u5220\u9664\u5ba2\u6237\u6210\u529f\uff01"),a.handleSearch()):C["a"].error(r.msg);case 7:case"end":return t.stop()}},t)}));function r(){return t.apply(this,arguments)}return r}()})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onAddModalShow("edit")},a.onRowClick=function(e,t,a){},a}return A()(t,e),D()(t,[{key:"componentDidMount",value:function(){var e=k()(_.a.mark(function e(){var t,a;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,this.setState({currentCompany:Z["a"]}),e.next=4,t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}});case 4:a=e.sent,a&&a.length>0&&this.setState({currentSite:a[0]}),t({type:"customer/queryCustomerTypesAction",payload:{pageNo:1,pageSize:100}}),this.getOrderList();case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=(a.entrunkSiteList,a.siteList),r=void 0===n?[]:n,o=e.customer,l=(o.getCustomerList,o.sendCustomerList,o.customerTypes);return Y.a.createElement(z["a"],{onSubmit:this.handleSearch,layout:"inline"},Y.a.createElement(G,{label:"\u5ba2\u6237\u5206\u7c7b"},t("customer_type",{})(Y.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},allowClear:!0},l.map(function(e){return Y.a.createElement(Q,{key:e.customertype,value:e.customertype},e.customertype_name)})))),Y.a.createElement(G,{label:"\u7ad9\u70b9"},t("site_id",{initialValue:Z["c"].site_id})(Y.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},onSelect:this.onSiteSelect,allowClear:!0},(3==Z["c"].site_type?r:[Z["c"]]).map(function(e){return Y.a.createElement(Q,{key:e.site_id,value:e.site_id},e.site_name)})))),Y.a.createElement(G,{label:"\u59d3\u540d"},t("customer_name",{})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"100px"}}))),Y.a.createElement(G,{label:"\u7535\u8bdd"},t("customer_mobile",{})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),Y.a.createElement(G,null,Y.a.createElement(x["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.customer,n=a.customers,r=a.total,o=a.customerTypes,l=t.loading,i=t.dispatch,c=this.state,s=c.selectedRows,u=c.current,p=c.pageSize,m=c.addModalVisible,h=c.record,f=c.currentCompany,y=c.currentSite,w=!0;return["site_searchuser"].indexOf(Z["b"].role_value)>=0&&(w=!1),Y.a.createElement("div",null,Y.a.createElement(d["a"],{bordered:!1},Y.a.createElement("div",{className:U.a.tableList},Y.a.createElement("div",{className:U.a.tableListForm},this.renderForm()),Y.a.createElement("div",{className:U.a.tableListOperator},w&&Y.a.createElement(x["a"],{onClick:this.onAddModalShow},"\u6dfb\u52a0"),s.length>0&&w&&Y.a.createElement("span",null,Y.a.createElement(x["a"],{onClick:this.onDelCustomer},"\u5220\u9664"))),Y.a.createElement(B["a"],{selectedRows:s,loading:l,className:U.a.dataTable,scroll:{x:900,y:350},rowKey:"customer_id",data:{list:n,pagination:{total:r,pageSize:p,current:u,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,footer:function(){return""}}))),Y.a.createElement(X,{modalVisible:m,record:h,dispatch:i,onCancelModal:this.onAddModalCancel,handleSearch:this.handleSearch,currentCompany:f,currentSite:y,customerTypes:o}))}}]),t}(P["PureComponent"]),c=s))||c)||c);t["default"]=W},"3x83":function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("iQDF"),a("+eQT")),p=(a("miYZ"),a("tsqr")),m=a("p0pE"),h=a.n(m),f=a("d6i3"),y=a.n(f),w=a("1l/V"),g=a.n(w),b=a("rlhR"),v=a.n(b),x=(a("2qtc"),a("kLXV")),S=(a("5NDa"),a("5rEg")),_=(a("14J3"),a("BMrR")),C=(a("jCWc"),a("kPKH")),E=(a("+L6B"),a("2/Rp")),k=a("2Taf"),L=a.n(k),M=a("vZ4D"),O=a.n(M),D=a("l4Ni"),V=a.n(D),I=a("ujKo"),T=a.n(I),F=a("MhPg"),N=a.n(F),A=(a("OaEy"),a("2fM7")),R=(a("y8nQ"),a("Vl3Y")),z=a("q1tI"),H=a.n(z),P=a("MuoO"),Y=a("wd/R"),j=a.n(Y),B=a("B797"),q=a("CkN6"),K=a("82qg"),U=a("ZeH8"),Z=a.n(U),G=(a("S+eF"),a("XS0u")),Q=R["a"].Item,X=A["a"].Option,W=(n=R["a"].create(),n((o=function(e){function t(e){var a;return L()(this,t),a=V()(this,T()(t).call(this,e)),a.onAgencyFeeSelect=function(e,t){a.setState({agencyFee:parseFloat(e)})},a.onDownAccountHandler=function(){var e=a.props,t=e.downAccountHandle,n=e.form,r=a.state.agencyFee;n.validateFields(function(e,a){console.log(a),e||t({rate:r,bank_account:a.bank_account})})},a.state={agencyFee:0},a}return N()(t,e),O()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.downCancel,n=e.selectedRows,r=e.form,o=Object(B["b"])(n),l=n.length>0?n[0]:{},i=this.state.agencyFee;return H.a.createElement(x["a"],{destroyOnClose:!0,title:"\u4e0b\u8d26",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[H.a.createElement(E["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),H.a.createElement(E["a"],{key:"btn-save",type:"primary",onClick:this.onDownAccountHandler},"\u4fdd \u5b58")],width:800,className:Z.a.modalForm},H.a.createElement(R["a"],null,H.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(C["a"],null,H.a.createElement(Q,{labelCol:{span:3,offset:2},label:"\u4e0b\u8d26\u6761\u6570"},n.length))),H.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(C["a"],null,H.a.createElement(Q,{labelCol:{span:3,offset:2},label:"\u4e0b\u8d26\u603b\u91d1\u989d"},o.totalActualGoodsFund||"0"," - \u4ee3\u529e\u8d39 *",H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",defaultValue:"0",onSelect:this.onAgencyFeeSelect,style:{width:"80px"}},H.a.createElement(X,{value:"0"},"0\u2030"),H.a.createElement(X,{value:"1"},"1\u2030"),H.a.createElement(X,{value:"2"},"2\u2030"),H.a.createElement(X,{value:"3"},"3\u2030"),H.a.createElement(X,{value:"4"},"4\u2030"),H.a.createElement(X,{value:"5"},"5\u2030")),o.totalTransFunds?H.a.createElement("span",null," `- (\u8fd0\u8d39) $",o.totalTransFunds,"`"):H.a.createElement("span",null),"="," ",o.totalActualGoodsFund-Math.ceil(o.totalActualGoodsFund*i/1e3)-o.totalTransFunds||0))),H.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(C["a"],null,H.a.createElement(Q,{labelCol:{span:3,offset:2},label:"\u6237\u4e3b"},l.getcustomer_name||"")),H.a.createElement(C["a"],null,H.a.createElement(Q,{labelCol:{span:3,offset:2},label:"\u8d26\u6237"},r.getFieldDecorator("bank_account",{initialValue:l.bank_account})(H.a.createElement(S["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),H.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(C["a"],null,H.a.createElement(Q,{labelCol:{span:3,offset:2},className:Z.a.tableDetail,label:"\u660e\u7ec6"},H.a.createElement("table",null,H.a.createElement("thead",null,H.a.createElement("tr",null,H.a.createElement("th",null,"\u8fd0\u5355\u53f7"),H.a.createElement("th",null,"\u5b9e\u6536\u8d27\u6b3e"),H.a.createElement("th",null,"\u5e94\u6536\u8d27\u6b3e"))),H.a.createElement("tbody",null,n.map(function(e){return H.a.createElement("tr",null,H.a.createElement("td",null,e.order_code),H.a.createElement("td",null,e.order_real),H.a.createElement("td",null,e.order_amount))}))))))))}}]),t}(z["PureComponent"]),r=o))||r),J=(l=Object(P["connect"])(function(e){var t=e.customer,a=e.company,n=e.pay,r=e.site,o=e.car,l=e.receiver,i=e.loading;return{customer:t,company:a,pay:n,site:r,car:o,receiver:l,loading:i.models.rule}}),i=R["a"].create(),l(c=i((s=function(e){function t(){var e,a;L()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=V()(this,(e=T()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,settleModalVisible:!1,downModalVisible:!1,signModalVisible:!1,cancelDownAccountModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1,currentCompany:{}},a.columns=[{title:"\u8d27\u5355\u53f7",dataIndex:"order_code",sorter:!0,align:"right",render:function(e){return"".concat(e)},needTotal:!0,width:"80px"},{title:"\u53d1\u8d27\u5ba2\u6237",dataIndex:"sendcustomer_name",width:"80px",sorter:!0},{title:"\u6536\u83b7\u5ba2\u6237",dataIndex:"getcustomer_name",sorter:!0,width:"80px"},{title:"\u5e94\u6536\u8d27\u6b3e",dataIndex:"order_amount",sorter:!0,width:"80px"},{title:"\u5b9e\u6536\u8d27\u6b3e",dataIndex:"order_real",sorter:!0,width:"80px"},{title:"\u5b9e\u6536\u8fd0\u8d39",dataIndex:"trans_discount",sorter:!0,width:"80px"},{title:"\u8fd0\u8d39\u65b9\u5f0f",dataIndex:"trans_type",sorter:!0,render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t},width:"80px"},{title:"\u57ab\u4ed8",dataIndex:"order_advancepay_amount",width:"80px"},{title:"\u9001\u8d27\u8d39",dataIndex:"deliver_amount",width:"80px"},{title:"\u4fdd\u4ef7\u8d39",dataIndex:"insurance_fee",width:"80px"},{title:"\u8d27\u7269\u540d\u79f0",dataIndex:"order_name",width:"150px"},{title:"\u5f55\u7968\u65f6\u95f4",dataIndex:"create_date",render:function(e){return H.a.createElement("span",null,e&&j()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"170px"},{title:"\u7ed3\u7b97\u65f6\u95f4",dataIndex:"settle_date",render:function(e){return H.a.createElement("span",null,e&&j()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"170px"},{title:"\u4ed8\u6b3e\u65f6\u95f4",dataIndex:"pay_date",render:function(e){return H.a.createElement("span",null,e&&j()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"170px"},{title:"\u7ad9\u70b9",dataIndex:"site_name",width:"80px"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onSendCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchSendCustomerList()},a.fetchSendCustomerList=function(){var e=g()(y.a.mark(function e(t){var n;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/sendCustomerListAction",payload:{filter:{}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=g()(y.a.mark(function e(t,a){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){n.order_amount=-1,n.order_status=7,n.pay_date?n.pay_date=n.pay_date.valueOf():delete n.pay_date;var o=Object.assign({filter:n},e);r({type:"pay/getOrderListAction",payload:h()({pageNo:t||i,pageSize:c},o)}),r({type:"pay/getOrderStatisticAction",payload:h()({},o)})}})},a.handleStandardTableChange=function(){var e=g()(y.a.mark(function e(t,n,r){var o,l,i,c;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.downAccountHandle=function(){var e=g()(y.a.mark(function e(t){var n,r,o,l;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.selectedRows,o=r.map(function(e){return e.order_id}),e.next=5,n({type:"pay/downAccountAction",payload:{order_id:o,rate:t.rate,bank_account:t.bank_account}});case 5:l=e.sent,0==l.code?(p["a"].success("\u4e0b\u8d26\u6210\u529f\uff01"),a.onDownCancel(),a.handleSearch()):p["a"].error(l.msg);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onDownAccount=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettle=g()(y.a.mark(function e(){var t,n;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=a.state.selectedRows,n=Object(B["a"])(t),a.setState({accountStatistic:n,settleModalVisible:!0});case 3:case"end":return e.stop()}},e)})),a.onSettleCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({settleModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettleOk=g()(y.a.mark(function e(){var t,n,r,o;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"settle/cancelSettleOrderAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(p["a"].success("\u53d6\u6d88\u7ed3\u7b97\u6210\u529f\uff01"),a.onSettleCancel(),a.handleSearch()):p["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onAddAbnormal=g()(y.a.mark(function e(){var t,n,r,o;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"pay/updatePayAbnormalAction",payload:{order_id:r,order:{pay_status:0}}});case 5:o=e.sent,0==o.code?(p["a"].success("\u53d6\u6d88\u5f02\u5e38\u6210\u529f\uff01"),a.handleSearch()):p["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onAddNormalModal=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:x["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u5c06\u6240\u9009\u8ba2\u5355\u53d6\u6d88\u5f02\u5e38\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onAddAbnormal});case 1:case"end":return e.stop()}},e)})),a.onCancelSign=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelDownAccountModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onCancelDownAccountCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelDownAccountModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelDownAccountOk=g()(y.a.mark(function e(){var t,n,r,o;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"pay/cancelDownAccountAction",payload:{order_id:r}});case 5:o=e.sent,o&&0==o.code?(p["a"].success("\u53d6\u6d88\u4e0b\u8d26\u6210\u529f\uff01"),a.handleSearch(),a.onCancelDownAccountCancel()):p["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onPrint=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=g()(y.a.mark(function e(){var t,n,r;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"pay/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(p["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):p["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=g()(y.a.mark(function e(){var t,n,r,o;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"pay/downloadAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(p["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):p["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e})},a.onCancelPay=g()(y.a.mark(function e(){var t,n,r,o,l,i;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.props.dispatch,n=a.state.selectedRows,r=v()(a),o=!0,l=[],i=0,n.forEach(function(e){var t=j()((new Date).getTime()),a=t.subtract(j()(Number(e.pay_date)||0)).hours();a>=24&&(o=!1),l.push(e.order_id),i+=Number(e.order_real||e.order_amount||0)}),o){e.next=10;break}return p["a"].error("\u4e0b\u8d26\u8d85\u8fc724\u5c0f\u65f6\u4e0d\u53ef\u4ee5\u53d6\u6d88"),e.abrupt("return");case 10:x["a"].confirm({content:H.a.createElement("div",null,"\u786e\u5b9a\u53d6\u6d88\u4e0b\u8d26\u4e48\uff1f\u4e0b\u8d26\u6761\u6570\uff1a",n.length,"\uff1b\u4e0b\u8d26\u603b\u989d\uff1a",i),onOk:function(){var e=g()(y.a.mark(function e(){var a;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t({type:"pay/cancelDownAccountAction",payload:{order_id:l}});case 2:a=e.sent,a&&0==a.code?(p["a"].success("\u53d6\u6d88\u4e0b\u8d26\u6210\u529f\uff01"),r.handleSearch()):p["a"].error(a.msg);case 4:case"end":return e.stop()}},e)}));function a(){return e.apply(this,arguments)}return a}()});case 11:case"end":return e.stop()}},e)})),a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.pay,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=e.totalInsurancefee,l=e.totalAdvancepayAmount,i=e.totalDeliverAmount;return H.a.createElement("div",{className:Z.a.tableFooter},H.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u57ab\u4ed8\u603b\u989d\uff1a",l||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u9001\u8d27\u8d39\u603b\u989d\uff1a",i||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u4fdd\u4ef7\u8d39\u603b\u989d\uff1a",o||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return N()(t,e),O()(t,[{key:"componentDidMount",value:function(){var e=g()(y.a.mark(function e(){var t;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getBranchCompanyList",payload:h()({},G["a"])});case 3:t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}}),this.fetchSendCustomerList(),this.getOrderList();case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=(a.entrunkSiteList,a.normalSiteList),r=void 0===n?[]:n,o=e.customer,l=(o.getCustomerList,o.sendCustomerList),i=e.company.branchCompanyList,c={};return H.a.createElement(R["a"],{onSubmit:this.handleSearch,layout:"inline"},H.a.createElement(Q,{label:"\u5206\u516c\u53f8"},t("company_id",c)(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"80px"},allowClear:!0},i.map(function(e){return H.a.createElement(X,{key:e.company_id,value:e.company_id},e.company_name)})))),H.a.createElement(Q,{label:"\u8fd0\u5355\u53f7"},t("order_code",{})(H.a.createElement(S["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),H.a.createElement(Q,{label:"\u7ad9\u70b9"},t("site_id",{})(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"80px"},allowClear:!0},r.map(function(e){return H.a.createElement(X,{key:e.site_id,value:e.site_id},e.site_name)})))),H.a.createElement(Q,{label:"\u53d1\u8d27\u4eba\u59d3\u540d"},t("sendcustomer_id")(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSendCustomerSelect,style:{width:"80px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onSendCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},l.map(function(e){return H.a.createElement(X,{key:e.get,value:e.customer_id},e.customer_name)})))),H.a.createElement(Q,{label:"\u53d1\u8d27\u4eba\u7535\u8bdd"},t("sendcustomer_mobile",{})(H.a.createElement(S["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),H.a.createElement(Q,{label:"\u4ed8\u6b3e\u65e5\u671f"},t("pay_date",{initialValue:j()((new Date).getTime())})(H.a.createElement(u["a"],{format:"YYYY-MM-DD"}))),H.a.createElement(Q,null,H.a.createElement(E["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.pay,n=a.orderList,r=a.total,o=t.loading,l=this.state,i=l.selectedRows,c=l.accountStatistic,s=l.current,u=l.pageSize,p=l.updateOrderModalVisible,m=l.settleModalVisible,h=l.downModalVisible,f=l.signModalVisible,y=l.cancelDownAccountModalVisible,w=l.downloadModalVisible,g=l.printModalVisible,b=l.record;return H.a.createElement("div",null,H.a.createElement(d["a"],{bordered:!1},H.a.createElement("div",{className:Z.a.tableList},H.a.createElement("div",{className:Z.a.tableListForm},this.renderForm()),H.a.createElement(q["a"],{selectedRows:i,loading:o,className:Z.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:u,current:s,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick})),this.tableFooter()),H.a.createElement(K["a"],{modalVisible:p,record:b,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch}),H.a.createElement(W,{modalVisible:h,downAccountHandle:this.downAccountHandle,downCancel:this.onDownCancel,selectedRows:i}),H.a.createElement(x["a"],{title:"\u53d6\u6d88\u7ed3\u7b97",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:m,onOk:this.onSettleOk,onCancel:this.onSettleCancel},H.a.createElement("p",null,"\u53d6\u6d88\u7ed3\u7b97\u8d27\u6b3e\u6761\u6570".concat(i.length,"\uff0c\u53d6\u6d88\u7ed3\u7b97\u603b\u989d ").concat(c.totalAccount," ")),H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u7b97\u4e48\uff1f")),H.a.createElement(x["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:f,onOk:this.onSignOk,onCancel:this.onSignCancel},H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7b7e\u5b57\u4e48\uff1f")),H.a.createElement(x["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:y,onOk:this.onCancelDownAccountOk,onCancel:this.onCancelDownAccountCancel},H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u4e0b\u8d26\u4e48\uff1f")),H.a.createElement(x["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:g,onOk:this.onPrintOk,onCancel:this.onPrintCancel},H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),H.a.createElement(x["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:w,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(z["PureComponent"]),c=s))||c)||c);t["default"]=J},"4RM8":function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=a("p0pE"),p=a.n(u),m=a("rlhR"),h=a.n(m),f=(a("2qtc"),a("kLXV")),y=(a("14J3"),a("BMrR")),w=(a("jCWc"),a("kPKH")),g=a("jehZ"),b=a.n(g),v=(a("5NDa"),a("5rEg")),x=(a("+L6B"),a("2/Rp")),S=a("d6i3"),_=a.n(S),C=(a("miYZ"),a("tsqr")),E=a("1l/V"),k=a.n(E),L=a("2Taf"),M=a.n(L),O=a("vZ4D"),D=a.n(O),V=a("l4Ni"),I=a.n(V),T=a("ujKo"),F=a.n(T),N=a("MhPg"),A=a.n(N),R=(a("OaEy"),a("2fM7")),z=(a("y8nQ"),a("Vl3Y")),H=(a("iQDF"),a("+eQT")),P=a("q1tI"),Y=a.n(P),j=a("MuoO"),B=(a("wd/R"),a("B797"),a("CkN6")),q=a("/5VO"),K=a("sOv7"),U=a.n(K),Z=(a("S+eF"),a("XS0u")),G=(H["a"].RangePicker,z["a"].Item),Q=R["a"].Option,X=(n=z["a"].create(),n((o=function(e){function t(e){var a;return M()(this,t),a=I()(this,F()(t).call(this,e)),a.onAddHandler=function(){var e,t=a.props,n=t.handleSearch,r=t.form,o=t.record,l=t.dispatch,i=t.onCancelModal,c=t.currentCompany,s=t.customerTypes,d=a.state.dataSource,u=void 0===d?[]:d,p=u.length<=0?o.customerMobiles:u;p.forEach(function(t){t.mobile_id&&"".concat(t.mobile_id).indexOf("TMP-")>=0&&(t.mobile_id=0),1==t.mobile_type&&(e=t),delete t.__typename}),!e&&p.length>0&&(e=p[0],p[0].mobile_type=1),r.validateFields(function(){var t=k()(_.a.mark(function t(a,r){var d,u,m;return _.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=2;break}return t.abrupt("return");case 2:if(r.customer_mobile=e&&e.mobile||"",r.customerMobiles=p,r.company_id=c.company_id,s.forEach(function(e){e.customertype==r.customer_type&&(d=e)}),!d&&s.length>0&&(d=s[0]),d&&(r.customer_type=d.customertype,r.customertype_name=d.customertype_name,r.trans_vip_ratio=d.trans_vip_ratio),m="\u6dfb\u52a0\u6210\u529f",o&&o.customer_id){t.next=15;break}return t.next=12,l({type:"customer/createCustomerAction",payload:{customer:r,type:2}});case 12:u=t.sent,t.next=19;break;case 15:return t.next=17,l({type:"customer/updateCustomerAction",payload:{customer_id:[o.customer_id],customer:r,type:2}});case 17:u=t.sent,m="\u4fee\u6539\u6210\u529f";case 19:u&&0==u.code?(i(),n(),C["a"].success(m)):C["a"].error("\u6dfb\u52a0\u5931\u8d25");case 20:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}())},a.notifyDataSource=function(e){a.setState({dataSource:e})},a.state={dataSource:[]},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a.col2Layout={md:10,sm:26},a}return A()(t,e),D()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelModal,n=e.record,r=e.form,o=(e.mobileList,e.customerTypes),l=void 0===o?[]:o;return console.log(n),Y.a.createElement(f["a"],{destroyOnClose:!0,title:"\u6dfb\u52a0\u6536\u8d27\u5ba2\u6237",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[Y.a.createElement(x["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),Y.a.createElement(x["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:U.a.modalForm},Y.a.createElement(z["a"],null,Y.a.createElement(y["a"],{gutter:{md:8,lg:24,xl:48}},Y.a.createElement(w["a"],this.col2Layout,Y.a.createElement(G,b()({},this.formItemLayout,{label:"\u59d3\u540d"}),r.getFieldDecorator("customer_name",{initialValue:n.customer_name,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u59d3\u540d"}]})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}})))),Y.a.createElement(w["a"],this.col2Layout,Y.a.createElement(G,b()({},this.formItemLayout,{label:"\u7c7b\u578b"}),r.getFieldDecorator("customer_type",{initialValue:n.customer_type})(Y.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"},allowClear:!0},l.map(function(e){return Y.a.createElement(Q,{key:e.customertype,value:e.customertype},e.customertype_name)})))))),Y.a.createElement(y["a"],{gutter:{md:8,lg:24,xl:48}},Y.a.createElement(w["a"],this.col2Layout,Y.a.createElement(G,b()({},this.formItemLayout,{label:"\u8d26\u6237"}),r.getFieldDecorator("bank_account",{initialValue:n.bank_account})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"200px"}})))),Y.a.createElement(w["a"],this.col2Layout,Y.a.createElement(G,b()({},this.formItemLayout,{label:"\u5730\u5740"}),r.getFieldDecorator("customer_address",{initialValue:n.customer_address})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"250px"}}))))),Y.a.createElement(y["a"],{gutter:{md:8,lg:24,xl:48}},Y.a.createElement(w["a"],this.col2Layout,Y.a.createElement(G,b()({},this.formItemLayout,{label:"\u767b\u5f55\u8d26\u53f7"}),r.getFieldDecorator("username",{initialValue:n.username})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}})))),Y.a.createElement(w["a"],this.col2Layout,Y.a.createElement(G,b()({},this.formItemLayout,{label:"\u5bc6\u7801"}),r.getFieldDecorator("password",{initialValue:n.password})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))))),Y.a.createElement(y["a"],{gutter:{md:8,lg:24,xl:48}},Y.a.createElement(w["a"],{span:20},Y.a.createElement(G,{wrapperCol:{span:16},labelCol:{span:4},label:"\u5907\u6ce8"},r.getFieldDecorator("remark",{initialValue:n.remark})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),Y.a.createElement(y["a"],{gutter:{md:8,lg:24,xl:48}},Y.a.createElement(w["a"],{span:20},Y.a.createElement(G,{wrapperCol:{span:16},labelCol:{span:4},label:"\u624b\u673a\u53f7"},Y.a.createElement(q["a"],{dataSource:n.customerMobiles,notifyDataSource:this.notifyDataSource}))))))}}]),t}(P["PureComponent"]),r=o))||r),W=(l=Object(j["connect"])(function(e){var t=e.customer,a=e.company,n=e.site,r=e.receiver,o=e.loading;return{customer:t,company:a,site:n,receiver:r,loading:o.models.rule}}),i=z["a"].create(),l(c=i((s=function(e){function t(){var e,a;M()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=I()(this,(e=F()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},addModalVisible:!1,currentCompany:{}},a.columns=[{title:"\u5ba2\u6237\u7c7b\u578b",dataIndex:"customertype_name",sorter:!0,align:"right",width:"80px"},{title:"\u59d3\u540d",dataIndex:"customer_name",width:"100px"},{title:"\u7535\u8bdd",dataIndex:"customer_mobile",width:"100px"},{title:"\u8d26\u6237",dataIndex:"bank_account",width:"150px"},{title:"\u8fd0\u8d39\u603b\u989d",dataIndex:"total_trans",width:"80px"},{title:"\u7968\u6570",dataIndex:"order_num",width:"80px"},{title:"\u6536\u8d27\u5730\u5740",dataIndex:"customer_address",width:"150px"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.setCurrentCompany=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 2==Z["a"].company_type?(a.setState({currentCompany:Z["a"]}),Z["a"]):e&&e.length>0?(a.setState({currentCompany:e[0]}),e[0]):{}},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchGetCustomerList=function(){var e=k()(_.a.mark(function e(t){var n;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=k()(_.a.mark(function e(t,n){var r,o;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.company.branchCompanyList,o=void 0===r?[]:r,o.forEach(function(e){e.company_id==t&&a.setState({currentCompany:e})});case 2:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.setState({current:1}),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){var o=Object.assign({filter:n,type:2},e);r({type:"customer/queryCustomerListAction",payload:p()({pageNo:t||i,pageSize:c},o)})}})},a.handleStandardTableChange=function(){var e=k()(_.a.mark(function e(t,n,r){var o,l,i,c;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onAddModalShow=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add",t=a.state.currentCompany;t.company_id?("edit"!=e&&a.setState({record:{}}),a.setState({addModalVisible:!0})):f["a"].info({content:"\u8bf7\u5148\u9009\u62e9\u5206\u516c\u53f8"})},a.onAddModalCancel=function(){a.setState({addModalVisible:!1})},a.onDelCustomer=function(){var e=a.props.dispatch,t=a.state.selectedRows,n=(h()(a),[]);t.forEach(function(e){n.push(e.customer_id)}),f["a"].confirm({content:"\u786e\u5b9a\u5220\u9664\u6240\u9009\u8bb0\u5f55\u4e48\uff1f",onOk:function(){var t=k()(_.a.mark(function t(){var r;return _.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e({type:"customer/updateCustomerAction",payload:{customer:{is_delete:1},customer_id:n,type:0}});case 2:if(t.t0=t.sent,t.t0){t.next=5;break}t.t0={};case 5:r=t.t0,0==r.code?(C["a"].success("\u5220\u9664\u5ba2\u6237\u6210\u529f\uff01"),a.handleSearch()):C["a"].error(r.msg);case 7:case"end":return t.stop()}},t)}));function r(){return t.apply(this,arguments)}return r}()})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onAddModalShow("edit")},a.onRowClick=function(e,t,a){},a}return A()(t,e),D()(t,[{key:"componentDidMount",value:function(){var e=k()(_.a.mark(function e(){var t,a;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getBranchCompanyList",payload:p()({},Z["a"])});case 3:a=e.sent,this.setCurrentCompany(a),t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}}),t({type:"customer/queryCustomerTypesAction",payload:{pageNo:1,pageSize:100}}),this.getOrderList();case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=(a.entrunkSiteList,a.normalSiteList),r=void 0===n?[]:n,o=e.customer,l=(o.getCustomerList,o.sendCustomerList,o.customerTypes),i=e.company.branchCompanyList,c={};return i.length>0&&(c.initialValue=i[0].company_id||""),Y.a.createElement(z["a"],{onSubmit:this.handleSearch,layout:"inline"},Y.a.createElement(G,{label:"\u5206\u516c\u53f8"},t("company_id",c)(Y.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"}},i.map(function(e){return Y.a.createElement(Q,{key:e.company_id,value:e.company_id},e.company_name)})))),Y.a.createElement(G,{label:"\u5ba2\u6237\u5206\u7c7b"},t("customer_type",{})(Y.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},allowClear:!0},l.map(function(e){return Y.a.createElement(Q,{key:e.customertype,value:e.customertype},e.customertype_name)})))),Y.a.createElement(G,{label:"\u7ad9\u70b9"},t("site_id",{})(Y.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},allowClear:!0},r.map(function(e){return Y.a.createElement(Q,{key:e.site_id,value:e.site_id},e.site_name)})))),Y.a.createElement(G,{label:"\u59d3\u540d"},t("customer_name",{})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"100px"}}))),Y.a.createElement(G,{label:"\u7535\u8bdd"},t("customer_mobile",{})(Y.a.createElement(v["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),Y.a.createElement(G,null,Y.a.createElement(x["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.customer,n=a.customers,r=a.total,o=a.customerTypes,l=t.loading,i=t.dispatch,c=this.state,s=c.selectedRows,u=c.current,p=c.pageSize,m=c.addModalVisible,h=c.record,f=c.currentCompany;return Y.a.createElement("div",null,Y.a.createElement(d["a"],{bordered:!1},Y.a.createElement("div",{className:U.a.tableList},Y.a.createElement("div",{className:U.a.tableListForm},this.renderForm()),Y.a.createElement("div",{className:U.a.tableListOperator},Y.a.createElement(x["a"],{onClick:this.onAddModalShow},"\u6dfb\u52a0"),s.length>0&&Y.a.createElement("span",null,Y.a.createElement(x["a"],{onClick:this.onDelCustomer},"\u5220\u9664"))),Y.a.createElement(B["a"],{selectedRows:s,loading:l,className:U.a.dataTable,scroll:{x:900,y:350},rowKey:"customer_id",data:{list:n,pagination:{total:r,pageSize:p,current:u,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,footer:function(){return""}}))),Y.a.createElement(X,{modalVisible:m,record:h,dispatch:i,onCancelModal:this.onAddModalCancel,handleSearch:this.handleSearch,currentCompany:f,customerTypes:o}))}}]),t}(P["PureComponent"]),c=s))||c)||c);t["default"]=W},"4ca5":function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i=a("bx4M"),c=(a("+L6B"),a("2/Rp")),s=(a("iQDF"),a("+eQT")),d=(a("5NDa"),a("5rEg")),u=(a("miYZ"),a("tsqr")),p=(a("2qtc"),a("kLXV")),m=a("p0pE"),h=a.n(m),f=a("d6i3"),y=a.n(f),w=a("1l/V"),g=a.n(w),b=a("2Taf"),v=a.n(b),x=a("vZ4D"),S=a.n(x),_=a("l4Ni"),C=a.n(_),E=a("ujKo"),k=a.n(E),L=a("MhPg"),M=a.n(L),O=(a("OaEy"),a("2fM7")),D=(a("y8nQ"),a("Vl3Y")),V=a("q1tI"),I=a.n(V),T=a("MuoO"),F=a("wd/R"),N=a.n(F),A=(a("B797"),a("CkN6")),R=a("82qg"),z=a("VlJg"),H=a.n(z),P=(a("S+eF"),a("XS0u")),Y=D["a"].Item,j=O["a"].Option,B=(n=Object(T["connect"])(function(e){var t=e.customer,a=e.company,n=e.transconfirm,r=e.site,o=e.car,l=e.receiver,i=e.loading;return{customer:t,company:a,transconfirm:n,site:r,car:o,receiver:l,loading:i.models.rule}}),r=D["a"].create(),n(o=r((l=function(e){function t(){var e,a;v()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=C()(this,(e=k()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1},a.columns=[{title:"\u8d27\u5355\u53f7",dataIndex:"order_code",sorter:!0,align:"right",render:function(e){return"".concat(e)},needTotal:!0,width:"80px"},{title:"\u53d1\u8d27\u5ba2\u6237",dataIndex:"sendcustomer_name",width:"80px"},{title:"\u6536\u83b7\u5ba2\u6237",dataIndex:"getcustomer_name",sorter:!0,width:"80px"},{title:"\u5e94\u6536\u8d27\u6b3e",dataIndex:"order_amount",sorter:!0,width:"80px"},{title:"\u5b9e\u6536\u8d27\u6b3e",dataIndex:"order_real",sorter:!0,width:"80px"},{title:"\u5b9e\u6536\u8fd0\u8d39",dataIndex:"trans_real",sorter:!0,width:"80px"},{title:"\u6298\u540e\u8fd0\u8d39",dataIndex:"trans_discount",sorter:!0,width:"80px"},{title:"\u8fd0\u8d39\u65b9\u5f0f",dataIndex:"trans_type",sorter:!0,render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t},width:"80px"},{title:"\u57ab\u4ed8",dataIndex:"order_advancepay_amount",sorter:!0,width:"80px"},{title:"\u9001\u8d27\u8d39",dataIndex:"deliver_amount",sorter:!0,width:"80px"},{title:"\u4fdd\u4ef7\u8d39",dataIndex:"insurance_fee",sorter:!0,width:"80px"},{title:"\u8d27\u7269\u540d\u79f0",dataIndex:"order_name",sorter:!0,width:"200px"},{title:"\u5f55\u7968\u65f6\u95f4",dataIndex:"create_date",render:function(e){return I.a.createElement("span",null,e&&N()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"190px"},{title:"\u53d1\u8f66\u65f6\u95f4",dataIndex:"depart_date",render:function(e){return I.a.createElement("span",null,e&&N()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"190px"},{title:"\u7ed3\u7b97\u65f6\u95f4",dataIndex:"settle_date",render:function(e){return I.a.createElement("span",null,e&&N()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"190px"},{title:"\u7ed3\u7b97\u4eba",dataIndex:"settle_user_name",width:"80px"},{title:"\u7ad9\u70b9",dataIndex:"site_name",sorter:!0,width:"80px"},{title:"\u4e2d\u8f6c",dataIndex:"transfer_type",sorter:!0,render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t},width:"80px"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onSendCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchSendCustomerList()},a.fetchSendCustomerList=function(){var e=g()(y.a.mark(function e(t){var n;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/sendCustomerListAction",payload:{filter:{}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=g()(y.a.mark(function e(t,n){var r,o,l;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,r.dispatch,o=r.company.branchCompanyList,r.car.lastCar,l=o.filter(function(e){if(e.company_id==t)return e}),l.length>0&&a.setState({currentCompany:l[0]});case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){n.trans_status=1,n.trans_type||(n.trans_type=9),n.trans_confirmdate?n.trans_confirmdate=n.trans_confirmdate.valueOf():delete n.trans_confirmdate;var o=Object.assign({filter:n},e);r({type:"transconfirm/getOrderListAction",payload:h()({pageNo:t||i,pageSize:c},o)}),r({type:"transconfirm/getOrderStatisticAction",payload:h()({},o)})}})},a.handleStandardTableChange=function(){var e=g()(y.a.mark(function e(t,n,r){var o,l,i,c;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onConfirmTransModal=function(){p["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u53d6\u6d88\u6240\u9009\u8ba2\u5355\u7684\u8fd0\u8d39\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onConfirmTrans})},a.onConfirmTrans=g()(y.a.mark(function e(){var t,n,r,o,l;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),o={order_id:r,company_id:P["a"].company_id},e.next=6,t({type:"transconfirm/cancelConfirmTransAction",payload:o});case 6:l=e.sent,0==l.code?(u["a"].success("\u53d6\u6d88\u6210\u529f\uff01"),a.handleSearch()):u["a"].error(l.msg);case 8:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onUpdateOrderModalShow()},a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.transconfirm,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=e.totalInsurancefee,l=e.totalAdvancepayAmount,i=e.totalDeliverAmount;return I.a.createElement("div",{className:H.a.tableFooter},I.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),I.a.createElement("span",{className:H.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),I.a.createElement("span",{className:H.a.footerSplit},"\u57ab\u4ed8\u603b\u989d\uff1a",l||"0"),I.a.createElement("span",{className:H.a.footerSplit},"\u9001\u8d27\u8d39\u603b\u989d\uff1a",i||"0"),I.a.createElement("span",{className:H.a.footerSplit},"\u4fdd\u4ef7\u8d39\u603b\u989d\uff1a",o||"0"),I.a.createElement("span",{className:H.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return M()(t,e),S()(t,[{key:"componentDidMount",value:function(){var e=g()(y.a.mark(function e(){var t,a;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getBranchCompanyList",payload:P["a"]});case 3:return a=e.sent,e.next=6,t({type:"site/getSiteListAction",payload:{}});case 6:t({type:"customer/sendCustomerListAction",payload:{pageNo:1,pageSize:100}}),a&&a.length>0&&this.setState({currentCompany:a[0]}),this.getOrderList();case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.customer,n=(a.getCustomerList,a.sendCustomerList),r=e.company.branchCompanyList,o=e.site.siteList,l={};return I.a.createElement(D["a"],{onSubmit:this.handleSearch,layout:"inline"},I.a.createElement(Y,{label:"\u5206\u516c\u53f8"},t("company_id",l)(I.a.createElement(O["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"200px"},allowClear:!0},r.map(function(e){return I.a.createElement(j,{key:e.company_id,value:e.company_id},e.company_name)})))),I.a.createElement(Y,{label:"\u7ad9\u70b9"},t("site_id",{})(I.a.createElement(O["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"},allowClear:!0},(3==P["c"].site_type?o:[P["c"]]).map(function(e){return I.a.createElement(j,{key:e.site_id,value:e.site_id},e.site_name)})))),I.a.createElement(Y,{label:"\u8fd0\u8d39"},t("trans_type",{initialValue:2})(I.a.createElement(O["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"},allowClear:!0},I.a.createElement(j,{value:1},"\u73b0\u4ed8"),I.a.createElement(j,{value:2},"\u56de\u4ed8")))),I.a.createElement(Y,{label:"\u53d1\u8d27\u4eba\u59d3\u540d"},t("sendcustomer_id")(I.a.createElement(O["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSendCustomerSelect,style:{width:"200px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onSendCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map(function(e){return I.a.createElement(j,{key:e.get,value:e.customer_id},e.customer_name)})))),I.a.createElement(Y,{label:"\u53d1\u8d27\u4eba\u7535\u8bdd"},t("sendcustomer_mobile",{})(I.a.createElement(d["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),I.a.createElement(Y,{label:"\u65e5\u671f"},t("trans_confirmdate",{initialValue:N()()})(I.a.createElement(s["a"],{format:"YYYY-MM-DD",allowClear:!0}))),I.a.createElement(Y,null,I.a.createElement(c["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.transconfirm,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.loading),l=this.state,s=l.selectedRows,d=l.current,u=l.pageSize,p=l.updateOrderModalVisible,m=l.record,h=!0;return["site_searchuser"].indexOf(P["b"].role_value)>=0&&(h=!1),I.a.createElement("div",null,I.a.createElement(i["a"],{bordered:!1},I.a.createElement("div",{className:H.a.tableList},I.a.createElement("div",{className:H.a.tableListForm},this.renderForm()),I.a.createElement("div",{className:H.a.tableListOperator},s.length>0&&h&&I.a.createElement("span",null,I.a.createElement(c["a"],{onClick:this.onConfirmTransModal},"\u53d6\u6d88\u786e\u8ba4\u8fd0\u8d39"),I.a.createElement(c["a"],{onClick:this.onPrint},"\u6253\u5370"))),I.a.createElement(A["a"],{selectedRows:s,loading:o,className:H.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:u,current:d,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick})),this.tableFooter()),I.a.createElement(R["a"],{modalVisible:p,record:m,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch}))}}]),t}(V["PureComponent"]),o=l))||o)||o);t["default"]=B},"6L+x":function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("miYZ"),a("tsqr")),p=a("d6i3"),m=a.n(p),h=a("1l/V"),f=a.n(h),y=(a("2qtc"),a("kLXV")),w=(a("14J3"),a("BMrR")),g=(a("jCWc"),a("kPKH")),b=a("jehZ"),v=a.n(b),x=(a("5NDa"),a("5rEg")),S=(a("+L6B"),a("2/Rp")),_=(a("O3gP"),a("lrIw")),C=a("2Taf"),E=a.n(C),k=a("vZ4D"),L=a.n(k),M=a("l4Ni"),O=a.n(M),D=a("ujKo"),V=a.n(D),I=a("MhPg"),T=a.n(I),F=(a("OaEy"),a("2fM7")),N=(a("y8nQ"),a("Vl3Y")),A=(a("iQDF"),a("+eQT")),R=a("q1tI"),z=a.n(R),H=a("MuoO"),P=(a("wd/R"),a("CkN6")),Y=a("o6JX"),j=a.n(Y),B=(a("XS0u"),A["a"].RangePicker,N["a"].Item),q=F["a"].Option,K=(n=N["a"].create(),n((o=function(e){function t(e){var a;return E()(this,t),a=O()(this,V()(t).call(this,e)),a.onAbnormalSelect=function(e,t){},a.onAddHandler=function(){var e=a.props,t=e.addFormDataHandle,n=e.form,r=e.record,o=void 0===r?{}:r;n.validateFields(function(e,a){if(!e){a.trans_ratio&&(a.trans_ratio=Number(a.trans_ratio));var n={site:a};o.site_id&&(n.ids=[o.site_id]),t(n)}})},a.renderCustomerOption=function(e){var t=_["a"].Option;return z.a.createElement(t,{key:e.expensetype_id,expensetype_id:e.expensetype_id,text:e.expensetype},e.expensetype)},a.state={},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return T()(t,e),L()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelHandler,n=e.record,r=e.form;return z.a.createElement(y["a"],{destroyOnClose:!0,title:"\u6dfb\u52a0\u7ad9\u70b9",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[z.a.createElement(S["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),z.a.createElement(S["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:j.a.modalForm},z.a.createElement(N["a"],null,z.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(g["a"],null,z.a.createElement(B,v()({},this.formItemLayout,{label:"\u7ad9\u70b9\u540d\u79f0"}),r.getFieldDecorator("site_name",{initialValue:n.site_name,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7ad9\u70b9\u540d\u79f0"}]})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),z.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(g["a"],null,z.a.createElement(B,v()({},this.formItemLayout,{label:"\u7ad9\u70b9\u7c7b\u578b"}),r.getFieldDecorator("site_type",{initialValue:n.site_type||1,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7ad9\u70b9\u7c7b\u578b"}]})(z.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"}},z.a.createElement(q,{key:1,value:1},"\u666e\u901a\u7ad9\u70b9"),z.a.createElement(q,{key:2,value:2},"\u914d\u8f7d\u7ad9")))))),z.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(g["a"],null,z.a.createElement(B,v()({},this.formItemLayout,{label:"\u8ba2\u5355\u53f7\u524d\u7f00"}),r.getFieldDecorator("site_orderprefix",{initialValue:n.site_orderprefix,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8be5\u7ad9\u70b9\u7684\u8ba2\u5355\u53f7\u524d\u7f00"}]})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),z.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(g["a"],null,z.a.createElement(B,v()({},this.formItemLayout,{className:j.a.formItemNoBreak,label:"\u5e94\u6253\u6b3e"}),"\u897f\u5b89\u6536\u8fd0\u8d39 + \u9001\u8d27\u8d39 - \u57ab\u4ed8 - \u603b\u8fd0\u8d39*",r.getFieldDecorator("trans_ratio",{initialValue:n.trans_ratio,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u603b\u8fd0\u8d39\u7cfb\u6570"}]})(z.a.createElement(x["a"],{placeholder:"",style:{width:"60px"}}))," - \u5df2\u6253\u6b3e")))))}}]),t}(R["PureComponent"]),r=o))||r),U=(l=Object(H["connect"])(function(e){var t=e.site,a=e.company,n=e.loading;return{site:t,company:a,loading:n.models.rule}}),i=N["a"].create(),l(c=i((s=function(e){function t(){var e,a;E()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=O()(this,(e=V()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],formValues:{},current:1,pageSize:20,record:{},currentCompany:{},currentSite:{},addModalVisible:!1},a.columns=[{title:"\u7ad9\u70b9\u540d\u79f0",dataIndex:"site_name",width:"100px"},{title:"\u7ad9\u70b9\u7c7b\u578b",dataIndex:"site_type",width:"80px",render:function(e){return 1==e?"\u666e\u901a\u7ad9\u70b9":"\u88c5\u914d\u7ad9"}},{title:"\u8ba2\u5355\u53f7\u524d\u7f00",dataIndex:"site_orderprefix",width:"80px"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchCompanySiteList=function(){var e=f()(m.a.mark(function e(t){var n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchGetCustomerList=function(){var e=f()(m.a.mark(function e(t){var n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=f()(m.a.mark(function e(t,n){var r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,o=r.company.branchCompanyList,r.form,a.fetchCompanySiteList(t),l=o.filter(function(e){if(e.company_id==t)return e}),l.length>0&&a.setState({currentCompany:l[0]});case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onSiteSelect=function(){var e=f()(m.a.mark(function e(t,n){var r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.site.normalSiteList,o=void 0===r?[]:r,l=o.filter(function(e){if(e.site_id==t)return e}),l.length>0&&a.setState({currentSite:l[0]}),a.fetchExpenseTypeList({siteId:t});case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1];var e=a.props,t=e.dispatch,n=e.form,r=a.state;r.current,r.pageSize,r.currentCompany;n.validateFields(function(e,a){e||t({type:"site/getSiteListAction",payload:{}})})},a.handleStandardTableChange=function(){var e=f()(m.a.mark(function e(t,n,r){var o,l,i,c;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.addFormDataHandle=function(){var e=f()(m.a.mark(function e(t){var n,r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=t.site,r=t.ids,o=a.props.dispatch,e.next=4,o({type:"site/addSite",payload:{site:n,ids:r}});case 4:l=e.sent,l&&0==l.code?(u["a"].success("\u6dfb\u52a0\u6210\u529f\uff01"),a.handleSearch(),a.onCancelModalClick()):u["a"].error(l&&l.msg||"\u6dfb\u52a0\u5931\u8d25");case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onAddClick=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addModalVisible:!0,record:{}});case 1:case"end":return e.stop()}},e)})),a.onCancelModalClick=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onModalShow=function(){a.setState({addModalVisible:!0})},a.onModalCancel=function(){a.setState({addModalVisible:!1})},a.onSiteChange=function(e){console.log("site",e),e||a.setState({currentSite:{}})},a.onCompanyChange=function(e){console.log("company",e),e||a.setState({currentCompany:{}})},a.onUpdateOrder=function(){var e=f()(m.a.mark(function e(t,n){var r,o;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.props.dispatch,console.log(t,n),e.next=4,r({type:"order/updateOrderAction",payload:{orderIds:[t.order_id],order:{trans_real:n.trans_real,order_real:n.order_real}}});case 4:o=e.sent,0==o.code?(u["a"].success("\u4fee\u6539\u6210\u529f\uff01"),a.onModalCancel()):u["a"].error(o.msg);case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onRowClick=function(e,t,a){},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onModalShow()},a}return T()(t,e),L()(t,[{key:"componentDidMount",value:function(){var e=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.props.dispatch,this.getOrderList();case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){var e=this,t=this.props,a=t.company,n=(a.branchCompanyList,a.branchTotal,t.site),r=n.siteList,o=void 0===r?[]:r,l=n.siteTotal,i=void 0===l?0:l,c=t.loading,s=this.state,u=s.selectedRows,p=s.current,m=s.pageSize,h=s.addModalVisible,f=s.record;return z.a.createElement("div",null,z.a.createElement(d["a"],{bordered:!1},z.a.createElement("div",{className:j.a.tableList},z.a.createElement("div",{className:j.a.tableListOperator},z.a.createElement(S["a"],{icon:"plus",type:"primary",onClick:function(){return e.onAddClick(!0)}},"\u6dfb\u52a0")),z.a.createElement(P["a"],{selectedRows:u,loading:c,className:j.a.dataTable,scroll:{x:900,y:350},rowKey:"site_id",data:{list:o,pagination:{total:i,pageSize:m,current:p,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,footer:function(){}}))),z.a.createElement(K,{modalVisible:h,addFormDataHandle:this.addFormDataHandle,onCancelHandler:this.onCancelModalClick,record:f,selectedRows:u}))}}]),t}(R["PureComponent"]),c=s))||c)||c);t["default"]=U},"6wUN":function(e,t,a){"use strict";a.r(t);a("2qtc");var n,r,o,l,i=a("kLXV"),c=(a("IzEo"),a("bx4M")),s=(a("+L6B"),a("2/Rp")),d=(a("iQDF"),a("+eQT")),u=(a("5NDa"),a("5rEg")),p=a("jehZ"),m=a.n(p),h=(a("miYZ"),a("tsqr")),f=a("p0pE"),y=a.n(f),w=a("d6i3"),g=a.n(w),b=a("1l/V"),v=a.n(b),x=a("2Taf"),S=a.n(x),_=a("vZ4D"),C=a.n(_),E=a("l4Ni"),k=a.n(E),L=a("ujKo"),M=a.n(L),O=a("MhPg"),D=a.n(O),V=(a("OaEy"),a("2fM7")),I=(a("y8nQ"),a("Vl3Y")),T=a("q1tI"),F=a.n(T),N=a("MuoO"),A=a("wd/R"),R=a.n(A),z=a("B797"),H=a("CkN6"),P=a("82qg"),Y=a("SLv7"),j=a.n(Y),B=a("XS0u"),q=I["a"].Item,K=V["a"].Option,U=(n=Object(N["connect"])(function(e){var t=e.common,a=e.customer,n=e.company,r=e.accountlist,o=e.site,l=e.car,i=e.receiver,c=e.loading;return{common:t,customer:a,company:n,accountlist:r,site:o,car:l,receiver:i,loading:c.models.rule}}),r=I["a"].create(),n(o=r((l=function(e){function t(){var e,a;S()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=k()(this,(e=M()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,settleModalVisible:!1,signModalVisible:!1,cancelSignModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1,currentCompany:{},currentShipSite:{}},a.columns=[{title:"\u8d27\u5355\u53f7",width:"80px",dataIndex:"order_code",align:"right",sorter:!0,render:function(e){return"".concat(e)},needTotal:!0},{title:"\u53d1\u8d27\u5ba2\u6237",width:"80px",sorter:!0,dataIndex:"sendcustomer_name"},{title:"\u6536\u83b7\u5ba2\u6237",width:"80px",dataIndex:"getcustomer_name",sorter:!0},{title:"\u5e94\u6536\u8d27\u6b3e",width:"80px",dataIndex:"order_amount"},{title:"\u5b9e\u6536\u8d27\u6b3e",dataIndex:"order_real",width:"80px",sorter:!0},{title:"\u6298\u540e\u8fd0\u8d39",width:"80px",sorter:!0,dataIndex:"trans_discount"},{title:"\u8fd0\u8d39\u65b9\u5f0f",width:"80px",dataIndex:"trans_type",sorter:!0,render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t}},{title:"\u57ab\u4ed8",width:"80px",dataIndex:"order_advancepay_amount"},{title:"\u9001\u8d27\u8d39",width:"80px",dataIndex:"deliver_amount"},{title:"\u4fdd\u4ef7\u8d39",width:"80px",dataIndex:"insurance_fee"},{title:"\u8d27\u7269\u540d\u79f0",width:"150px",dataIndex:"order_name"},{title:"\u5f55\u7968\u65f6\u95f4",width:"170px",dataIndex:"create_date",render:function(e){return F.a.createElement("span",null,e&&R()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u7ed3\u7b97\u65f6\u95f4",width:"170px",dataIndex:"settle_date",render:function(e){return F.a.createElement("span",null,e&&R()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u4ed8\u6b3e\u65f6\u95f4",width:"170px",dataIndex:"pay_date",render:function(e){return F.a.createElement("span",null,e&&R()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u5206\u516c\u53f8",width:"80px",dataIndex:"company_name"},{title:"\u7ad9\u70b9",width:"80px",dataIndex:"site_name"},{title:"\u4e2d\u8f6c",width:"80px",dataIndex:"transfer_type",render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t}},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.setCurrentCompany=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 2==B["a"].company_type?(a.setState({currentCompany:B["a"]}),B["a"]):e&&e.length>0?(a.setState({currentCompany:e[0]}),e[0]):{}},a.handleFormReset=function(){var e=a.props,t=e.form,n=e.dispatch;t.resetFields(),a.setState({formValues:{}}),n({type:"rule/fetch",payload:{}})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onGetCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchGetCustomerList()},a.onSendCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchSendCustomerList()},a.fetchGetCustomerList=function(){var e=v()(g.a.mark(function e(t){var n,r,o,l;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props,r=n.dispatch,o=n.branchCompanyList,l=a.state.currentCompany,l&&l.company_id||(l=o&&o[0]),r({type:"customer/getCustomerListAction",payload:{filter:{company_id:t||l&&l.company_id||0}}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchSendCustomerList=function(){var e=v()(g.a.mark(function e(t){var n;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/sendCustomerListAction",payload:{filter:{}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=v()(g.a.mark(function e(t,n){var r,o,l,i;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,o=r.dispatch,l=r.company.branchCompanyList,r.car.lastCar,o({type:"customer/resetCustomerPageNo",payload:{type:"Get"}}),a.fetchGetCustomerList(t),i=l.filter(function(e){if(e.company_id==t)return e}),i.length>0&&a.setState({currentCompany:i[0]});case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){5==n.order_status?n.order_status=[3,5]:6==n.order_status?n.order_status=[6,7]:n.order_status=[3,7],n.settle_date&&(n.settle_date=n.settle_date.valueOf()),1==B["a"].company_type&&3!=B["c"].site_type&&(n.site_id=B["c"].site_id);var o=Object.assign({filter:n},e);r({type:"accountlist/getOrderListAction",payload:y()({pageNo:t||i,pageSize:c},o)}),r({type:"accountlist/getOrderStatisticAction",payload:y()({},o)})}})},a.handleStandardTableChange=function(){var e=v()(g.a.mark(function e(t,n,r){var o,l,i,c;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onSignOk=v()(g.a.mark(function e(){var t,n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"unsettle/signAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(h["a"].success("\u7b7e\u5b57\u6210\u529f\uff01"),a.handleSearch(),a.onSignCancel()):h["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onSign=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({signModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onSignCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({signModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettle=v()(g.a.mark(function e(){var t,n;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=a.state.selectedRows,n=Object(z["a"])(t),a.setState({accountStatistic:n,settleModalVisible:!0});case 3:case"end":return e.stop()}},e)})),a.onSettleCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({settleModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettleOk=v()(g.a.mark(function e(){var t,n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"unsettle/settleOrderAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(h["a"].success("\u6838\u5bf9\u6210\u529f\uff01"),a.onSettleCancel(),a.handleSearch()):h["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onCancelSign=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelSignModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onCancelSignCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelSignModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelSignOk=v()(g.a.mark(function e(){var t,n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"unsettle/cancelSignAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(h["a"].success("\u53d6\u6d88\u7b7e\u5b57\u6210\u529f\uff01"),a.handleSearch(),a.onCancelSignCancel()):h["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onPrint=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=v()(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"accountlist/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(h["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):h["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=v()(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"accountlist/downloadAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(h["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):h["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onUpdateOrderModalShow()},a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.accountlist,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=e.totalInsurancefee,l=e.totalAdvancepayAmount,i=e.totalDeliverAmount;return F.a.createElement("div",{className:j.a.tableFooter},F.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),F.a.createElement("span",{className:j.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),F.a.createElement("span",{className:j.a.footerSplit},"\u57ab\u4ed8\u603b\u989d\uff1a",l||"0"),F.a.createElement("span",{className:j.a.footerSplit},"\u9001\u8d27\u8d39\u603b\u989d\uff1a",i||"0"),F.a.createElement("span",{className:j.a.footerSplit},"\u4fdd\u4ef7\u8d39\u603b\u989d\uff1a",o||"0"),F.a.createElement("span",{className:j.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return D()(t,e),C()(t,[{key:"componentDidMount",value:function(){var e=v()(g.a.mark(function e(){var t,a,n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getBranchCompanyList",payload:y()({},B["a"])});case 3:return a=e.sent,e.next=6,t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}});case 6:n=e.sent,t({type:"customer/sendCustomerListAction",payload:{pageNo:1,pageSize:100}}),r=this.setCurrentCompany(a),t({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:r.company_id}}}),n&&n.length>0&&(o=n.filter(function(e){return 3==e.site_type||2==e.site_type}),o.length>0&&this.setState({currentShipSite:o[0]})),t({type:"common/initOrderListAction"});case 12:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.customer,n=a.getCustomerList,r=a.sendCustomerList,o=e.company.branchCompanyList,l=(e.site.entrunkSiteList,this.state.currentShipSite,{}),i={},c=1==B["a"].company_type;return o.length>0&&1!=B["a"].company_type&&(i.initialValue=o[0].company_id||""),F.a.createElement(I["a"],{onSubmit:this.handleSearch,layout:"inline"},F.a.createElement(q,m()({label:"\u5206\u516c\u53f8"},l),t("company_id",i)(F.a.createElement(V["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"},allowClear:c},(2==B["a"].company_type?[B["a"]]:o).map(function(e){return F.a.createElement(K,{key:e.company_id,value:e.company_id},e.company_name)})))),F.a.createElement(q,m()({label:"\u8fd0\u5355\u53f7"},l),t("order_code",{})(F.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),F.a.createElement(q,m()({label:"\u6709\u65e0\u8d27\u6b3e"},l),t("order_amount",{initialValue:-1})(F.a.createElement(V["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},allowClear:!0},F.a.createElement(K,{value:0},"\u65e0"),F.a.createElement(K,{value:-1},"\u6709")))),F.a.createElement(q,m()({label:"\u6536\u8d27\u4eba\u59d3\u540d"},l),t("getcustomer_id")(F.a.createElement(V["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onGetCustomerSelect,style:{width:"100px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onGetCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map(function(e){return F.a.createElement(K,{key:e.customer_id,value:e.customer_id},e.customer_name)})))),F.a.createElement(q,m()({label:"\u6536\u8d27\u4eba\u7535\u8bdd"},l),t("getcustomer_mobile",{})(F.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),F.a.createElement(q,m()({label:"\u53d1\u8d27\u4eba\u59d3\u540d"},l),t("sendcustomer_id")(F.a.createElement(V["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSendCustomerSelect,style:{width:"100px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onSendCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},r.map(function(e){return F.a.createElement(K,{key:e.get,value:e.customer_id},e.customer_name)})))),F.a.createElement(q,m()({label:"\u6536\u8d27\u4eba\u7535\u8bdd"},l),t("sendcustomer_mobile",{})(F.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),F.a.createElement(q,m()({label:"\u7ed3\u7b97\u72b6\u6001"},l),t("order_status")(F.a.createElement(V["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"80px"},allowClear:!0},F.a.createElement(K,{value:6},"\u5df2\u7ed3\u7b97"),F.a.createElement(K,{value:5},"\u672a\u7ed3\u7b97")))),F.a.createElement(q,m()({label:"\u65e5\u671f"},l),t("settle_date",{initialValue:R()()})(F.a.createElement(d["a"],{format:"YYYY-MM-DD"}))),F.a.createElement(I["a"].Item,m()({},l,{className:j.a.tableListOperator}),F.a.createElement(s["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.accountlist,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.company.branchCompanyList,t.car),l=(o.carList,o.lastCar,t.loading),s=this.state,d=s.selectedRows,u=s.accountStatistic,p=s.current,m=s.pageSize,h=s.updateOrderModalVisible,f=s.settleModalVisible,y=s.signModalVisible,w=s.cancelSignModalVisible,g=s.downloadModalVisible,b=s.printModalVisible,v=s.record;return F.a.createElement("div",null,F.a.createElement(c["a"],{bordered:!1},F.a.createElement("div",{className:j.a.tableList},F.a.createElement("div",{className:j.a.tableListForm},this.renderForm()),F.a.createElement(H["a"],{selectedRows:d,loading:l,className:j.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:m,current:p,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,rowClassNameHandler:function(e,t){return 6===e.order_status?j.a.settleColor:7===e.order_status?j.a.payColor:""}})),this.tableFooter()),F.a.createElement(P["a"],{modalVisible:h,record:v,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch}),F.a.createElement(i["a"],{title:"\u786e\u8ba4\u7ed3\u8d26",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:f,onOk:this.onSettleOk,onCancel:this.onSettleCancel},F.a.createElement("p",null,"\u7ed3\u7b97\u8d27\u6b3e\u6761\u6570".concat(d.length,"\uff0c\u7ed3\u7b97\u603b\u989d ").concat(u.totalAccount," ")),F.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u4e48\uff1f")),F.a.createElement(i["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:y,onOk:this.onSignOk,onCancel:this.onSignCancel},F.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7b7e\u5b57\u4e48\uff1f")),F.a.createElement(i["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:w,onOk:this.onCancelSignOk,onCancel:this.onCancelSignCancel},F.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u7b7e\u5b57\u4e48\uff1f")),F.a.createElement(i["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:b,onOk:this.onPrintOk,onCancel:this.onPrintCancel},F.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),F.a.createElement(i["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:g,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},F.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(T["PureComponent"]),o=l))||o)||o);t["default"]=U},"82qg":function(e,t,a){"use strict";a("2qtc");var n,r,o,l=a("kLXV"),i=(a("5NDa"),a("5rEg")),c=(a("+BJd"),a("mr32")),s=(a("14J3"),a("BMrR")),d=(a("jCWc"),a("kPKH")),u=a("jehZ"),p=a.n(u),m=(a("+L6B"),a("2/Rp")),h=a("d6i3"),f=a.n(h),y=(a("miYZ"),a("tsqr")),w=a("1l/V"),g=a.n(w),b=a("2Taf"),v=a.n(b),x=a("vZ4D"),S=a.n(x),_=a("l4Ni"),C=a.n(_),E=a("ujKo"),k=a.n(E),L=a("MhPg"),M=a.n(L),O=(a("OaEy"),a("2fM7")),D=(a("y8nQ"),a("Vl3Y")),V=a("q1tI"),I=a.n(V),T=a("s4P5"),F=a.n(T),N=a("XS0u"),A=(a("JSq2"),D["a"].Item),R=O["a"].Option,z=(n=D["a"].create(),n((o=function(e){function t(e){var a;return v()(this,t),a=C()(this,k()(t).call(this,e)),a.computeTransDiscount=function(e){var t,n=a.props,r=n.currentCompany,o=n.currentGetCustomer,l=n.currentSendCustomer,i=n.form,c=i.getFieldValue("trans_originalamount")||0,s=i.getFieldValue("trans_amount")||0,d=i.getFieldValue("trans_type")||0,u=o.trans_vip_ratio||1,p=l.trans_vip_ratio||1,m=r.trans_regional_ratio||1,h=s;t=0==d?u:p,"type"==e?(h=Math.ceil(Number(c)*Number(t)*Number(m)),i.setFieldsValue({trans_discount:h||""})):"original"==e?(c&&m&&(s=Math.ceil(Number(c)*Number(m))),t&&m&&(h=Math.ceil(Number(c)*Number(t)*Number(m)),i.setFieldsValue({trans_discount:h||"",trans_amount:s||""}))):t&&m&&(h=Math.ceil(Number(s)*Number(t)),i.setFieldsValue({trans_discount:h||""}))},a.onTransTypeSelect=function(){a.computeTransDiscount("type")},a.onTransOriginalBlur=function(e){a.computeTransDiscount("original")},a.onTransBlur=function(e){a.computeTransDiscount()},a.okHandle=function(){var e=a.props,t=e.form,n=e.record,r=e.dispatch,o=e.onCancelModal,l=e.handleSearch;t.validateFields(function(){var e=g()(f.a.mark(function e(a,i){var c;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=2;break}return e.abrupt("return");case 2:return Object.keys(i).forEach(function(e){e.indexOf("amount")>=0?i[e]=Number(i[e]||0):i[e]||delete i[e]}),"undefined"!=typeof i["trans_type"]&&(i["trans_type"]=Number(i["trans_type"])),"undefined"!=typeof i["transfer_type"]&&(i["transfer_type"]=Number(i["transfer_type"])),e.next=7,r({type:"order/updateOrderAction",payload:{orderIds:[n.order_id],order:i}});case 7:c=e.sent,0==c.code?(y["a"].success("\u4fee\u6539\u6210\u529f\uff01"),l(),o()):y["a"].error(c.msg),t.resetFields();case 10:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a.formItemLayout={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},a.formItemSmallLayout={labelCol:{xs:{span:25},sm:{span:9}},wrapperCol:{xs:{span:23},sm:{span:15}}},a.colLayout={md:8,sm:24},a.colSmallLayout={md:4,sm:20},a.col2Layout={md:10,sm:26},a.colLargeLayout={md:16,sm:32},a.formItemMiniLayout={labelCol:{xs:{span:22},sm:{span:6}},wrapperCol:{xs:{span:26},sm:{span:18}}},a.formLayout={labelCol:{span:7},wrapperCol:{span:13}},a}return M()(t,e),S()(t,[{key:"render",value:function(){var e=this.props,t=e.record,a=e.modalVisible,n=e.onCancelModal,r=e.form,o=e.isEdit,u=void 0===o?0:o,h=[I.a.createElement(m["a"],{key:"btn-cancel",onClick:function(){return n()}},"\u53d6 \u6d88")];u&&h.push(I.a.createElement(m["a"],{key:"btn-save",type:"primary",onClick:this.okHandle},"\u4fdd \u5b58"));var f=["site_admin"].indexOf(N["b"].role_value)>=0;return I.a.createElement(l["a"],{destroyOnClose:!0,title:"\u7f16\u8f91\u6258\u8fd0\u5355",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:a,onCancel:function(){return n()},footer:h,width:800,className:F.a.modalForm},I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u5206\u516c\u53f8"}),t.company_name)),I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u7ad9\u70b9"}),t.site_name))),I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u6536\u8d27\u4eba\u7535\u8bdd"}),t.getcustomer_mobile)),I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u6536\u8d27\u4eba\u59d3\u540d"}),t.getcustomer_name)),I.a.createElement(d["a"],null,1==t.customer_type?I.a.createElement(c["a"],{color:"orange",style:{marginTop:10}},"VIP"):"")),I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u53d1\u8d27\u4eba\u7535\u8bdd"}),t.sendcustomer_mobile)),I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u53d1\u8d27\u4eba\u59d3\u540d"}),t.sendcustomer_name))),f?I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],{span:38,className:F.a.formItemFloat},I.a.createElement(A,{style:{width:"220px",display:"inline-block"},labelCol:{span:7},wrapperCol:{span:7},label:"\u5c0f\u7968\u8fd0\u8d39"},r.getFieldDecorator("trans_originalamount",{initialValue:t.trans_originalamount})(I.a.createElement(i["a"],{placeholder:"\u8bf7\u8f93\u5165\u5c0f\u7968\u8fd0\u8d39",onBlur:this.onTransOriginalBlur,style:{width:"100px"}}))),I.a.createElement(A,{style:{width:"180px",display:"inline-block"},labelCol:{span:7},wrapperCol:{span:7},label:"\u8fd0\u8d39"},r.getFieldDecorator("trans_amount",{initialValue:t.trans_amount})(I.a.createElement(i["a"],{placeholder:"\u8bf7\u8f93\u5165\u8fd0\u8d39",onBlur:this.onTransBlur,style:{width:"100px"},tabIndex:-1}))),I.a.createElement(A,{label:"",style:{width:"100px",display:"inline-block"},labelCol:{span:0},wrapperCol:{span:4}},r.getFieldDecorator("trans_type",{initialValue:t.trans_type})(I.a.createElement(O["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"70px"},tabIndex:-1,onSelect:this.onTransTypeSelect},I.a.createElement(R,{value:0},"\u63d0\u4ed8"),I.a.createElement(R,{value:1},"\u73b0\u4ed8"),I.a.createElement(R,{value:2},"\u56de\u4ed8")))),I.a.createElement(A,{style:{width:"210px",display:"inline-block"},labelCol:{span:7},wrapperCol:{span:10},label:"\u6298\u540e\u8fd0\u8d39"},r.getFieldDecorator("trans_discount",{initialValue:t.trans_discount})(I.a.createElement(i["a"],{placeholder:"",tabIndex:-1,style:{width:"80px"},disabled:!0}))))):I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u8fd0\u8d39"}),t.trans_amount,"(",1==t.trans_type?"\u73b0\u4ed8":"\u56de\u4ed8",")")),I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u6298\u540e\u8fd0\u8d39"}),t.trans_discount))),I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u8d27\u6b3e"}),t.order_amount)),I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u94f6\u884c\u8d26\u53f7"}),t.bank_account))),I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u4fdd\u4ef7\u91d1\u989d"}),t.insurance_amount)),I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u4fdd\u4ef7\u8d39"}),t.insurance_fee))),I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u9001\u8d27\u8d39"}),t.deliver_amount)),I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u57ab\u4ed8\u91d1\u989d"}),t.order_advancepay_amount))),I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u8d27\u7269\u540d\u79f0"}),t.order_name)),I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u6570\u91cf"}),t.order_num))),I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u8f6c\u8fdb/\u8f6c\u51fa"}),r.getFieldDecorator("transfer_type",{initialValue:t.transfer_type?t.transfer_type:""})(I.a.createElement(O["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"},tabIndex:-1},I.a.createElement(R,{value:1},"\u8f6c\u51fa"),I.a.createElement(R,{value:2},"\u8f6c\u8fdb"))))),I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u8d39"}),r.getFieldDecorator("transfer_amount",{initialValue:t.transfer_amount})(I.a.createElement(i["a"],{placeholder:"\u8bf7\u8f93\u5165",tabIndex:-1}))))),I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u5730\u5740"}),r.getFieldDecorator("transfer_address",{initialValue:t.transfer_address})(I.a.createElement(i["a"],{placeholder:"\u8bf7\u8f93\u5165",tabIndex:-1})))),I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u7269\u6d41"}),r.getFieldDecorator("transfer_company_name",{initialValue:t.transfer_company_name})(I.a.createElement(i["a"],{placeholder:"\u8bf7\u8f93\u5165",tabIndex:-1}))))),I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u5355\u53f7"}),r.getFieldDecorator("transfer_order_code",{initialValue:t.transfer_order_code})(I.a.createElement(i["a"],{placeholder:"\u8bf7\u8f93\u5165",tabIndex:-1})))),I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u7535\u8bdd"}),r.getFieldDecorator("transfer_company_mobile",{initialValue:t.transfer_company_mobile})(I.a.createElement(i["a"],{placeholder:"\u8bf7\u8f93\u5165",tabIndex:-1}))))),I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u5b9e\u6536\u8d27\u6b3e"}),r.getFieldDecorator("order_real",{initialValue:t.order_real})(I.a.createElement(i["a"],{placeholder:"\u8bf7\u8f93\u5165"})))),I.a.createElement(d["a"],this.col2Layout,I.a.createElement(A,p()({},this.formItemLayout,{label:"\u5b9e\u6536\u8fd0\u8d39"}),r.getFieldDecorator("trans_discount",{initialValue:t.trans_discount})(I.a.createElement(i["a"],{placeholder:"\u8bf7\u8f93\u5165"}))))),I.a.createElement(s["a"],{gutter:{md:8,lg:24,xl:48}},I.a.createElement(d["a"],this.colLargeLayout,I.a.createElement(A,p()({},this.formItemMiniLayout,{label:"\u5907\u6ce8"}),r.getFieldDecorator("remark",{initialValue:t.remark})(I.a.createElement(i["a"],{placeholder:"\u8bf7\u8f93\u5165"}))))))}}]),t}(V["PureComponent"]),r=o))||r);t["a"]=z},"9yR7":function(e,t,a){e.exports={"antd-pro-components-global-header-index-header":"antd-pro-pages-courier-courier-antd-pro-components-global-header-index-header",tableList:"antd-pro-pages-courier-courier-tableList",tableListOperator:"antd-pro-pages-courier-courier-tableListOperator",tableFooter:"antd-pro-pages-courier-courier-tableFooter",footerSplit:"antd-pro-pages-courier-courier-footerSplit",signColor:"antd-pro-pages-courier-courier-signColor",settleColor:"antd-pro-pages-courier-courier-settleColor",payColor:"antd-pro-pages-courier-courier-payColor",selectedColor:"antd-pro-pages-courier-courier-selectedColor",tableDetail:"antd-pro-pages-courier-courier-tableDetail",modalForm:"antd-pro-pages-courier-courier-modalForm",formItemFloat:"antd-pro-pages-courier-courier-formItemFloat",tableListForm:"antd-pro-pages-courier-courier-tableListForm",submitButtons:"antd-pro-pages-courier-courier-submitButtons",dataTable:"antd-pro-pages-courier-courier-dataTable","ant-form-item":"antd-pro-pages-courier-courier-ant-form-item","ant-select":"antd-pro-pages-courier-courier-ant-select",formItemNoBreak:"antd-pro-pages-courier-courier-formItemNoBreak"}},B797:function(e,t,a){"use strict";function n(e,t){var a={};a.recordNum=e.length;for(var n=0,r=0,o=0,l=0,i=0,c=0,s=0,d=0,u=0,p=0;p<e.length;p++){var m=e[p],h=m.order_real?m.order_real:m.order_amount;console.log("$$$$$$",h,m),l+=Number(h);var f=m.trans_discount?m.trans_discount:m.trans_amount;console.log("#######",f,m);var y=0;m.insurance_fee&&(y+=m.insurance_fee),0==m.trans_type?(i+=Number(f||0),d+=Number(m.order_advancepay_amount||0),c+=y):(u+=Number(f||0),s+=y),o+=Number(m.trans_amount||0),r+=Number(m.order_amount||0),n=l+i+d+c}return a.totalAccount=n,a.totalShouldGoodsFund=r,a.totalShouldTransFund=o,a.totalActualGoodsFund=l,a.totalActualTransFund=i,a.totalXianSettleTransFunds=u,a.totalAdvancepayAmount=d,a.totalTifuInsurance=c,a.totalXianInsurance=s,a}function r(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={},a=0,n=0,r="",o="",l=!0,i=!0,c=!0,s=0;s<e.length;s++){if(0==s&&(r=e[s]["sendcustomer_id"],o=e[s]["bank_account"]),r&&r!=e[s]["sendcustomer_id"]){l=!1;break}if(o&&o!=e[s]["bank_account"]){i=!1;break}e[s].trans_type&&3==e[s].trans_type&&Number(e[s].order_amount)>0&&(n+=Number(e[s].trans_discount||e[s].trans_amount)),6==e[s].order_status?Number(e[s].order_real)>0?a+=Number(e[s].order_real):a+=Number(e[s].order_amount):c=!1}return t.totalActualGoodsFund=a,t.totalTransFunds=n,t.isSameSendCustomer=l,t.isSameBankAccount=i,t.isSettled=c,t}a.d(t,"a",function(){return n}),a.d(t,"b",function(){return r})},BKN5:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i=a("bx4M"),c=(a("+L6B"),a("2/Rp")),s=(a("5NDa"),a("5rEg")),d=(a("miYZ"),a("tsqr")),u=(a("2qtc"),a("kLXV")),p=a("p0pE"),m=a.n(p),h=a("d6i3"),f=a.n(h),y=a("1l/V"),w=a.n(y),g=a("2Taf"),b=a.n(g),v=a("vZ4D"),x=a.n(v),S=a("l4Ni"),_=a.n(S),C=a("ujKo"),E=a.n(C),k=a("MhPg"),L=a.n(k),M=(a("OaEy"),a("2fM7")),O=(a("y8nQ"),a("Vl3Y")),D=a("q1tI"),V=a.n(D),I=a("MuoO"),T=a("wd/R"),F=a.n(T),N=(a("B797"),a("CkN6")),A=a("82qg"),R=a("VlJg"),z=a.n(R),H=(a("S+eF"),a("XS0u")),P=O["a"].Item,Y=M["a"].Option,j=(n=Object(I["connect"])(function(e){var t=e.customer,a=e.company,n=e.transconfirm,r=e.site,o=e.car,l=e.receiver,i=e.loading;return{customer:t,company:a,transconfirm:n,site:r,car:o,receiver:l,loading:i.models.rule}}),r=O["a"].create(),n(o=r((l=function(e){function t(){var e,a;b()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=_()(this,(e=E()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1},a.columns=[{title:"\u8d27\u5355\u53f7",dataIndex:"order_code",sorter:!0,align:"right",render:function(e){return"".concat(e)},needTotal:!0,width:"80px"},{title:"\u53d1\u8d27\u5ba2\u6237",sorter:!0,dataIndex:"sendcustomer_name",width:"80px"},{title:"\u6536\u83b7\u5ba2\u6237",dataIndex:"getcustomer_name",sorter:!0,width:"80px"},{title:"\u5e94\u6536\u8d27\u6b3e",dataIndex:"order_amount",sorter:!0,width:"80px"},{title:"\u5b9e\u6536\u8d27\u6b3e",dataIndex:"order_real",sorter:!0,width:"80px"},{title:"\u5b9e\u6536\u8fd0\u8d39",dataIndex:"trans_real",sorter:!0,width:"80px"},{title:"\u6298\u540e\u8fd0\u8d39",dataIndex:"trans_discount",sorter:!0,width:"80px"},{title:"\u8fd0\u8d39\u65b9\u5f0f",dataIndex:"trans_type",sorter:!0,render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t},width:"80px"},{title:"\u57ab\u4ed8",dataIndex:"order_advancepay_amount",sorter:!0,width:"80px"},{title:"\u9001\u8d27\u8d39",dataIndex:"deliver_amount",sorter:!0,width:"80px"},{title:"\u4fdd\u4ef7\u8d39",dataIndex:"insurance_fee",sorter:!0,width:"80px"},{title:"\u8d27\u7269\u540d\u79f0",dataIndex:"order_name",sorter:!0,width:"200px"},{title:"\u5f55\u7968\u65f6\u95f4",dataIndex:"create_date",render:function(e){return V.a.createElement("span",null,e&&F()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"190px"},{title:"\u53d1\u8f66\u65f6\u95f4",dataIndex:"depart_date",render:function(e){return V.a.createElement("span",null,e&&F()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"190px"},{title:"\u7ed3\u7b97\u65f6\u95f4",dataIndex:"settle_date",render:function(e){return V.a.createElement("span",null,e&&F()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"190px"},{title:"\u7ed3\u7b97\u4eba",dataIndex:"settle_user_name",width:"80px"},{title:"\u7ad9\u70b9",dataIndex:"site_name",sorter:!0,width:"80px"},{title:"\u4e2d\u8f6c",dataIndex:"transfer_type",sorter:!0,render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t},width:"80px"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onSendCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchSendCustomerList()},a.fetchSendCustomerList=function(){var e=w()(f.a.mark(function e(t){var n;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/sendCustomerListAction",payload:{filter:{}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onSiteSelect=function(){var e=w()(f.a.mark(function e(t,n){var r,o,l;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,r.dispatch,o=r.site.siteList,l=o.filter(function(e){if(e.site_id==t)return e}),l.length>0&&a.setState({currentSite:l[0]});case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=w()(f.a.mark(function e(t,n){var r,o,l;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,r.dispatch,o=r.company.branchCompanyList,r.car.lastCar,l=o.filter(function(e){if(e.company_id==t)return e}),l.length>0&&a.setState({currentCompany:l[0]});case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){n.trans_status=0,n.trans_type||(n.trans_type=9);var o=Object.assign({filter:n},e);r({type:"transconfirm/getOrderListAction",payload:m()({pageNo:t||i,pageSize:c},o)}),r({type:"transconfirm/getOrderStatisticAction",payload:m()({},o)})}})},a.handleStandardTableChange=function(){var e=w()(f.a.mark(function e(t,n,r){var o,l,i,c;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onConfirmTransModal=function(){u["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u786e\u8ba4\u6240\u9009\u8ba2\u5355\u7684\u8fd0\u8d39\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onConfirmTrans})},a.onConfirmTrans=w()(f.a.mark(function e(){var t,n,r,o,l,i,c;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state,r=n.selectedRows,o=n.currentSite,void 0===o?H["c"]:o,l=r.map(function(e){return e.order_id}),i={order_id:l,company_id:H["a"].company_id},e.next=6,t({type:"transconfirm/confirmTransAction",payload:i});case 6:c=e.sent,0==c.code?(d["a"].success("\u786e\u8ba4\u6210\u529f\uff01"),a.handleSearch()):d["a"].error(c.msg);case 8:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onUpdateOrderModalShow()},a.onTransSign=function(){u["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u8981\u7b7e\u5b57\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onTransSignOk})},a.onTransSignOk=w()(f.a.mark(function e(){var t,n,r,o;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"transconfirm/signAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(d["a"].success("\u7b7e\u5b57\u6210\u529f\uff01"),a.handleSearch()):d["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onCancelTransSign=function(){u["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u8981\u53d6\u6d88\u7b7e\u5b57\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onCancelTransSignOk})},a.onCancelTransSignOk=w()(f.a.mark(function e(){var t,n,r,o;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"transconfirm/cancelSignAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(d["a"].success("\u53d6\u6d88\u7b7e\u5b57\u6210\u529f\uff01"),a.handleSearch()):d["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.transconfirm,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=(e.totalInsurancefee,e.totalRealTransAmount,e.totalRealOrderAmount),l=e.totalAdvancepayAmount,i=(e.totalDeliverAmount,e.totalTifuTransAmount,e.totalXianTransAmount),c=(e.totalLatefee,e.totalBonusfee,e.totalCarFeeConfirm,e.totalCarFee,e.totalTifuInsurance,e.totalXianInsurence);return V.a.createElement("div",{className:z.a.tableFooter},V.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),V.a.createElement("span",null,"\u5b9e\u6536\u8d27\u6b3e\uff1a",o||"0"),V.a.createElement("span",{className:z.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),V.a.createElement("span",{className:z.a.footerSplit},"\u897f\u5b89\u8fd0\u8d39\uff1a",i||"0"),V.a.createElement("span",{className:z.a.footerSplit},"\u57ab\u4ed8\u8fd0\u8d39\uff1a",l||"0"),V.a.createElement("span",{className:z.a.footerSplit},"\u897f\u5b89\u4fdd\u8d39\uff1a",c||"0"),V.a.createElement("span",{className:z.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return L()(t,e),x()(t,[{key:"componentDidMount",value:function(){var e=w()(f.a.mark(function e(){var t,a;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getBranchCompanyList",payload:H["a"]});case 3:return a=e.sent,e.next=6,t({type:"site/getSiteListAction",payload:{}});case 6:t({type:"customer/sendCustomerListAction",payload:{pageNo:1,pageSize:100}}),a&&a.length>0&&this.setState({currentCompany:a[0]}),this.getOrderList();case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.customer,n=(a.getCustomerList,a.sendCustomerList),r=e.company.branchCompanyList,o=e.site.siteList,l={};return V.a.createElement(O["a"],{onSubmit:this.handleSearch,layout:"inline"},V.a.createElement(P,{label:"\u5206\u516c\u53f8"},t("company_id",l)(V.a.createElement(M["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"200px"},allowClear:!0},r.map(function(e){return V.a.createElement(Y,{key:e.company_id,value:e.company_id},e.company_name)})))),V.a.createElement(P,{label:"\u7ad9\u70b9"},t("site_id",{})(V.a.createElement(M["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"},onSelect:this.onSiteSelect,allowClear:!0},(3==H["c"].site_type?o:[H["c"]]).map(function(e){return V.a.createElement(Y,{key:e.site_id,value:e.site_id},e.site_name)})))),V.a.createElement(P,{label:"\u8fd0\u8d39"},t("trans_type",{})(V.a.createElement(M["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"},allowClear:!0},V.a.createElement(Y,{value:1},"\u73b0\u4ed8"),V.a.createElement(Y,{value:2},"\u56de\u4ed8")))),V.a.createElement(P,{label:"\u53d1\u8d27\u4eba\u59d3\u540d"},t("sendcustomer_id")(V.a.createElement(M["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSendCustomerSelect,style:{width:"200px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onSendCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map(function(e){return V.a.createElement(Y,{key:e.get,value:e.customer_id},e.customer_name)})))),V.a.createElement(P,{label:"\u6536\u8d27\u4eba\u7535\u8bdd"},t("sendcustomer_mobile",{})(V.a.createElement(s["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),V.a.createElement(P,null,V.a.createElement(c["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.transconfirm,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.loading),l=this.state,s=l.selectedRows,d=l.current,u=l.pageSize,p=l.updateOrderModalVisible,m=l.record,h=!0;return["site_searchuser"].indexOf(H["b"].role_value)>=0&&(h=!1),V.a.createElement("div",null,V.a.createElement(i["a"],{bordered:!1},V.a.createElement("div",{className:z.a.tableList},V.a.createElement("div",{className:z.a.tableListForm},this.renderForm()),V.a.createElement("div",{className:z.a.tableListOperator},s.length>0&&h&&V.a.createElement("span",null,V.a.createElement(c["a"],{onClick:this.onConfirmTransModal},"\u786e\u8ba4\u8fd0\u8d39"),V.a.createElement(c["a"],{onClick:this.onTransSign},"\u7b7e\u5b57"),V.a.createElement(c["a"],{onClick:this.onCancelTransSign},"\u53d6\u6d88\u7b7e\u5b57"),V.a.createElement(c["a"],{onClick:this.onPrint},"\u6253\u5370"))),V.a.createElement(N["a"],{selectedRows:s,loading:o,className:z.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:u,current:d,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,rowClassNameHandler:function(e,t){return 1==e.trans_sign?z.a.signColor:""},onDoubleClickHander:this.onRowDoubleClick})),this.tableFooter()),V.a.createElement(A["a"],{modalVisible:p,record:m,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch}))}}]),t}(D["PureComponent"]),o=l))||o)||o);t["default"]=j},BsfW:function(e,t,a){e.exports={list:"antd-pro-components-notice-icon-notice-list-list",item:"antd-pro-components-notice-icon-notice-list-item",meta:"antd-pro-components-notice-icon-notice-list-meta",avatar:"antd-pro-components-notice-icon-notice-list-avatar",iconElement:"antd-pro-components-notice-icon-notice-list-iconElement",read:"antd-pro-components-notice-icon-notice-list-read",title:"antd-pro-components-notice-icon-notice-list-title",description:"antd-pro-components-notice-icon-notice-list-description",datetime:"antd-pro-components-notice-icon-notice-list-datetime",extra:"antd-pro-components-notice-icon-notice-list-extra",loadMore:"antd-pro-components-notice-icon-notice-list-loadMore",loadedAll:"antd-pro-components-notice-icon-notice-list-loadedAll",notFound:"antd-pro-components-notice-icon-notice-list-notFound",clear:"antd-pro-components-notice-icon-notice-list-clear"}},CkN6:function(e,t,a){"use strict";a("g9YV");var n=a("wCAj"),r=a("jehZ"),o=a.n(r),l=(a("fOrg"),a("+KLJ")),i=a("Y/ft"),c=a.n(i),s=a("gWZ8"),d=a.n(s),u=a("2Taf"),p=a.n(u),m=a("vZ4D"),h=a.n(m),f=a("l4Ni"),y=a.n(f),w=a("ujKo"),g=a.n(w),b=a("rlhR"),v=a.n(b),x=a("MhPg"),S=a.n(x),_=a("p0pE"),C=a.n(_),E=a("q1tI"),k=a.n(E),L=a("rZM1"),M=a.n(L);function O(e){var t=[];return e.forEach(function(e){e.needTotal&&t.push(C()({},e,{total:0}))}),t}var D=function(e){function t(e){var a;p()(this,t),a=y()(this,g()(t).call(this,e)),a.handleRowSelectChange=function(e,t){var n=a.props.onSelectRow;n&&n(t),a.setState({selectedRowKeys:e,selectedRows:t})},a.handleTableChange=function(e,t,n){var r=a.props.onChange;r&&r(e,t,n)},a.cleanSelectedKeys=function(){a.handleRowSelectChange([],[])},a.selectRow=function(e){var t,n,r=a.props,o=r.rowKey,l=r.onSelectRow,i=d()(a.state.selectedRowKeys),c=d()(a.state.selectedRows);c.forEach(function(a,r){a[o]==e[o]&&(t=a,n=r)}),t?(i.splice(n,1),c.splice(n,1)):(i.push(e[o]),c.push(e)),l&&l(c),a.setState({selectedRowKeys:i,selectedRows:c})};var n=e.columns,r=O(n);return a.state={selectedRowKeys:[],selectedRows:[],needTotalList:r},"function"==typeof a.props.onRef&&a.props.onRef(v()(a)),a}return S()(t,e),h()(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.selectedRowKeys,r=(t.needTotalList,this.props),i=r.data,s=void 0===i?{}:i,d=r.rowKey,u=r.rowClassNameHandler,p=r.onClickHander,m=r.onDoubleClickHander,h=c()(r,["data","rowKey","rowClassNameHandler","onClickHander","onDoubleClickHander"]),f=s.list,y=void 0===f?[]:f,w=s.pagination,g=C()({showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:["20","40","60"]},w),b={selectedRowKeys:a,onChange:this.handleRowSelectChange};return k.a.createElement("div",{className:M.a.standardTable},k.a.createElement("div",{className:M.a.tableAlert},k.a.createElement(l["a"],{message:k.a.createElement(E["Fragment"],null,"\u5df2\u9009\u62e9 ",k.a.createElement("a",{style:{fontWeight:600}},a.length)," \u9879\xa0\xa0",k.a.createElement("a",{onClick:this.cleanSelectedKeys,style:{marginLeft:24}},"\u6e05\u7a7a")),type:"info",showIcon:!0})),k.a.createElement(n["a"],o()({rowKey:d||"order_id",rowSelection:b,dataSource:y,pagination:g,onChange:this.handleTableChange,rowClassName:function(e,t){if("function"==typeof u)return u(e,t);var n=!1;return a.forEach(function(t){e[d]==t&&(n=!0)}),n?M.a.selectedColor:""},onRow:function(t,a){return{onClick:function(n){e.selectRow(t),"function"==typeof p&&p(t,a,n)},onDoubleClick:function(e){"function"==typeof m&&m(t,a,e)}}}},h)))}}]),t}(E["PureComponent"]);t["a"]=D},De2C:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("5NDa"),a("5rEg")),p=(a("miYZ"),a("tsqr")),m=a("p0pE"),h=a.n(m),f=a("d6i3"),y=a.n(f),w=a("1l/V"),g=a.n(w),b=(a("2qtc"),a("kLXV")),v=(a("14J3"),a("BMrR")),x=(a("jCWc"),a("kPKH")),S=a("jehZ"),_=a.n(S),C=(a("+L6B"),a("2/Rp")),E=(a("O3gP"),a("lrIw")),k=a("2Taf"),L=a.n(k),M=a("vZ4D"),O=a.n(M),D=a("l4Ni"),V=a.n(D),I=a("ujKo"),T=a.n(I),F=a("MhPg"),N=a.n(F),A=(a("iQDF"),a("+eQT")),R=(a("OaEy"),a("2fM7")),z=(a("y8nQ"),a("Vl3Y")),H=a("q1tI"),P=a.n(H),Y=a("MuoO"),j=a("wd/R"),B=a.n(j),q=(a("B797"),a("CkN6")),K=a("82qg"),U=a("9yR7"),Z=a.n(U),G=a("XS0u"),Q=z["a"].Item,X=R["a"].Option,W=A["a"].RangePicker,J=(n=z["a"].create(),n((o=function(e){function t(e){var a;return L()(this,t),a=V()(this,T()(t).call(this,e)),a.onAddHandler=function(){var e=a.props,t=e.addFormDataHandle,n=e.form,r=e.senderList,o=void 0===r?[]:r;n.validateFields(function(e,a){var n;e||(o.forEach(function(e){e.courier_id==a["courier_id"]&&(n=e)}),delete n["__typename"],t(n))})},a.renderCustomerOption=function(e){var t=E["a"].Option;return P.a.createElement(t,{key:e.expensetype_id,expensetype_id:e.expensetype_id,text:e.expensetype},e.expensetype)},a.state={},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return N()(t,e),O()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelHandler,n=e.senderList,r=e.form;return P.a.createElement(b["a"],{destroyOnClose:!0,title:"\u66f4\u6539\u9001\u8d27\u4eba",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[P.a.createElement(C["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),P.a.createElement(C["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:Z.a.modalForm},P.a.createElement(z["a"],null,P.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(x["a"],null,P.a.createElement(Q,_()({},this.formItemLayout,{label:"\u9001\u8d27\u4eba"}),r.getFieldDecorator("courier_id",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u9001\u8d27\u4eba"}]})(P.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"}},n.map(function(e){return P.a.createElement(X,{key:e.courier_id,value:e.courier_id},e.courier_name)}))))))))}}]),t}(H["PureComponent"]),r=o))||r),$=(l=Object(Y["connect"])(function(e){var t=e.customer,a=e.company,n=e.order,r=e.site,o=e.car,l=e.courier,i=e.loading;return{customer:t,company:a,order:n,site:r,car:o,courier:l,loading:i.models.rule}}),i=z["a"].create(),l(c=i((s=function(e){function t(){var e,a;L()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=V()(this,(e=T()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,downloadModalVisible:!1,addFormModalVisible:!1,currentSite:{}},a.columns=[{title:"\u7ecf\u529e\u4eba",width:"80px",dataIndex:"operator_name",sorter:!0},{title:"\u8d27\u5355\u53f7",width:"80px",dataIndex:"order_code",sorter:!0},{title:"\u53d1\u8d27\u5ba2\u6237",width:"80px",dataIndex:"sendcustomer_name",sorter:!0},{title:"\u6536\u83b7\u5ba2\u6237",width:"80px",dataIndex:"getcustomer_name",sorter:!0},{title:"\u5e94\u6536\u8d27\u6b3e",width:"80px",dataIndex:"order_amount",sorter:!0},{title:"\u5b9e\u6536\u8d27\u6b3e",dataIndex:"order_real",width:"80px",sorter:!0},{title:"\u6298\u540e\u8fd0\u8d39",width:"80px",dataIndex:"trans_discount",sorter:!0},{title:"\u8fd0\u8d39\u65b9\u5f0f",width:"80px",dataIndex:"trans_type",sorter:!0,render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t}},{title:"\u57ab\u4ed8",width:"80px",dataIndex:"order_advancepay_amount"},{title:"\u9001\u8d27\u8d39",width:"80px",dataIndex:"deliver_amount"},{title:"\u4fdd\u4ef7\u8d39",width:"80px",dataIndex:"insurance_fee"},{title:"\u8d27\u7269\u540d\u79f0",width:"150px",dataIndex:"order_name"},{title:"\u5f55\u7968\u65f6\u95f4",width:"170px",dataIndex:"create_date",render:function(e){return P.a.createElement("span",null,e&&B()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u7ed3\u7b97\u65f6\u95f4",width:"170px",dataIndex:"settle_date",render:function(e){return P.a.createElement("span",null,e&&B()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u4ed8\u6b3e\u65e5\u671f",width:"170px",dataIndex:"pay_date",render:function(e){return P.a.createElement("span",null,e&&B()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u5206\u516c\u53f8",width:"80px",dataIndex:"company_name"},{title:"\u7ad9\u70b9",width:"80px",dataIndex:"site_name"},{title:"\u914d\u8f7d\u7ad9",width:"80px",dataIndex:"shipsite_name"},{title:"\u4e2d\u8f6c",width:"80px",dataIndex:"transfer_type",render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t}},{title:"\u5f02\u5e38\u60c5\u51b5",width:"80px",dataIndex:"abnormal_type"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchCompanySiteList=g()(y.a.mark(function e(){var t;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,e.next=3,t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100,filter:{}}});case 3:e.sent;case 4:case"end":return e.stop()}},e)})),a.fetchOperatorList=function(){var e=g()(y.a.mark(function e(t){var n,r,o;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,r=a.state.currentSite,o={},o.company_id=G["a"].company_id,r&&r.site_id&&(o.site_id=r.site_id),n({type:"courier/getOperatorListAction",payload:{pageNo:1,pageSize:100,filter:o}});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=g()(y.a.mark(function e(t,a){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onSiteSelect=function(){var e=g()(y.a.mark(function e(t,n){var r,o,l;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,r.dispatch,o=r.site.siteList,l=o.filter(function(e){if(e.site_id==t)return e}),l.length>0&&a.setState({currentSite:l[0]}),a.fetchOperatorList();case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){Object.keys(n).forEach(function(e){var t=n[e];t||delete n[e]});var o=Object.assign({filter:n},e);r({type:"courier/getOrderListAction",payload:h()({pageNo:t||i,pageSize:c},o)}),r({type:"courier/getOrderStatisticAction",payload:h()({},o)})}})},a.handleStandardTableChange=function(){var e=g()(y.a.mark(function e(t,n,r){var o,l,i,c;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onPrint=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=g()(y.a.mark(function e(){var t,n,r;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"unsettle/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(p["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):p["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=g()(y.a.mark(function e(){var t,n,r;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"unsettle/downloadAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(p["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):p["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onUpdateSenderModal=function(){a.setState({addFormModalVisible:!0})},a.addFormDataHandle=function(){var e=g()(y.a.mark(function e(t){var n,r,o,l,i,c;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.selectedRows,o=void 0===r?[]:r,l=[],i=[],o.forEach(function(e){l.push(e.order_id),i.push(e.getcustomer_id)}),e.next=7,n({type:"courier/updateCustomerCourierAction",payload:{type:"sender",order_id:l,customer_id:i,courier:t}});case 7:c=e.sent,c&&0==c.code?(p["a"].success("\u66f4\u65b0\u6210\u529f\uff01"),a.handleSearch(),a.onCancelAddFormClick()):p["a"].error(c&&c.msg||"\u66f4\u65b0\u5931\u8d25");case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCancelAddFormClick=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addFormModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDelSender=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:b["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u8981\u53d6\u6d88\u52fe\u9009\u8ba2\u5355\u3001\u6536\u8d27\u5ba2\u6237\u5173\u8054\u7684\u9001\u8d27\u4eba\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onDelSenderConfirm});case 1:case"end":return e.stop()}},e)})),a.onDelSenderConfirm=g()(y.a.mark(function e(){var t,n,r,o,l,i;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=void 0===n?[]:n,o=[],l=[],r.forEach(function(e){o.push(e.order_id),l.push(e.getcustomer_id)}),e.next=7,t({type:"courier/updateCustomerCourierAction",payload:{type:"sender",order_id:o,customer_id:l,courier:{}}});case 7:i=e.sent,i&&0==i.code?(p["a"].success("\u53d6\u6d88\u6210\u529f\uff01"),a.handleSearch()):p["a"].error(i&&i.msg||"\u53d6\u6d88\u5931\u8d25");case 9:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onUpdateOrderModalShow()},a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.courier,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=(e.totalInsurancefee,e.totalRealTransAmount,e.totalRealOrderAmount),l=e.totalAdvancepayAmount,i=e.totalDeliverAmount,c=e.totalTifuTransAmount,s=e.totalXianTransAmount,d=e.totalLatefee,u=e.totalBonusfee,p=e.totalCarFeeConfirm,m=e.totalCarFee,h=e.totalTifuInsurance,f=e.totalXianInsurence;return P.a.createElement("div",{className:Z.a.tableFooter},P.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u5b9e\u6536\u8d27\u6b3e\uff1a",o||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u63d0\u4ed8\u8fd0\u8d39\uff1a",c||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u897f\u5b89\u8fd0\u8d39\uff1a",s||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u57ab\u4ed8\u8fd0\u8d39\uff1a",l||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u9001\u8d27\u8d39\uff1a",i||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u897f\u5b89\u4fdd\u8d39\uff1a",f||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u63d0\u4ed8\u4fdd\u8d39\uff1a",h||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u6ede\u7eb3\u91d1\uff1a",d||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u5956\u91d1\uff1a",u||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u672a\u7ed3\u7b97\u8d27\u8f66\u8fd0\u8d39\uff1a",m||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u5df2\u7ed3\u7b97\u8d27\u8f66\u8fd0\u8d39\uff1a",p||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return N()(t,e),O()(t,[{key:"componentDidMount",value:function(){var e=g()(y.a.mark(function e(){var t;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,t({type:"courier/initOrderListAction"}),e.next=4,t({type:"company/getBranchCompanyList",payload:h()({},G["a"])});case 4:return e.next=6,this.fetchCompanySiteList();case 6:this.fetchOperatorList();case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.customer,n=(a.getCustomerList,a.sendCustomerList,e.company.branchCompanyList),r=void 0===n?[]:n,o=e.courier.operatorList,l=e.site,i=l.siteList,c=l.entrunkSiteList,s={},d={initialValue:G["a"].company_id},p={};i.length>0&&(p.initialValue=i[0].company_id||"");var m=!1;return 1==G["a"].company_type&&(m=!0,d={initialValue:r.length>0?r[0].company_id:""}),P.a.createElement(z["a"],{onSubmit:this.handleSearch,layout:"inline"},P.a.createElement(Q,_()({label:"\u5206\u516c\u53f8"},s),t("company_id",d)(P.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"},allowClear:m},(2==G["a"].company_type?[G["a"]]:r).map(function(e){return P.a.createElement(X,{key:e.company_id,value:e.company_id},e.company_name)})))),1==G["a"].company_type&&P.a.createElement(Q,_()({label:"\u7ad9\u70b9"},s),t("site_id",p)(P.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSiteSelect,onChange:this.onSiteSelect,style:{width:"100px"},allowClear:!0},i.map(function(e){return P.a.createElement(X,{key:e.site_id,value:e.site_id},e.site_name)})))),P.a.createElement(Q,{label:"\u8fd0\u5355\u65e5\u671f"},t("create_date",{})(P.a.createElement(W,{style:{width:"250px"}}))),P.a.createElement(Q,_()({label:"\u8fd0\u5355\u53f7"},s),t("order_code",{})(P.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),P.a.createElement(Q,_()({label:"\u8d27\u8f66\u7f16\u53f7"},s),t("shipsite_id",{})(P.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onShipSiteSelect,style:{width:"100px"},allowClear:!0},(c||[]).map(function(e){return P.a.createElement(X,{key:e.site_id,value:e.site_id},e.site_name)}))),t("car_code",{})(P.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"100px"}}))),P.a.createElement(Q,_()({label:"\u7ecf\u529e\u4eba"},s),t("operator_id",{})(P.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"}},o.map(function(e){return P.a.createElement(X,{key:e.user_id,value:e.user_id},e.user_name)})))),P.a.createElement(z["a"].Item,s,P.a.createElement(C["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.courier,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.courier.senderList),l=t.loading,i=t.dispatch,c=this.state,s=c.selectedRows,u=c.current,p=c.pageSize,m=c.updateOrderModalVisible,h=c.downloadModalVisible,f=c.addFormModalVisible,y=c.record;return P.a.createElement("div",null,P.a.createElement(d["a"],{bordered:!1},P.a.createElement("div",{className:Z.a.tableList},P.a.createElement("div",{className:Z.a.tableListForm},this.renderForm()),P.a.createElement("div",{className:Z.a.tableListOperator}),P.a.createElement(q["a"],{selectedRows:s,loading:l,className:Z.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:p,current:u,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},rowClassNameHandler:function(e,t){return 6===e.order_status?Z.a.settleColor:7===e.order_status?Z.a.payColor:""},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick})),this.tableFooter()),P.a.createElement(K["a"],{modalVisible:m,record:y,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch,isEdit:1,dispatch:i}),P.a.createElement(J,{modalVisible:f,addFormDataHandle:this.addFormDataHandle,onCancelHandler:this.onCancelAddFormClick,senderList:o,selectedRows:s}),P.a.createElement(b["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:h,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(H["PureComponent"]),c=s))||c)||c);t["default"]=$},Dnn4:function(e,t,a){e.exports={content:"antd-pro-components-page-header-wrapper-index-content"}},G3lK:function(e,t,a){e.exports={headerSearch:"antd-pro-components-header-search-index-headerSearch",input:"antd-pro-components-header-search-index-input",show:"antd-pro-components-header-search-index-show"}},GOny:function(e,t,a){"use strict";a.r(t);a("2qtc");var n,r,o,l,i=a("kLXV"),c=(a("IzEo"),a("bx4M")),s=(a("+L6B"),a("2/Rp")),d=a("p0pE"),u=a.n(d),p=a("d6i3"),m=a.n(p),h=a("1l/V"),f=a.n(h),y=a("2Taf"),w=a.n(y),g=a("vZ4D"),b=a.n(g),v=a("l4Ni"),x=a.n(v),S=a("ujKo"),_=a.n(S),C=a("MhPg"),E=a.n(C),k=(a("7Kak"),a("9yH6")),L=(a("OaEy"),a("2fM7")),M=(a("5NDa"),a("5rEg")),O=(a("FJo9"),a("L41K")),D=(a("y8nQ"),a("Vl3Y")),V=(a("iQDF"),a("+eQT")),I=a("q1tI"),T=a.n(I),F=a("MuoO"),N=a("wd/R"),A=a.n(N),R=a("CkN6"),z=(a("zHco"),a("gA67")),H=a.n(z),P=(a("17x9"),a("S+eF"),a("XS0u")),Y=V["a"].RangePicker,j=D["a"].Item,B=(O["a"].Step,M["a"].TextArea,L["a"].Option),q=(k["a"].Group,JSON.parse(localStorage.getItem("site")||"{}")),K=(JSON.parse(localStorage.getItem("user")||"{}"),n=Object(F["connect"])(function(e){var t=e.customer,a=e.company,n=e.orderlist,r=e.site,o=e.car,l=e.receiver,i=e.loading;return{customer:t,company:a,orderlist:n,site:r,car:o,receiver:l,loading:i.models.rule}}),r=D["a"].create(),n(o=r((l=function(e){function t(){var e,a;w()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=x()(this,(e=_()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],formValues:{},current:1,pageSize:20,departModalVisible:!1,currentCompany:{},currentShipSite:{}},a.columns=[{title:"\u8d27\u5355\u53f7",width:"80px",dataIndex:"order_code",sorter:!0,align:"right",render:function(e){return"".concat(e)},needTotal:!0},{title:"\u53d1\u8d27\u5ba2\u6237",width:"80px",sorter:!0,dataIndex:"sendcustomer_name"},{title:"\u6536\u83b7\u5ba2\u6237",width:"80px",sorter:!0,dataIndex:"getcustomer_name"},{title:"\u5e94\u6536\u8d27\u6b3e",width:"80px",sorter:!0,dataIndex:"order_amount"},{title:"\u5b9e\u6536\u8d27\u6b3e",width:"80px",dataIndex:"order_real"},{title:"\u6298\u540e\u8fd0\u8d39",width:"80px",sorter:!0,dataIndex:"trans_discount"},{title:"\u8fd0\u8d39\u65b9\u5f0f",width:"80px",dataIndex:"trans_type",sorter:!0,render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t}},{title:"\u57ab\u4ed8",width:"80px",dataIndex:"order_advancepay_amount"},{title:"\u9001\u8d27\u8d39",width:"80px",dataIndex:"deliver_amount"},{title:"\u4fdd\u4ef7\u8d39",width:"80px",dataIndex:"insurance_fee"},{title:"\u8d27\u7269\u540d\u79f0",width:"150px",dataIndex:"order_name"},{title:"\u5f55\u7968\u65f6\u95f4",width:"170px",dataIndex:"create_date",render:function(e){return T.a.createElement("span",null,e?A()(Number(e)).format("YYYY-MM-DD HH:mm:ss"):"")}},{title:"\u7ad9\u70b9",width:"80px",dataIndex:"site_name"},{title:"\u7ed3\u7b97\u65e5\u671f",width:"100px",dataIndex:"settle_date",render:function(e){return T.a.createElement("span",null,e?A()(Number(e)).format("YYYY-MM-DD"):"")}},{title:"\u4ed8\u6b3e\u65e5\u671f",width:"100px",dataIndex:"pay_date",render:function(e){return T.a.createElement("span",null,e?A()(Number(e)).format("YYYY-MM-DD"):"")}},{title:"\u6ede\u7eb3\u91d1",width:"80px",dataIndex:"late_fee"},{title:"\u5956\u52b1\u91d1",width:"80px",dataIndex:"bonus_amount"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.setCurrentCompany=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 2==P["a"].company_type?(a.setState({currentCompany:P["a"]}),P["a"]):e&&e.length>0?(a.setState({currentCompany:e[0]}),e[0]):{}},a.getLastCarInfo=f()(m.a.mark(function e(){var t,n,r,o,l,i,c;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state,r=n.currentCompany,o=void 0===r?{}:r,l=n.currentShipSite,i=void 0===l?{}:l,e.next=4,t({type:"car/getLastCarCodeAction",payload:{company_id:o.company_id,shipsite_id:i.site_id}});case 4:return c=e.sent,e.abrupt("return",c);case 6:case"end":return e.stop()}},e)})),a.handleStandardTableChange=function(){var e=f()(m.a.mark(function e(t,n,r){var o,l,i,c;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.handleFormReset=function(){var e=a.props,t=e.form,n=e.dispatch;t.resetFields(),a.setState({formValues:{}}),n({type:"rule/fetch",payload:{}})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onCompanySelect=function(){var e=f()(m.a.mark(function e(t,n){var r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.props,r.dispatch,o=r.company.branchCompanyList,r.form,r.car.lastCar,l=o.filter(function(e){if(e.company_id==t)return e}),l.length>0&&a.setState({currentCompany:l[0]}),e.next=5,a.getLastCarInfo();case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onShipSiteSelect=function(){var e=f()(m.a.mark(function e(t){var n,r,o,l,i;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.site.entrunkSiteList,r=void 0===n?[]:n,o={},l=0;case 3:if(!(l<r.length)){e.next=11;break}if(i=r[l],i.site_id!=t){e.next=8;break}return o=i,e.abrupt("break",11);case 8:l++,e.next=3;break;case 11:return e.next=13,a.setState({currentShipSite:o});case 13:a.getLastCarInfo();case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault();var t=a.props;t.dispatch,t.form,a.state.currentCompany;a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize,s={};o.validateFields(function(a,n){if(!a){var o=n;Object.keys(o).forEach(function(e){o[e]||delete o[e]}),n.create_date&&(o.create_date=["".concat(n.create_date.valueOf())]),n.entrunk_date&&n.entrunk_date.length>0&&(o.entrunk_date=n.entrunk_date.map(function(e){return"".concat(e.valueOf())})),o.order_status=[3,10],s=o,s=Object.assign({filter:s},e),r({type:"orderlist/getOrderListAction",payload:u()({pageNo:t||i,pageSize:c},s)}),r({type:"orderlist/getOrderStatisticAction",payload:u()({},s)})}}),a.getLastCarInfo()},a.tableFooter=function(){var e=a.props,t=e.orderlist,n=t.total,r=t.totalOrderAmount,o=t.totalTransAmount,l=(t.totalInsurancefee,t.totalRealTransAmount,t.totalRealOrderAmount),i=t.totalAdvancepayAmount,c=t.totalDeliverAmount,s=t.totalTifuTransAmount,d=t.totalXianTransAmount,u=t.totalLatefee,p=t.totalBonusfee,m=t.totalCarFeeConfirm,h=t.totalCarFee,f=t.totalTifuInsurance,y=t.totalXianInsurence;e.car.lastCar;return T.a.createElement("div",{className:H.a.tableFooter},T.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",r||"0"),T.a.createElement("span",{className:H.a.footerSplit},"\u5b9e\u6536\u8d27\u6b3e\uff1a",l||"0"),T.a.createElement("span",{className:H.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",o||"0"),T.a.createElement("span",{className:H.a.footerSplit},"\u63d0\u4ed8\u8fd0\u8d39\uff1a",s||"0"),T.a.createElement("span",{className:H.a.footerSplit},"\u897f\u5b89\u8fd0\u8d39\uff1a",d||"0"),T.a.createElement("span",{className:H.a.footerSplit},"\u57ab\u4ed8\u8fd0\u8d39\uff1a",i||"0"),T.a.createElement("span",{className:H.a.footerSplit},"\u9001\u8d27\u8d39\uff1a",c||"0"),T.a.createElement("span",{className:H.a.footerSplit},"\u897f\u5b89\u4fdd\u8d39\uff1a",y||"0"),T.a.createElement("span",{className:H.a.footerSplit},"\u63d0\u4ed8\u4fdd\u8d39\uff1a",f||"0"),T.a.createElement("span",{className:H.a.footerSplit},"\u6ede\u7eb3\u91d1\uff1a",u||"0"),T.a.createElement("span",{className:H.a.footerSplit},"\u5956\u91d1\uff1a",p||"0"),T.a.createElement("span",{className:H.a.footerSplit},"\u672a\u7ed3\u7b97\u8d27\u8f66\u8fd0\u8d39\uff1a",h||"0"),T.a.createElement("span",{className:H.a.footerSplit},"\u5df2\u7ed3\u7b97\u8d27\u8f66\u8fd0\u8d39\uff1a",m||"0"),T.a.createElement("span",{className:H.a.footerSplit},"\u7968\u6570\uff1a",n||"0"))},a}return E()(t,e),b()(t,[{key:"componentDidMount",value:function(){var e=f()(m.a.mark(function e(){var t,a,n,r;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getCompanyList",payload:{}});case 3:return a=e.sent,e.next=6,t({type:"site/getSiteListAction",payload:{}});case 6:n=e.sent,this.setCurrentCompany(a),n&&n.length>0&&(r=n.filter(function(e){return 3==e.site_type||2==e.site_type}),r.length>0&&this.setState({currentShipSite:r[0]})),this.getLastCarInfo(),this.getOrderList();case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.company.branchCompanyList,n=e.site,r=n.entrunkSiteList,o=n.siteList,l=e.car.lastCar,i=this.state,c=i.currentCompany,d=void 0===c?{}:c,u=i.currentShipSite,p=void 0===u?{}:u,m={};return m.initialValue=1==P["a"].company_type?d.company_id||"":P["a"].company_id,T.a.createElement(D["a"],{onSubmit:this.handleSearch,layout:"inline"},T.a.createElement(j,{label:"\u5206\u516c\u53f8"},t("company_id",m)(T.a.createElement(L["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"},allowClear:!0},(1==P["a"].company_type?a:[P["a"]]).map(function(e){return T.a.createElement(B,{key:e.company_id,value:e.company_id},e.company_name)})))),1==P["a"].company_type&&T.a.createElement(j,{label:"\u7ad9\u70b9"},t("site_id",{initialValue:q.site_id})(T.a.createElement(L["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},allowClear:!0},(3!=q.site_type?[q]:o).map(function(e){return T.a.createElement(B,{key:e.site_id,value:e.site_id},e.site_name)})))),T.a.createElement(j,{label:"\u914d\u8f7d\u90e8"},t("shipsite_id",{initialValue:p.site_id})(T.a.createElement(L["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},onSelect:this.onShipSiteSelect,allowClear:!0},(r||[]).map(function(e){return T.a.createElement(B,{key:e.site_id,value:e.site_id},e.site_name)})))),T.a.createElement(j,{label:"\u8d27\u8f66\u7f16\u53f7"},t("car_code",{initialValue:l.car_code})(T.a.createElement(M["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"100px"}}))),T.a.createElement(j,{label:"\u5f55\u5165\u65e5\u671f"},t("create_date",{initialValue:A()((new Date).getTime())})(T.a.createElement(V["a"],{placeholder:"\u8bf7\u9009\u62e9",format:"YYYY-MM-DD",style:{width:"130px"}}))),T.a.createElement(j,{label:"\u6258\u8fd0\u65e5\u671f"},t("entrunk_date",{})(T.a.createElement(Y,{style:{width:"250px"}}))),T.a.createElement(j,null,T.a.createElement(s["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.orderlist,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.loading),l=this.state,d=l.selectedRows,u=l.current,p=l.pageSize,m=(l.currentCompany,l.departModalVisible);return T.a.createElement("div",null,T.a.createElement(c["a"],{bordered:!1},T.a.createElement("div",{className:H.a.tableList},T.a.createElement("div",{className:H.a.tableListForm},this.renderForm()),T.a.createElement("div",{className:H.a.tableListOperator},d.length>0&&T.a.createElement("span",null,T.a.createElement(s["a"],{onClick:this.onDownloadOrder},"\u8d27\u7269\u6e05\u5355\u4e0b\u8f7d"))),T.a.createElement(R["a"],{className:H.a.dataTable,scroll:{x:900,y:350},selectedRows:d,loading:o,rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:p,current:u,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},rowClassNameHandler:function(e,t){return 6===e.order_status?H.a.settleColor:7===e.order_status?H.a.payColor:""},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange})),this.tableFooter()),T.a.createElement(i["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:m,onOk:this.onDepartOk,onCancel:this.onDepartCancel},T.a.createElement("p",null),T.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d1\u8f66\u4e48\uff1f")))}}]),t}(I["PureComponent"]),o=l))||o)||o);t["default"]=K},IGtV:function(e,t,a){e.exports={fixedHeader:"antd-pro-layouts-header-fixedHeader"}},JwhZ:function(e,t,a){e.exports={head:"antd-pro-components-top-nav-header-index-head",light:"antd-pro-components-top-nav-header-index-light",main:"antd-pro-components-top-nav-header-index-main",wide:"antd-pro-components-top-nav-header-index-wide",left:"antd-pro-components-top-nav-header-index-left",right:"antd-pro-components-top-nav-header-index-right",rightMenu:"antd-pro-components-top-nav-header-index-rightMenu","ant-dropdown-trigger":"antd-pro-components-top-nav-header-index-ant-dropdown-trigger",logo:"antd-pro-components-top-nav-header-index-logo",menu:"antd-pro-components-top-nav-header-index-menu"}},KbBV:function(e,t,a){e.exports={"antd-pro-components-global-header-index-header":"antd-pro-pages-finance-finance-antd-pro-components-global-header-index-header",tableList:"antd-pro-pages-finance-finance-tableList",tableListOperator:"antd-pro-pages-finance-finance-tableListOperator",tableFooter:"antd-pro-pages-finance-finance-tableFooter",footerSplit:"antd-pro-pages-finance-finance-footerSplit",signColor:"antd-pro-pages-finance-finance-signColor",settleColor:"antd-pro-pages-finance-finance-settleColor",payColor:"antd-pro-pages-finance-finance-payColor",selectedColor:"antd-pro-pages-finance-finance-selectedColor",tableDetail:"antd-pro-pages-finance-finance-tableDetail",modalForm:"antd-pro-pages-finance-finance-modalForm",formItemFloat:"antd-pro-pages-finance-finance-formItemFloat",tableListForm:"antd-pro-pages-finance-finance-tableListForm",submitButtons:"antd-pro-pages-finance-finance-submitButtons",dataTable:"antd-pro-pages-finance-finance-dataTable","ant-form-item":"antd-pro-pages-finance-finance-ant-form-item","ant-select":"antd-pro-pages-finance-finance-ant-select",formItemNoBreak:"antd-pro-pages-finance-finance-formItemNoBreak"}},LTkr:function(e,t,a){e.exports={"antd-pro-components-global-header-index-header":"antd-pro-pages-search-search-antd-pro-components-global-header-index-header",tableList:"antd-pro-pages-search-search-tableList",tableListOperator:"antd-pro-pages-search-search-tableListOperator",tableFooter:"antd-pro-pages-search-search-tableFooter",footerSplit:"antd-pro-pages-search-search-footerSplit",signColor:"antd-pro-pages-search-search-signColor",settleColor:"antd-pro-pages-search-search-settleColor",payColor:"antd-pro-pages-search-search-payColor",selectedColor:"antd-pro-pages-search-search-selectedColor",tableDetail:"antd-pro-pages-search-search-tableDetail",modalForm:"antd-pro-pages-search-search-modalForm",formItemFloat:"antd-pro-pages-search-search-formItemFloat",tableListForm:"antd-pro-pages-search-search-tableListForm",submitButtons:"antd-pro-pages-search-search-submitButtons",dataTable:"antd-pro-pages-search-search-dataTable","ant-form-item":"antd-pro-pages-search-search-ant-form-item","ant-select":"antd-pro-pages-search-search-ant-select",formItemNoBreak:"antd-pro-pages-search-search-formItemNoBreak"}},OQ55:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d,u,p,m=a("bx4M"),h=(a("miYZ"),a("tsqr")),f=a("p0pE"),y=a.n(f),w=a("d6i3"),g=a.n(w),b=a("1l/V"),v=a.n(b),x=(a("+BJd"),a("mr32")),S=(a("2qtc"),a("kLXV")),_=(a("14J3"),a("BMrR")),C=(a("jCWc"),a("kPKH")),E=a("jehZ"),k=a.n(E),L=(a("5NDa"),a("5rEg")),M=(a("+L6B"),a("2/Rp")),O=(a("O3gP"),a("lrIw")),D=a("2Taf"),V=a.n(D),I=a("vZ4D"),T=a.n(I),F=a("l4Ni"),N=a.n(F),A=a("ujKo"),R=a.n(A),z=a("MhPg"),H=a.n(z),P=(a("OaEy"),a("2fM7")),Y=(a("y8nQ"),a("Vl3Y")),j=(a("iQDF"),a("+eQT")),B=a("q1tI"),q=a.n(B),K=a("MuoO"),U=a("wd/R"),Z=a.n(U),G=a("B797"),Q=a("CkN6"),X=a("mzDP"),W=a.n(X),J=(a("S+eF"),a("XS0u")),$=j["a"].RangePicker,ee=Y["a"].Item,te=P["a"].Option,ae=(n=Y["a"].create(),n((o=function(e){function t(e){var a;return V()(this,t),a=N()(this,R()(t).call(this,e)),a.onAbnormalSelect=function(e,t){console.log("####",t.props.abnormal_type_id),a.setState({abnormal_type_id:t.props.abnormal_type_id,abnormal_type:t.props.text}),console.log(e,t),console.log(a.state)},a.onAddHandler=function(){var e=a.props,t=e.addFormDataHandle,n=e.form;n.validateFields(function(e,a){console.log(a),e||t({transfer_money:a.transfer_money,transfer_type:0,transfer_user:a.transfer_user,remark:a.remark})})},a.renderCustomerOption=function(e){var t=O["a"].Option;return q.a.createElement(t,{key:e.incometype_id,incometype_id:e.incometype_id,text:e.incometype},e.incometype)},a.state={abnormal_type_id:"",abnormal_type:""},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return H()(t,e),T()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelHandler,n=(e.selectedRows,e.form);e.incomeTypes;return q.a.createElement(S["a"],{destroyOnClose:!0,title:"\u6dfb\u52a0\u6253\u6b3e",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[q.a.createElement(M["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),q.a.createElement(M["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:W.a.modalForm},q.a.createElement(Y["a"],null,q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],null,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u6253\u6b3e\u91d1\u989d"}),n.getFieldDecorator("transfer_money",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u6253\u6b3e\u91d1\u989d"}]})(q.a.createElement(L["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],null,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u6253\u6b3e\u4eba"}),n.getFieldDecorator("transfer_user",{initialValue:""})(q.a.createElement(L["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],null,q.a.createElement(ee,{labelCol:{span:3,offset:2},label:"\u5907\u6ce8"},n.getFieldDecorator("remark",{initialValue:""})(q.a.createElement(L["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}})))))))}}]),t}(B["PureComponent"]),r=o))||r),ne=(l=Y["a"].create(),l((c=function(e){function t(e){var a;return V()(this,t),a=N()(this,R()(t).call(this,e)),a.okHandle=function(){var e=a.props,t=e.form,n=e.record,r=e.onUpdateOrder;t.validateFields(function(e,a){e||(t.resetFields(),r(n,a))})},a.formItemLayout={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},a.formItemSmallLayout={labelCol:{xs:{span:25},sm:{span:9}},wrapperCol:{xs:{span:23},sm:{span:15}}},a.colLayout={md:8,sm:24},a.colSmallLayout={md:4,sm:20},a.col2Layout={md:10,sm:26},a.colLargeLayout={md:16,sm:32},a.formItemMiniLayout={labelCol:{xs:{span:22},sm:{span:6}},wrapperCol:{xs:{span:26},sm:{span:18}}},a.formLayout={labelCol:{span:7},wrapperCol:{span:13}},a}return H()(t,e),T()(t,[{key:"render",value:function(){var e=this.props,t=e.record,a=e.modalVisible,n=e.onCancelModal,r=e.form;return q.a.createElement(S["a"],{destroyOnClose:!0,title:"\u7f16\u8f91\u6258\u8fd0\u5355",visible:a,onCancel:function(){return n()},footer:[q.a.createElement(M["a"],{key:"btn-cancel",onClick:function(){return n()}},"\u53d6 \u6d88"),q.a.createElement(M["a"],{key:"btn-print",onClick:this.onOrderPrint},"\u6253 \u5370"),q.a.createElement(M["a"],{key:"btn-save",type:"primary",onClick:this.okHandle},"\u4fdd \u5b58")],width:800,className:W.a.modalForm},q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u5206\u516c\u53f8"}),t.company_name)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u7ad9\u70b9"}),t.site_name))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u6536\u8d27\u4eba\u7535\u8bdd"}),t.getcustomer_mobile)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u6536\u8d27\u4eba\u59d3\u540d"}),t.getcustomer_name)),q.a.createElement(C["a"],null,1==t.customer_type?q.a.createElement(x["a"],{color:"orange",style:{marginTop:10}},"VIP"):"")),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u53d1\u8d27\u4eba\u7535\u8bdd"}),t.sendcustomer_mobile)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u53d1\u8d27\u4eba\u59d3\u540d"}),t.sendcustomer_name))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.colLayout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u8fd0\u8d39"}),t.trans_amount)),q.a.createElement(C["a"],this.colSmallLayout,q.a.createElement(ee,{label:""},1==t.trans_type?"\u73b0\u4ed8":"\u56de\u4ed8")),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u6298\u540e\u8fd0\u8d39"}),t.trans_discount))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.colLayout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u8d27\u6b3e"}),t.order_amount)),q.a.createElement(C["a"],this.colLayout,q.a.createElement(ee,{label:""},t.bank_account))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4fdd\u4ef7\u91d1\u989d"}),t.insurance_amount)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4fdd\u4ef7\u8d39"}),t.insurance_fee))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u9001\u8d27\u8d39"}),t.deliver_amount)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u57ab\u4ed8\u91d1\u989d"}),t.order_advancepay_amount))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.colLargeLayout,q.a.createElement(ee,k()({},this.formItemMiniLayout,{label:"\u8d27\u7269\u540d\u79f0"}),t.order_name)),q.a.createElement(C["a"],this.colSmallLayout,q.a.createElement(ee,k()({},this.formItemLayout,{label:""}),t.order_num))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u8f6c\u8fdb/\u8f6c\u51fa"}),1==t.transfer_type?"\u8f6c\u51fa":"\u8f6c\u5165")),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u8d39"}),t.transfer_amount))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u5730\u5740"}),t.transfer_address)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u7269\u6d41"}),t.transfer_company_name))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u5355\u53f7"}),t.transfer_order_code)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u7535\u8bdd"}),t.transfer_company_mobile))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u5b9e\u6536\u8d27\u6b3e"}),r.getFieldDecorator("order_real",{initialValue:t.order_real})(q.a.createElement(L["a"],{placeholder:"\u8bf7\u8f93\u5165"})))),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u5b9e\u6536\u8fd0\u8d39"}),r.getFieldDecorator("trans_real",{initialValue:t.trans_real})(q.a.createElement(L["a"],{placeholder:"\u8bf7\u8f93\u5165"}))))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.colLargeLayout,q.a.createElement(ee,k()({},this.formItemMiniLayout,{label:"\u5907\u6ce8"}),r.getFieldDecorator("remark",{initialValue:t.remark})(q.a.createElement(L["a"],{placeholder:"\u8bf7\u8f93\u5165"}))))))}}]),t}(B["PureComponent"]),i=c))||i),re=(s=Object(K["connect"])(function(e){var t=e.customer,a=e.company,n=e.transfer,r=e.site,o=e.car,l=e.receiver,i=e.loading;return{customer:t,company:a,transfer:n,site:r,car:o,receiver:l,loading:i.models.rule}}),d=Y["a"].create(),s(u=d((p=function(e){function t(){var e,a;V()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=N()(this,(e=R()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},current:1,pageSize:20,record:{},orderModalVisible:!1,settleModalVisible:!1,cancelConfirmTransferModalVisible:!1,delTransferModalVisible:!1,addIncomeModalVisible:!1,signModalVisible:!1,cancelSignModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1,currentCompany:{}},a.columns=[{title:"\u6253\u6b3e\u65e5\u671f",dataIndex:"transfer_date",width:"170px",render:function(e){return q.a.createElement("span",null,e&&Z()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u6253\u6b3e\u91d1\u989d",dataIndex:"transfer_money",width:"80px"},{title:"\u6253\u6b3e\u4eba",dataIndex:"transfer_user",width:"80px"},{title:"\u786e\u8ba4\u4eba",dataIndex:"confirm_operator_name",width:"80px"},{title:"\u786e\u8ba4\u65e5\u671f",dataIndex:"confirm_date",width:"170px",render:function(e){return q.a.createElement("span",null,e&&Z()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u6253\u6b3e\u516c\u53f8",dataIndex:"company_name",width:"80px"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchIncomeTypeList=function(){var e=v()(g.a.mark(function e(t){var n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=t.companyId,r=t.siteId,o=a.props.dispatch,o({type:"income/getIncomeTypesAction",payload:{company_id:n,site_id:r}});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchCompanySiteList=function(){var e=v()(g.a.mark(function e(t){var n;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchGetCustomerList=function(){var e=v()(g.a.mark(function e(t){var n;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize,s=l.currentCompany;o.validateFields(function(a,n){if(!a){n.transfer_date&&n.transfer_date.length>0&&(n.transfer_date=n.transfer_date.map(function(e){return"".concat(e.valueOf())})),n.company_id=s.company_id||J["a"].company_id;var o=Object.assign({filter:n},e);r({type:"transfer/getTransferAction",payload:y()({pageNo:t||i,pageSize:c},o)}),r({type:"transfer/getTransferStatisticAction",payload:y()({},o)})}})},a.handleStandardTableChange=function(){var e=v()(g.a.mark(function e(t,n,r){var o,l,i;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(o=a.state.pageSize,l={},i=1,r.field&&(l={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==o){e.next=10;break}return i=1,e.next=8,a.setState({pageSize:t.pageSize});case 8:e.next=11;break;case 10:t&&t.current&&(i=t.current);case 11:return e.next=13,a.setState({current:i});case 13:a.getOrderList(l,i);case 14:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.addFormDataHandle=function(){var e=v()(g.a.mark(function e(t){var n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,e.next=3,n({type:"transfer/addTransferAction",payload:y()({},t,{company_id:J["a"].company_id,company_name:J["a"].company_name})});case 3:r=e.sent,0==r.code?(h["a"].success("\u6dfb\u52a0\u6210\u529f\uff01"),a.handleSearch(),a.onCancelIncomeClick()):h["a"].error(r.msg);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onAddIncomeClick=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addIncomeModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onCancelIncomeClick=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addIncomeModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onConfirmTransfer=v()(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.selectedRows,n=t.filter(function(e){return 1==e.transfer_type}),!(n.length>0)){e.next=5;break}return S["a"].info({content:"\u5df2\u786e\u8ba4\u7684\u6253\u6b3e\u4e0d\u80fd\u91cd\u590d\u786e\u8ba4\uff01"}),e.abrupt("return");case 5:r=Object(G["a"])(t),a.setState({accountStatistic:r,settleModalVisible:!0});case 7:case"end":return e.stop()}},e)})),a.onSettleCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({settleModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettleOk=v()(g.a.mark(function e(){var t,n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.transfer_id}),e.next=5,t({type:"transfer/confirmTransferAction",payload:{transfer_id:r}});case 5:o=e.sent,0==o.code?(h["a"].success("\u786e\u8ba4\u6253\u6b3e\u6210\u529f\uff01"),a.onSettleCancel()):h["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onCancelConfirmTransfer=v()(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.selectedRows,n=t.filter(function(e){return 0==e.transfer_type}),!(n.length>0)){e.next=5;break}return S["a"].info({content:"\u672a\u786e\u8ba4\u7684\u6253\u6b3e\u4e0d\u80fd\u53d6\u6d88\u786e\u8ba4\uff01"}),e.abrupt("return");case 5:r=Object(G["a"])(t),a.setState({accountStatistic:r,cancelConfirmTransferModalVisible:!0});case 7:case"end":return e.stop()}},e)})),a.onCancelConfirmTransferCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelConfirmTransferModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelConfirmTransferOk=v()(g.a.mark(function e(){var t,n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.transfer_id}),e.next=5,t({type:"transfer/cancelConfirmTransferAction",payload:{transfer_id:r}});case 5:o=e.sent,0==o.code?(h["a"].success("\u53d6\u6d88\u786e\u8ba4\u6253\u6b3e\u6210\u529f\uff01"),a.onCancelConfirmTransferCancel()):h["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onDelTransfer=v()(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.selectedRows,n=t.filter(function(e){return 1===e.transfer_type}),!(n.length>0)){e.next=5;break}return S["a"].info({content:"\u5df2\u7ecf\u786e\u8ba4\u7684\u6253\u6b3e\u4e0d\u80fd\u5220\u9664\uff01"}),e.abrupt("return");case 5:r=Object(G["a"])(t),a.setState({accountStatistic:r,delTransferModalVisible:!0});case 7:case"end":return e.stop()}},e)})),a.onDelConfirmTransferCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({delTransferModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDelConfirmTransferOk=v()(g.a.mark(function e(){var t,n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.transfer_id}),e.next=5,t({type:"transfer/delTransferAction",payload:{transfer_id:r}});case 5:o=e.sent,0==o.code?(h["a"].success("\u5220\u9664\u786e\u8ba4\u6253\u6b3e\u6210\u529f\uff01"),a.onDelConfirmTransferCancel(),a.getOrderList()):h["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onCompanySelect=function(){var e=v()(g.a.mark(function e(t){var n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.company.branchCompanyList,r=n.filter(function(e){if(e.company_id==t)return e}),r.length>0&&a.setState({currentCompany:r[0]});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCancelSign=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelSignModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onCancelSignCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelSignModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelSignOk=v()(g.a.mark(function e(){var t,n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"settle/cancelSignAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(h["a"].success("\u53d6\u6d88\u7b7e\u5b57\u6210\u529f\uff01"),a.handleSearch(),a.onCancelSignCancel()):h["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onPrint=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=v()(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"settle/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(h["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):h["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=v()(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"settle/downloadAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(h["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):h["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onEntrunkModalShow=function(){a.setState({orderModalVisible:!0})},a.onEntrunkModalCancel=function(){a.setState({orderModalVisible:!1})},a.onUpdateOrder=function(){var e=v()(g.a.mark(function e(t,n){var r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.props.dispatch,console.log(t,n),e.next=4,r({type:"order/updateOrderAction",payload:{orderIds:[t.order_id],order:{trans_real:n.trans_real,order_real:n.order_real}}});case 4:o=e.sent,0==o.code?(h["a"].success("\u4fee\u6539\u6210\u529f\uff01"),a.onEntrunkModalCancel()):h["a"].error(o.msg);case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onRowClick=function(e,t,a){},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onEntrunkModalShow()},a.tableFooter=function(){var e=a.props.transfer,t=e.total,n=e.totalTransferAmount,r=e.totalTransferConfirmAmount,o=e.totalTransferUnConfirmAmount,l=e.totalShouldTransfer;return q.a.createElement("div",{className:W.a.tableFooter},q.a.createElement("span",null,"\u6253\u6b3e\u603b\u989d\uff1a",n||0),q.a.createElement("span",{className:W.a.footerSplit},"\u672a\u786e\u8ba4\u6253\u6b3e\u603b\u989d\uff1a",o||0),q.a.createElement("span",{className:W.a.footerSplit},"\u5df2\u786e\u8ba4\u6253\u6b3e\u603b\u989d\uff1a",r||0),q.a.createElement("span",{className:W.a.footerSplit},"\u5e94\u6253\u6b3e\u603b\u989d\uff1a",l||0),q.a.createElement("span",{className:W.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return H()(t,e),T()(t,[{key:"componentDidMount",value:function(){var e=v()(g.a.mark(function e(){var t;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getBranchCompanyList",payload:y()({},J["a"])});case 3:this.handleSearch();case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.company.branchCompanyList,n=1==J["a"].company_type?a:[J["a"]],r={initialValue:n.length>0?n[0].company_id:""};return this.setState({currentCompany:n[0]}),q.a.createElement(Y["a"],{onSubmit:this.handleSearch,layout:"inline"},q.a.createElement(ee,{label:"\u5206\u516c\u53f8"},t("company_id",r)(q.a.createElement(P["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"80px"},onSelect:this.onCompanySelect},n.map(function(e){return q.a.createElement(te,{key:e.company_id,value:e.company_id},e.company_name)})))),q.a.createElement(ee,{label:"\u786e\u8ba4\u6253\u6b3e"},t("transfer_type",{initialValue:"0"})(q.a.createElement(P["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},allowClear:!0},q.a.createElement(te,{value:"1"},"\u5df2\u786e\u8ba4\u6253\u6b3e"),q.a.createElement(te,{value:"0"},"\u672a\u786e\u8ba4\u6253\u6b3e")))),q.a.createElement(ee,{label:"\u6253\u6b3e\u65e5\u671f"},t("transfer_date",{})(q.a.createElement($,{style:{width:"250px"}}))),q.a.createElement(ee,null,q.a.createElement(M["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e,t=this,a=this.props,n=a.transfer,r=n.transferList,o=n.total,l=(n.totalOrderAmount,n.totalTransAmount,a.loading),i=this.state,c=i.selectedRows,s=(i.accountStatistic,i.current),d=i.pageSize,u=i.orderModalVisible,p=i.settleModalVisible,h=i.cancelConfirmTransferModalVisible,f=i.delTransferModalVisible,y=i.addIncomeModalVisible,w=i.signModalVisible,g=i.cancelSignModalVisible,b=i.downloadModalVisible,v=i.printModalVisible,x=i.record;return c.length>0&&2==J["a"].company_type?e=q.a.createElement(M["a"],{onClick:this.onDelTransfer},"\u5220\u9664\u6253\u6b3e"):c.length>0&&1==J["a"].company_type&&(e=q.a.createElement("span",null,q.a.createElement(M["a"],{onClick:this.onConfirmTransfer},"\u786e\u8ba4\u6253\u6b3e"),q.a.createElement(M["a"],{onClick:this.onCancelConfirmTransfer},"\u53d6\u6d88\u786e\u8ba4"))),q.a.createElement("div",null,q.a.createElement(m["a"],{bordered:!1},q.a.createElement("div",{className:W.a.tableList},q.a.createElement("div",{className:W.a.tableListForm},this.renderForm()),q.a.createElement("div",{className:W.a.tableListOperator},2==J["a"].company_type?q.a.createElement(M["a"],{icon:"plus",type:"primary",onClick:function(){return t.onAddIncomeClick(!0)}},"\u6dfb\u52a0"):null,e),q.a.createElement(Q["a"],{selectedRows:c,className:W.a.dataTable,scroll:{x:900,y:350},loading:l,rowKey:"transfer_id",data:{list:r,pagination:{total:o,pageSize:d,current:s,onShowSizeChange:function(e,a){t.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,rowClassNameHandler:function(e,t){if(1===e.transfer_type)return W.a.payColor}})),this.tableFooter()),q.a.createElement(ne,{modalVisible:u,record:x,onCancelModal:this.onEntrunkModalCancel,onUpdateOrder:this.onUpdateOrder}),q.a.createElement(ae,{modalVisible:y,addFormDataHandle:this.addFormDataHandle,onCancelHandler:this.onCancelIncomeClick,selectedRows:c}),q.a.createElement(S["a"],{title:"\u786e\u8ba4\u6253\u6b3e",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:p,onOk:this.onSettleOk,onCancel:this.onSettleCancel},q.a.createElement("p",null,"\u60a8\u786e\u5b9a\u8981\u5bf9".concat(c.length,"\u6761\u8bb0\u5f55\u786e\u8ba4\u6253\u6b3e\u4e48\uff1f "))),q.a.createElement(S["a"],{title:"\u53d6\u6d88\u786e\u8ba4\u6253\u6b3e",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:h,onOk:this.onCancelConfirmTransferOk,onCancel:this.onCancelConfirmTransferCancel},q.a.createElement("p",null,"\u60a8\u786e\u5b9a\u8981\u5bf9".concat(c.length,"\u6761\u8bb0\u5f55\u53d6\u6d88\u786e\u8ba4\u6253\u6b3e\u4e48\uff1f "))),q.a.createElement(S["a"],{title:"\u5220\u9664\u786e\u8ba4\u6253\u6b3e",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:f,onOk:this.onDelConfirmTransferOk,onCancel:this.onDelConfirmTransferCancel},q.a.createElement("p",null,"\u60a8\u786e\u5b9a\u8981\u5220\u9664".concat(c.length,"\u6761\u786e\u8ba4\u6253\u6b3e\u8bb0\u5f55\u4e48\uff1f "))),q.a.createElement(S["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:w,onOk:this.onSignOk,onCancel:this.onSignCancel},q.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7b7e\u5b57\u4e48\uff1f")),q.a.createElement(S["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:g,onOk:this.onCancelSignOk,onCancel:this.onCancelSignCancel},q.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u7b7e\u5b57\u4e48\uff1f")),q.a.createElement(S["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:v,onOk:this.onPrintOk,onCancel:this.onPrintCancel},q.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),q.a.createElement(S["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:b,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},q.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(B["PureComponent"]),u=p))||u)||u);t["default"]=re},OVn6:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d,u,p,m,h,f=a("bx4M"),y=(a("+L6B"),a("2/Rp")),w=a("p0pE"),g=a.n(w),b=(a("miYZ"),a("tsqr")),v=(a("iQDF"),a("+eQT")),x=(a("O3gP"),a("lrIw")),S=(a("2qtc"),a("kLXV")),_=a("d6i3"),C=a.n(_),E=a("1l/V"),k=a.n(E),L=(a("14J3"),a("BMrR")),M=(a("jCWc"),a("kPKH")),O=a("2Taf"),D=a.n(O),V=a("vZ4D"),I=a.n(V),T=a("l4Ni"),F=a.n(T),N=a("ujKo"),A=a.n(N),R=a("MhPg"),z=a.n(R),H=(a("7Kak"),a("9yH6")),P=(a("OaEy"),a("2fM7")),Y=(a("5NDa"),a("5rEg")),j=(a("FJo9"),a("L41K")),B=(a("y8nQ"),a("Vl3Y")),q=a("q1tI"),K=a.n(q),U=a("MuoO"),Z=a("wd/R"),G=a.n(Z),Q=a("CkN6"),X=(a("zHco"),a("gA67")),W=a.n(X),J=(a("17x9"),a("S+eF"),a("XS0u")),$=B["a"].Item,ee=(j["a"].Step,Y["a"].TextArea,P["a"].Option),te=(H["a"].Group,JSON.parse(localStorage.getItem("site")||"{}")),ae=(JSON.parse(localStorage.getItem("user")||"{}"),n=Object(U["connect"])(function(e){var t=e.untrunkorder;return{untrunkorder:t}}),r=B["a"].create(),n(o=r((l=function(e){function t(e){var a;return D()(this,t),a=F()(this,A()(t).call(this,e)),a.getModalContent=function(){var e=a.props,t=e.form.getFieldDecorator,n=e.receiverList;return K.a.createElement(B["a"],{layout:"inline"},K.a.createElement(L["a"],{gutter:{md:8,lg:24,xl:48}},K.a.createElement(M["a"],{md:12,sm:24},K.a.createElement($,{label:"\u63a5\u8d27\u4eba"},t("receiver_id",{})(K.a.createElement(P["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"}},n.map(function(e){return K.a.createElement(ee,{key:e.courier_id,value:e.courier_id},e.courier_name)})))))))},a.onOkHandler=function(e){e.preventDefault();var t=a.props,n=t.dispatch,r=t.form,o=t.receiverList,l=t.selectedRows,i=t.onReceiverModalCancel;r.validateFields(function(){var e=k()(C.a.mark(function e(t,a){var r,c,s;return C.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:return r=l.map(function(e){return e.order_id}),c=o.filter(function(e){if(e.courier_id==a.receiver_id)return e}),a.order_id=r,a.receiver_name=c[0]&&c[0].courier_name,console.log(a),e.next=9,n({type:"untrunkorder/changeOrderReceiverAction",payload:a});case 9:s=e.sent,0==s.code&&i();case 11:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a.state={},a}return z()(t,e),I()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onReceiverModalCancel;return K.a.createElement(S["a"],{title:"\u66f4\u6539\u63a5\u8d27\u4eba",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",className:W.a.standardListForm,width:640,destroyOnClose:!0,visible:t,onOk:this.onOkHandler,onCancel:a},this.getModalContent())}}]),t}(q["PureComponent"]),o=l))||o)||o),ne=(i=Object(U["connect"])(function(e){var t=e.untrunkorder;return{untrunkorder:t}}),c=B["a"].create(),i(s=c((d=function(e){function t(e){var a;return D()(this,t),a=F()(this,A()(t).call(this,e)),a.onCarChange=function(e){for(var t,n=a.props,r=n.driverList,o=n.form,l=0;l<r.length;l++){var i=r[l];if(i.driver_plate==e){t=i;break}}t||o.setFieldsValue({driver_id:"",driver_name:"",driver_mobile:""})},a.onCarSelect=function(e,t){for(var n,r=t.props,o=a.props,l=o.driverList,i=o.form,c=0;c<l.length;c++){var s=l[c];if(s.driver_id==r.driverid){n=s;break}}n&&i.setFieldsValue({driver_name:n.driver_name,driver_mobile:n.driver_mobile})},a.onGetLastCar=function(e){var t=a.props.getLastCar;t(e.target.value)},a.renderCustomerOption=function(e){var t=x["a"].Option;return K.a.createElement(t,{key:e.driver_id,driverid:e.driver_id,value:"".concat(e.driver_id),text:e.driver_plate},e.driver_plate)},a.getModalContent=function(){var e=a.props,t=e.form.getFieldDecorator,n=(e.branchCompanyList,e.currentCompany,e.driverList),r=e.lastCar,o=void 0===r?{}:r,l=(e.getLastCar,{});return n.forEach(function(e){e.driver_id==o.driver_id&&Number(o.car_status)<3&&(l=e)}),Number(o.car_status)>=3&&(o={car_code:Number(o.car_code)+1}),K.a.createElement(B["a"],{layout:"inline",className:W.a.modalForm},K.a.createElement(L["a"],{gutter:{md:8,lg:24,xl:48}},K.a.createElement(M["a"],{md:12,sm:24},K.a.createElement($,{label:"\u8f66\u724c\u53f7"},t("driver_id",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u6536\u8f66\u724c\u53f7"}],initialValue:"".concat(o.driver_id||"")})(K.a.createElement(x["a"],{size:"large",style:{width:"100%"},dataSource:n.map(a.renderCustomerOption),onSelect:a.onCarSelect,onChange:a.onCarChange,placeholder:"\u8bf7\u8f93\u5165",optionLabelProp:"text",filterOption:function(e,t){return-1!==t.props.children.indexOf(e)}}," ")))),K.a.createElement(M["a"],{md:12,sm:24},K.a.createElement($,{label:"\u8f66\u4e3b\u59d3\u540d"},t("driver_name",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8f66\u4e3b\u59d3\u540d"}],initialValue:l.driver_name})(K.a.createElement(Y["a"],{placeholder:"\u8bf7\u8f93\u5165"}))))),K.a.createElement(L["a"],null,K.a.createElement(M["a"],{md:12,sm:24},K.a.createElement($,{label:"\u8054\u7cfb\u7535\u8bdd"},t("driver_mobile",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8054\u7cfb\u7535\u8bdd"}],initialValue:l.driver_mobile})(K.a.createElement(Y["a"],{placeholder:"\u8bf7\u8f93\u5165"})))),K.a.createElement(M["a"],{md:12,sm:24},K.a.createElement($,{label:"\u8d27\u8f66\u7f16\u53f7"},t("car_code",{initialValue:o.car_code,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8d27\u8f66\u7f16\u53f7"}]})(K.a.createElement(Y["a"],{placeholder:"\u8bf7\u8f93\u5165",disabled:!0}))))),K.a.createElement(L["a"],null,K.a.createElement(M["a"],{md:12,sm:24},K.a.createElement($,{label:"\u62c9\u8d27\u65e5\u671f"},t("car_date",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u62c9\u8d27\u65e5\u671f"}],initialValue:G()((new Date).getTime())})(K.a.createElement(v["a"],{placeholder:"\u8bf7\u9009\u62e9",format:"YYYY-MM-DD",style:{width:"100%"}})))),K.a.createElement(M["a"],{md:12,sm:24},K.a.createElement($,{label:"\u8d27\u8f66\u8d39\u7528"},t("car_fee",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u8d27\u8f66\u8d39\u7528"}],initialValue:o.car_fee||""})(K.a.createElement(Y["a"],{placeholder:"\u8bf7\u8f93\u5165"}))))))},a.onOkHandler=function(e){e.preventDefault();var t=a.props,n=t.dispatch,r=t.form,o=t.selectedRows,l=t.onEntrunkModalCancel,i=t.driverList,c=void 0===i?[]:i,s=t.onSearch,d=(t.lastCar,t.currentShipSite),u=void 0===d?{}:d,p=t.currentCompany,m=void 0===p?{}:p;r.validateFields(function(){var e=k()(C.a.mark(function e(t,a){var r,i,d,p;return C.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:return r=a,i=o.map(function(e){return e.order_id}),r.car_date&&r.car_date.valueOf&&(r.car_date="".concat(r.car_date.valueOf())),d=c.filter(function(e){if(e.driver_id==r.driver_id)return e}),d.length<=0?(r.driver_plate=r.driver_id,r.driver_id=0):(r.driver_plate=d[0].driver_plate,r.driver_id=Number(r.driver_id)),r.car_fee=Number(r.car_fee||0),r.shipsite_id=u.site_id,r.shipsite_name=u.site_name,r.car_code=r.car_code+"",r.company_id=m.company_id,e.next=14,n({type:"untrunkorder/entrunkOrderAction",payload:{order_id:i,car:r}});case 14:p=e.sent,0==p.code?(b["a"].success("\u88c5\u8f66\u6210\u529f"),s(),l()):b["a"].error(p.msg||"\u88c5\u8f66\u5931\u8d25");case 16:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a}return z()(t,e),I()(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onEntrunkModalCancel;return K.a.createElement(S["a"],{title:"\u8d27\u7269\u88c5\u8f66",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",className:W.a.standardListForm,width:700,destroyOnClose:!0,visible:t,onOk:this.onOkHandler,onCancel:a},this.getModalContent())}}]),t}(q["PureComponent"]),s=d))||s)||s),re=(u=Object(U["connect"])(function(e){var t=e.customer,a=e.company,n=e.untrunkorder,r=e.site,o=e.car,l=e.driver,i=e.receiver,c=e.loading;return{customer:t,company:a,untrunkorder:n,site:r,car:o,driver:l,receiver:i,loading:c.models.rule}}),p=B["a"].create(),u(m=p((h=function(e){function t(){var e,a;D()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=F()(this,(e=A()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],current:1,pageSize:20,receiverModalVisible:!1,entrunkModalVisible:!1,cancelShipModalVisible:!1,currentCompany:{},currentShipSite:{},lastCar:{}},a.columns=[{title:"\u5206\u516c\u53f8",width:"80px",dataIndex:"company_name"},{title:"\u5f55\u7968\u65f6\u95f4",width:"170px",dataIndex:"create_date",render:function(e){return K.a.createElement("span",null,G()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss"))}},{title:"\u8d27\u5355\u53f7",width:"80px",dataIndex:"order_code",align:"right",render:function(e){return"".concat(e)},needTotal:!0},{title:"\u53d1\u8d27\u5ba2\u6237",width:"80px",dataIndex:"sendcustomer_name"},{title:"\u6536\u83b7\u5ba2\u6237",width:"80px",dataIndex:"getcustomer_name"},{title:"\u5e94\u6536\u8d27\u6b3e",width:"80px",dataIndex:"order_amount"},{title:"\u8fd0\u8d39",width:"80px",dataIndex:"trans_amount"},{title:"\u6298\u540e\u8fd0\u8d39",width:"80px",dataIndex:"trans_discount"},{title:"\u8fd0\u8d39\u65b9\u5f0f",width:"80px",dataIndex:"trans_type",render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t}},{title:"\u57ab\u4ed8",width:"80px",dataIndex:"order_advancepay_amount"},{title:"\u9001\u8d27\u8d39",width:"80px",dataIndex:"deliver_amount"},{title:"\u4fdd\u4ef7\u8d39",width:"80px",dataIndex:"insurance_fee"},{title:"\u8d27\u7269\u540d\u79f0",width:"150px",dataIndex:"order_name"},{title:"\u7ecf\u529e\u4eba",width:"80px",dataIndex:"operator_name"},{title:"\u63a5\u8d27\u4eba",width:"80px",dataIndex:"receiver_name"},{title:"\u88c5\u914d\u7ad9",width:"100px",dataIndex:"shipsite_name"},{title:"\u7ad9\u70b9",width:"100px",dataIndex:"site_name"},{title:"\u4e2d\u8f6c",width:"80px",dataIndex:"transfer_type",render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t}},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.setCurrentCompany=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 2==J["a"].company_type?(a.setState({currentCompany:J["a"]}),J["a"]):e&&e.length>0?(a.setState({currentCompany:e[0]}),e[0]):{}},a.handleFormReset=function(){var e=a.props,t=e.form;e.dispatch;t.resetFields()},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props.dispatch,r=a.state,o=r.current,l=r.pageSize,i=a.props.form;i.validateFields(function(a,r){if(!a){var i=Object.assign({filter:r},e);n({type:"untrunkorder/getOrderListAction",payload:g()({pageNo:t||o,pageSize:l},i)}),n({type:"untrunkorder/getOrderStatisticAction",payload:g()({},i)})}})},a.handleStandardTableChange=function(){var e=k()(C.a.mark(function e(t,n,r){var o,l,i;return C.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(o=a.state.pageSize,l={},i=1,r.field&&(l={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==o){e.next=10;break}return i=1,e.next=8,a.setState({pageSize:t.pageSize});case 8:e.next=11;break;case 10:t&&t.current&&(i=t.current);case 11:return e.next=13,a.setState({current:i});case 13:a.getOrderList(l,i);case 14:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onCancelShipOk=k()(C.a.mark(function e(){var t,n,r,o;return C.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=a.props.dispatch,r=[],t.forEach(function(e){r.push(e.order_id)}),e.next=6,n({type:"untrunkorder/cancelShipAction",payload:{order_id:r}});case 6:o=e.sent,0==o.code&&(a.handleSearch(),b["a"].success("\u53d6\u6d88\u88c5\u56de\u6210\u529f"),a.onCancelShipCancel());case 8:case"end":return e.stop()}},e)})),a.onCancelShipCancel=function(){a.setState({cancelShipModalVisible:!1})},a.onCancelShip=function(){a.setState({cancelShipModalVisible:!0})},a.onChangeReceiver=function(){},a.onEntrunkModalShow=function(){var e=a.state,t=e.currentShipSite,n=void 0===t?{}:t,r=e.currentCompany,o=void 0===r?{}:r;o.company_id?n.site_id?a.setState({entrunkModalVisible:!0}):b["a"].error("\u8bf7\u5148\u9009\u62e9\u914d\u8f7d\u7ad9"):b["a"].error("\u8bf7\u5148\u9009\u62e9\u516c\u53f8")},a.onEntrunkModalCancel=function(){a.setState({entrunkModalVisible:!1})},a.onReceiverModalCancel=function(){a.setState({receiverModalVisible:!1})},a.onReceiverModalShow=function(){a.setState({receiverModalVisible:!0})},a.onCompanySelect=function(){var e=k()(C.a.mark(function e(t,n){var r,o,l,i,c;return C.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.company.branchCompanyList,o=void 0===r?[]:r,l={},i=0;case 3:if(!(i<o.length)){e.next=11;break}if(c=o[i],c.company_id!=t){e.next=8;break}return l=c,e.abrupt("break",11);case 8:i++,e.next=3;break;case 11:return e.next=13,a.setState({currentCompany:l});case 13:a.getLastCar(),a.handleSearch();case 15:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.getLastCar=function(){var e=k()(C.a.mark(function e(t){var n,r,o,l,i,c,s,d;return C.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.state,r=n.currentCompany,o=void 0===r?{}:r,l=n.currentShipSite,i=void 0===l?{}:l,c=a.props.dispatch,s={company_id:o.company_id,shipsite_id:i.site_id},t&&(s.car_code=t),e.next=6,c({type:"car/getLastCarCodeAction",payload:s});case 6:return d=e.sent,a.setState({lastCar:d}),e.abrupt("return",d);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onShipSiteSelect=function(){var e=k()(C.a.mark(function e(t){var n,r,o,l,i;return C.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.site.entrunkSiteList,r=void 0===n?[]:n,o={},l=0;case 3:if(!(l<r.length)){e.next=11;break}if(i=r[l],i.site_id!=t){e.next=8;break}return o=i,e.abrupt("break",11);case 8:l++,e.next=3;break;case 11:return e.next=13,a.setState({currentShipSite:o});case 13:a.getLastCar(),a.handleSearch();case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onSiteSelect=function(){var e=k()(C.a.mark(function e(t){return C.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.handleSearch();case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.selectRow=function(e){var t,n=a.state,r=n.selectedRows,o=n.selectedRowKeys,l=!1;console.log(o),o.forEach(function(a,n){a==e.order_id&&(l=!0,t=n)}),l?(r.splice(t,1),o.splice(t,1)):(r.push(e),o.push(e.order_id)),console.log(r),a.setState({selectedRows:r,selectedRowKeys:o})},a.onSelectedRowKeysChange=function(e){console.log(e)},a.tableFooter=function(){var e=a.props.untrunkorder,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=e.totalInsurancefee,l=(e.totalRealTransAmount,e.totalRealOrderAmount,e.totalAdvancepayAmount),i=e.totalDeliverAmount;return K.a.createElement("div",{className:W.a.tableFooter},K.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),K.a.createElement("span",{className:W.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),K.a.createElement("span",{className:W.a.footerSplit},"\u57ab\u4ed8\u603b\u989d\uff1a",l||"0"),K.a.createElement("span",{className:W.a.footerSplit},"\u9001\u8d27\u8d39\u603b\u989d\uff1a",i||"0"),K.a.createElement("span",{className:W.a.footerSplit},"\u4fdd\u4ef7\u8d39\u603b\u989d\uff1a",o||"0"),K.a.createElement("span",{className:W.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return z()(t,e),I()(t,[{key:"componentDidMount",value:function(){var e=k()(C.a.mark(function e(){var t,a,n,r,o;return C.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getCompanyList",payload:{}});case 3:return a=e.sent,e.next=6,t({type:"site/getSiteListAction",payload:{}});case 6:n=e.sent,t({type:"customer/sendCustomerListAction",payload:{pageNo:1,pageSize:100}}),t({type:"receiver/getReceiverListAction",payload:{pageNo:1,pageSize:100,type:"receiver",filter:{}}}),r=this.setCurrentCompany(a),t({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:r.company_id}}}),t({type:"driver/getDriverListAction",payload:{pageNo:1,pageSize:500,company_id:r.company_id}}),n&&n.length>0&&(o=n.filter(function(e){return 3==e.site_type||2==e.site_type}),o.length>0&&this.setState({currentShipSite:o[0]}),console.log(o)),this.getLastCar(),this.getOrderList();case 15:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.company.branchCompanyList,n=e.site,r=n.entrunkSiteList,o=n.siteList,l=e.receiver.receiverList,i=this.state.currentShipSite,c=void 0===i?{}:i,s={},d={};return 1!=J["a"].company_type&&(s.initialValue=J["a"].company_id),1==te.site_type&&(d.initialValue=te.site_id),K.a.createElement(B["a"],{onSubmit:this.handleSearch,layout:"inline"},K.a.createElement($,{label:"\u5206\u516c\u53f8"},t("company_id",s)(K.a.createElement(P["a"],{placeholder:"\u8bf7\u9009\u62e9",onChange:this.onCompanySelect,style:{width:"100px"},allowClear:2!=J["a"].company_type},(1==J["a"].company_type?a:[J["a"]]).map(function(e){return K.a.createElement(ee,{key:e.company_id,value:e.company_id},e.company_name)})))),K.a.createElement($,{label:"\u7ad9\u70b9"},t("site_id",d)(K.a.createElement(P["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},onChange:this.onSiteSelect,allowClear:!0},(3!=te.site_type&&1==J["a"].company_type?[te]:o).map(function(e){return K.a.createElement(ee,{key:e.site_id,value:e.site_id},e.site_name)})))),K.a.createElement($,{label:"\u914d\u8f7d\u90e8"},t("shipsite_id",{initialValue:c.site_id})(K.a.createElement(P["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},onChange:this.onShipSiteSelect,allowClear:!0},r.map(function(e){return K.a.createElement(ee,{key:e.site_id,value:e.site_id},e.site_name)})))),K.a.createElement($,{label:"\u63a5\u8d27\u4eba"},t("receiver_id",{})(K.a.createElement(P["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},allowClear:!0},l.map(function(e){return K.a.createElement(ee,{key:e.courier_id,value:e.courier_id},e.courier_name)})))),K.a.createElement($,null,K.a.createElement(y["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.untrunkorder,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.company.branchCompanyList),l=t.receiver.receiverList,i=t.site.entrunkSiteList,c=t.driver.driverList,s=t.loading,d=this.state,u=d.selectedRows,p=d.receiverModalVisible,m=d.current,h=d.pageSize,w=d.entrunkModalVisible,g=d.currentCompany,b=d.cancelShipModalVisible,v=d.currentShipSite,x=d.lastCar,_=!0;return 1!=J["a"].company_type&&(_=!1),("site_admin"==CacheRole.role_value&&2!=te.site_type||["site_searchuser"].indexOf(CacheRole.role_value)>=0)&&(_=!1),K.a.createElement("div",null,K.a.createElement(f["a"],{bordered:!1},K.a.createElement("div",{className:W.a.tableList},K.a.createElement("div",{className:W.a.tableListForm},this.renderForm()),K.a.createElement("div",{className:W.a.tableListOperator},u.length>0&&_&&K.a.createElement("span",null,K.a.createElement(y["a"],{onClick:this.onCancelShip},"\u53d6\u6d88\u88c5\u56de"),K.a.createElement(y["a"],{onClick:this.onReceiverModalShow},"\u66f4\u6539\u63a5\u8d27\u4eba"),K.a.createElement(y["a"],{onClick:this.onEntrunkModalShow},"\u88c5\u8f66"),K.a.createElement(y["a"],{onClick:this.onPrintOrder},"\u6253\u5370\u6e05\u5355"),K.a.createElement(y["a"],{onClick:this.onDownloadOrder},"\u4e0b\u8f7d\u6e05\u5355"))),K.a.createElement(Q["a"],{className:W.a.dataTable,scroll:{x:900,y:350},selectedRows:u,loading:s,rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:h,current:m,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onClickRow:this.onClickRow,onChange:this.handleStandardTableChange})),this.tableFooter()),w&&K.a.createElement(ne,{modalVisible:w,selectedRows:u,branchCompanyList:o,currentCompany:g,onEntrunkModalCancel:this.onEntrunkModalCancel,driverList:c,lastCar:x,getLastCar:this.getLastCar,onSearch:this.handleSearch,currentShipSite:v}),K.a.createElement(ae,{receiverList:l,entrunkSiteList:i,modalVisible:p,selectedRows:u,currentCompany:g,onReceiverModalCancel:this.onReceiverModalCancel}),K.a.createElement(S["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:b,onOk:this.onCancelShipOk,onCancel:this.onCancelShipCancel},K.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u53d6\u6d88\u88c5\u56de\u4e48\uff1f")))}}]),t}(q["PureComponent"]),m=h))||m)||m);t["default"]=re},OYVh:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("5NDa"),a("5rEg")),p=(a("miYZ"),a("tsqr")),m=a("p0pE"),h=a.n(m),f=a("d6i3"),y=a.n(f),w=a("1l/V"),g=a.n(w),b=(a("2qtc"),a("kLXV")),v=(a("14J3"),a("BMrR")),x=(a("jCWc"),a("kPKH")),S=a("jehZ"),_=a.n(S),C=(a("+L6B"),a("2/Rp")),E=(a("O3gP"),a("lrIw")),k=a("2Taf"),L=a.n(k),M=a("vZ4D"),O=a.n(M),D=a("l4Ni"),V=a.n(D),I=a("ujKo"),T=a.n(I),F=a("MhPg"),N=a.n(F),A=(a("iQDF"),a("+eQT")),R=(a("OaEy"),a("2fM7")),z=(a("y8nQ"),a("Vl3Y")),H=a("q1tI"),P=a.n(H),Y=a("MuoO"),j=a("wd/R"),B=a.n(j),q=(a("B797"),a("CkN6")),K=a("82qg"),U=a("9yR7"),Z=a.n(U),G=a("XS0u"),Q=z["a"].Item,X=R["a"].Option,W=A["a"].RangePicker,J=(n=z["a"].create(),n((o=function(e){function t(e){var a;return L()(this,t),a=V()(this,T()(t).call(this,e)),a.onAddHandler=function(){var e=a.props,t=e.addFormDataHandle,n=e.form,r=e.senderList,o=void 0===r?[]:r;n.validateFields(function(e,a){var n;e||(o.forEach(function(e){e.courier_id==a["courier_id"]&&(n=e)}),delete n["__typename"],t(n))})},a.renderCustomerOption=function(e){var t=E["a"].Option;return P.a.createElement(t,{key:e.expensetype_id,expensetype_id:e.expensetype_id,text:e.expensetype},e.expensetype)},a.state={},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return N()(t,e),O()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelHandler,n=e.senderList,r=e.form;return P.a.createElement(b["a"],{destroyOnClose:!0,title:"\u66f4\u6539\u9001\u8d27\u4eba",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[P.a.createElement(C["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),P.a.createElement(C["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:Z.a.modalForm},P.a.createElement(z["a"],null,P.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(x["a"],null,P.a.createElement(Q,_()({},this.formItemLayout,{label:"\u9001\u8d27\u4eba"}),r.getFieldDecorator("courier_id",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u9001\u8d27\u4eba"}]})(P.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"}},n.map(function(e){return P.a.createElement(X,{key:e.courier_id,value:e.courier_id},e.courier_name)}))))))))}}]),t}(H["PureComponent"]),r=o))||r),$=(l=Object(Y["connect"])(function(e){var t=e.customer,a=e.company,n=e.order,r=e.site,o=e.car,l=e.courier,i=e.loading;return{customer:t,company:a,order:n,site:r,car:o,courier:l,loading:i.models.rule}}),i=z["a"].create(),l(c=i((s=function(e){function t(){var e,a;L()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=V()(this,(e=T()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,downloadModalVisible:!1,addFormModalVisible:!1,addCourierModalVisible:!1,currentCompany:{}},a.columns=[{title:"\u9001\u8d27\u4eba",width:"80px",dataIndex:"sender_name",sorter:!0},{title:"\u8d27\u5355\u53f7",width:"80px",dataIndex:"order_code",sorter:!0},{title:"\u53d1\u8d27\u5ba2\u6237",width:"80px",dataIndex:"sendcustomer_name",sorter:!0},{title:"\u6536\u8d27\u5ba2\u6237",width:"80px",dataIndex:"getcustomer_name",sorter:!0},{title:"\u5e94\u6536\u8d27\u6b3e",width:"80px",dataIndex:"order_amount",sorter:!0},{title:"\u5b9e\u6536\u8d27\u6b3e",dataIndex:"order_real",width:"80px",sorter:!0},{title:"\u6298\u540e\u8fd0\u8d39",width:"80px",dataIndex:"trans_discount",sorter:!0},{title:"\u8fd0\u8d39\u65b9\u5f0f",width:"80px",dataIndex:"trans_type",sorter:!0,render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t}},{title:"\u57ab\u4ed8",width:"80px",dataIndex:"order_advancepay_amount"},{title:"\u9001\u8d27\u8d39",width:"80px",dataIndex:"deliver_amount"},{title:"\u4fdd\u4ef7\u8d39",width:"80px",dataIndex:"insurance_fee"},{title:"\u8d27\u7269\u540d\u79f0",width:"150px",dataIndex:"order_name"},{title:"\u5f55\u7968\u65f6\u95f4",width:"170px",dataIndex:"create_date",render:function(e){return P.a.createElement("span",null,e&&B()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u7ed3\u7b97\u65f6\u95f4",width:"170px",dataIndex:"settle_date",render:function(e){return P.a.createElement("span",null,e&&B()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u4ed8\u6b3e\u65e5\u671f",width:"170px",dataIndex:"pay_date",render:function(e){return P.a.createElement("span",null,e&&B()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u5206\u516c\u53f8",width:"80px",dataIndex:"company_name"},{title:"\u7ad9\u70b9",width:"80px",dataIndex:"site_name"},{title:"\u914d\u8f7d\u7ad9",width:"80px",dataIndex:"shipsite_name"},{title:"\u4e2d\u8f6c",width:"80px",dataIndex:"transfer_type",render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t}},{title:"\u5f02\u5e38\u60c5\u51b5",width:"80px",dataIndex:"abnormal_type"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.setCurrentCompany=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 2==G["a"].company_type?(a.setState({currentCompany:G["a"]}),G["a"]):e&&e.length>0?(a.setState({currentCompany:e[0]}),e[0]):{}},a.getLastCarInfo=g()(y.a.mark(function e(){var t,n,r,o,l,i;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.props,n=t.dispatch,r=t.site.entrunkSiteList,o=void 0===r?[]:r,l=a.state.currentCompany,i=void 0===l?{}:l,!(o.length>0)){e.next=5;break}return e.next=5,n({type:"car/getLastCarCodeAction",payload:{company_id:i.company_id,shipsite_id:o[0].site_id}});case 5:case"end":return e.stop()}},e)})),a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onGetCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchGetCustomerList()},a.onSendCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchSendCustomerList()},a.fetchGetCustomerList=function(){var e=g()(y.a.mark(function e(t){var n,r,o,l;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props,r=n.dispatch,o=n.branchCompanyList,l=a.state.currentCompany,l&&l.company_id||(l=o&&o[0]),r({type:"customer/getCustomerListAction",payload:{filter:{company_id:t||l&&l.company_id||0}}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchSenderList=function(){var e=g()(y.a.mark(function e(t){var n,r,o,l;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props,r=n.dispatch,o=n.branchCompanyList,l=a.state.currentCompany,l&&l.company_id||(l=o&&o[0]),r({type:"courier/getCourierListAction",payload:{pageNo:1,pageSize:100,type:"sender",filter:{company_id:l.company_id}}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchSendCustomerList=function(){var e=g()(y.a.mark(function e(t){var n;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/sendCustomerListAction",payload:{filter:{}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=g()(y.a.mark(function e(t,n){var r,o,l,i;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,o=r.dispatch,l=r.company.branchCompanyList,r.car.lastCar,o({type:"customer/resetCustomerPageNo",payload:{type:"Get"}}),i=l.filter(function(e){if(e.company_id==t)return e}),i.length>0&&a.setState({currentCompany:i[0]}),a.fetchSenderList(),a.fetchGetCustomerList(t);case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){Object.keys(n).forEach(function(e){var t=n[e];t||delete n[e]});var o=Object.assign({filter:n},e);r({type:"courier/getOrderListAction",payload:h()({pageNo:t||i,pageSize:c},o)}),r({type:"courier/getOrderStatisticAction",payload:h()({},o)})}})},a.handleStandardTableChange=function(){var e=g()(y.a.mark(function e(t,n,r){var o,l,i,c;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onPrintCheckList=function(){},a.onArriveNotify=function(){},a.onPrint=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=g()(y.a.mark(function e(){var t,n,r;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"unsettle/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(p["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):p["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=g()(y.a.mark(function e(){var t,n,r;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"unsettle/downloadAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(p["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):p["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onUpdateSenderModal=function(){a.setState({addFormModalVisible:!0})},a.addFormDataHandle=function(){var e=g()(y.a.mark(function e(t){var n,r,o,l,i,c;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.selectedRows,o=void 0===r?[]:r,l=[],i=[],o.forEach(function(e){l.push(e.order_id),i.push(e.getcustomer_id)}),e.next=7,n({type:"courier/updateCustomerCourierAction",payload:{type:"sender",order_id:l,customer_id:i,courier:t}});case 7:c=e.sent,c&&0==c.code?(p["a"].success("\u66f4\u65b0\u6210\u529f\uff01"),a.handleSearch(),a.onCancelAddFormClick()):p["a"].error(c&&c.msg||"\u66f4\u65b0\u5931\u8d25");case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCancelAddFormClick=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addFormModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDelSender=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:b["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u8981\u53d6\u6d88\u52fe\u9009\u8ba2\u5355\u3001\u6536\u8d27\u5ba2\u6237\u5173\u8054\u7684\u9001\u8d27\u4eba\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onDelSenderConfirm});case 1:case"end":return e.stop()}},e)})),a.onDelSenderConfirm=g()(y.a.mark(function e(){var t,n,r,o,l,i;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=void 0===n?[]:n,o=[],l=[],r.forEach(function(e){o.push(e.order_id),l.push(e.getcustomer_id)}),e.next=7,t({type:"courier/updateCustomerCourierAction",payload:{type:"sender",order_id:o,customer_id:l,courier:{}}});case 7:i=e.sent,i&&0==i.code?(p["a"].success("\u53d6\u6d88\u6210\u529f\uff01"),a.handleSearch()):p["a"].error(i&&i.msg||"\u53d6\u6d88\u5931\u8d25");case 9:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onUpdateOrderModalShow()},a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.courier,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=(e.totalInsurancefee,e.totalRealTransAmount,e.totalRealOrderAmount),l=e.totalAdvancepayAmount,i=e.totalDeliverAmount,c=e.totalTifuTransAmount,s=e.totalXianTransAmount,d=e.totalLatefee,u=e.totalBonusfee,p=e.totalCarFeeConfirm,m=e.totalCarFee,h=e.totalTifuInsurance,f=e.totalXianInsurence;return P.a.createElement("div",{className:Z.a.tableFooter},P.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u5b9e\u6536\u8d27\u6b3e\uff1a",o||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u63d0\u4ed8\u8fd0\u8d39\uff1a",c||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u897f\u5b89\u8fd0\u8d39\uff1a",s||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u57ab\u4ed8\u8fd0\u8d39\uff1a",l||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u9001\u8d27\u8d39\uff1a",i||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u897f\u5b89\u4fdd\u8d39\uff1a",f||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u63d0\u4ed8\u4fdd\u8d39\uff1a",h||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u6ede\u7eb3\u91d1\uff1a",d||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u5956\u91d1\uff1a",u||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u672a\u7ed3\u7b97\u8d27\u8f66\u8fd0\u8d39\uff1a",m||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u5df2\u7ed3\u7b97\u8d27\u8f66\u8fd0\u8d39\uff1a",p||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return N()(t,e),O()(t,[{key:"componentDidMount",value:function(){var e=g()(y.a.mark(function e(){var t,a,n;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,t({type:"courier/initOrderListAction"}),e.next=4,t({type:"company/getBranchCompanyList",payload:h()({},G["a"])});case 4:return a=e.sent,e.next=7,t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}});case 7:n=this.setCurrentCompany(a),t({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:n.company_id}}}),this.fetchSenderList(),this.getLastCarInfo();case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.customer,n=a.getCustomerList,r=(a.sendCustomerList,e.company.branchCompanyList),o=e.courier.senderList,l=void 0===o?[]:o,i=e.site.entrunkSiteList,c=void 0===i?[]:i,s=e.car.lastCar,d=this.state.currentCompany,p={},m={};return m.initialValue=d.company_id||"",P.a.createElement(z["a"],{onSubmit:this.handleSearch,layout:"inline"},P.a.createElement(Q,_()({label:"\u5206\u516c\u53f8"},p),t("company_id",m)(P.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"},allowClear:1==G["a"].company_type},(1==G["a"].company_type?r:[G["a"]]).map(function(e){return P.a.createElement(X,{key:e.company_id,value:e.company_id},e.company_name)})))),P.a.createElement(Q,{label:"\u8fd0\u5355\u65e5\u671f"},t("create_date",{})(P.a.createElement(W,{style:{width:"250px"}}))),P.a.createElement(Q,_()({label:"\u8fd0\u5355\u53f7"},p),t("order_code",{})(P.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),P.a.createElement(Q,_()({label:"\u8d27\u8f66\u7f16\u53f7"},p),t("shipsite_id",c.length>0?{initialValue:c[0].site_id}:{})(P.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onShipSiteSelect,style:{width:"100px"},allowClear:!0},(c||[]).map(function(e){return P.a.createElement(X,{key:e.site_id,value:e.site_id},e.site_name)}))),t("car_code",{initialValue:s.car_code})(P.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"80px"}}))),P.a.createElement(Q,_()({label:"\u9001\u8d27\u4eba"},p),t("sender_id",{})(P.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"},allowClear:!0},P.a.createElement(X,{key:-1,value:-1},"\u672a\u9001\u8d27"),l.map(function(e){return P.a.createElement(X,{key:e.courier_id,value:e.courier_id},e.courier_name)})))),P.a.createElement(Q,_()({label:"\u6536\u8d27\u4eba\u59d3\u540d"},p),t("getcustomer_id")(P.a.createElement(R["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onGetCustomerSelect,style:{width:"100px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onGetCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map(function(e){return P.a.createElement(X,{key:e.customer_id,value:e.customer_id},e.customer_name)})))),P.a.createElement(z["a"].Item,p,P.a.createElement(C["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.courier,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.courier.senderList),l=t.loading,i=t.dispatch,c=(t.car.lastCar,this.state),s=c.selectedRows,u=c.current,p=c.pageSize,m=c.updateOrderModalVisible,h=c.downloadModalVisible,f=c.addFormModalVisible,y=c.record;return P.a.createElement("div",null,P.a.createElement(d["a"],{bordered:!1},P.a.createElement("div",{className:Z.a.tableList},P.a.createElement("div",{className:Z.a.tableListForm},this.renderForm()),P.a.createElement("div",{className:Z.a.tableListOperator},s.length>0&&P.a.createElement("span",null,P.a.createElement(C["a"],{onClick:this.onUpdateSenderModal},"\u66f4\u6539\u9001\u8d27\u4eba"),P.a.createElement(C["a"],{onClick:this.onDelSender},"\u53d6\u6d88\u9001\u8d27\u4eba"),P.a.createElement(C["a"],{onClick:this.onDownload},"\u4e0b\u8f7d"),P.a.createElement(C["a"],{onClick:this.onPrintCheckList},"\u6258\u8fd0\u5355\u6253\u5370"),P.a.createElement(C["a"],{onClick:this.onArriveNotify},"\u5230\u8d27\u901a\u77e5"))),P.a.createElement(q["a"],{selectedRows:s,loading:l,className:Z.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:p,current:u,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},rowClassNameHandler:function(e,t){return 6===e.order_status?Z.a.settleColor:7===e.order_status?Z.a.payColor:""},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick})),this.tableFooter()),P.a.createElement(K["a"],{modalVisible:m,record:y,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch,isEdit:1,dispatch:i}),P.a.createElement(J,{modalVisible:f,addFormDataHandle:this.addFormDataHandle,onCancelHandler:this.onCancelAddFormClick,senderList:o,selectedRows:s}),P.a.createElement(b["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:h,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(H["PureComponent"]),c=s))||c)||c);t["default"]=$},PCNu:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("miYZ"),a("tsqr")),p=a("p0pE"),m=a.n(p),h=a("d6i3"),f=a.n(h),y=a("1l/V"),w=a.n(y),g=(a("2qtc"),a("kLXV")),b=(a("5NDa"),a("5rEg")),v=a("jehZ"),x=a.n(v),S=(a("14J3"),a("BMrR")),_=(a("jCWc"),a("kPKH")),C=(a("+L6B"),a("2/Rp")),E=(a("O3gP"),a("lrIw")),k=a("2Taf"),L=a.n(k),M=a("vZ4D"),O=a.n(M),D=a("l4Ni"),V=a.n(D),I=a("ujKo"),T=a.n(I),F=a("MhPg"),N=a.n(F),A=(a("OaEy"),a("2fM7")),R=(a("y8nQ"),a("Vl3Y")),z=(a("iQDF"),a("+eQT")),H=a("q1tI"),P=a.n(H),Y=a("MuoO"),j=a("wd/R"),B=a.n(j),q=a("B797"),K=a("CkN6"),U=a("82qg"),Z=a("b5ys"),G=a.n(Z),Q=(a("S+eF"),a("XS0u")),X=z["a"].RangePicker,W=R["a"].Item,J=A["a"].Option,$=(n=R["a"].create(),n((o=function(e){function t(e){var a;return L()(this,t),a=V()(this,T()(t).call(this,e)),a.onAbnormalSelect=function(e,t){console.log("####",t.props.abnormal_type_id),a.setState({abnormal_type_id:t.props.abnormal_type_id,abnormal_type:t.props.text}),console.log(e,t),console.log(a.state)},a.onDownAccountHandler=function(){var e=a.props,t=e.downAccountHandle,n=e.form,r=a.state,o=r.abnormal_type,l=r.abnormal_type_id;n.validateFields(function(e,a){console.log(a),e||(a.abnormal_type!=o&&(o=a.abnormal_type,l=0),t({abnormal_status:2,abnormal_reason:a.abnormal_reason,abnormal_amount:a.abnormal_amount,abnormal_resolve_type:a.abnormal_resolve_type,abnormal_remark:a.abnormal_remark,abnormal_type:o,abnormal_type_id:l}))})},a.renderCustomerOption=function(e){var t=E["a"].Option;return P.a.createElement(t,{key:e.abnormal_type_id,abnormal_type_id:e.abnormal_type_id,text:e.abnormal_type},e.abnormal_type)},a.state={abnormal_type_id:"",abnormal_type:""},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return N()(t,e),O()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.downCancel,n=e.selectedRows,r=e.form,o=e.abnormalTypes;Object(q["b"])(n),n.length>0&&n[0],this.state.agencyFee;return P.a.createElement(g["a"],{destroyOnClose:!0,title:"\u5904\u7406\u5f02\u5e38",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[P.a.createElement(C["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),P.a.createElement(C["a"],{key:"btn-save",type:"primary",onClick:this.onDownAccountHandler},"\u4fdd \u5b58")],width:800,className:G.a.modalForm},P.a.createElement(R["a"],null,P.a.createElement(S["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(_["a"],null,P.a.createElement(W,{labelCol:{span:3,offset:2},label:"\u5f02\u5e38\u5355\u53f7"},n.length))),P.a.createElement(S["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(_["a"],null,P.a.createElement(W,x()({},this.formItemLayout,{label:"\u5f02\u5e38\u7c7b\u578b"}),r.getFieldDecorator("abnormal_type",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u5f02\u5e38\u7c7b\u578b"}]})(P.a.createElement(E["a"],{size:"large",style:{width:"100%"},dataSource:o.map(this.renderCustomerOption),onSelect:this.onAbnormalSelect,placeholder:"\u8bf7\u8f93\u5165",optionLabelProp:"text",filterOption:function(e,t){return-1!==t.props.children.indexOf(e)}}))))),P.a.createElement(S["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(_["a"],null,P.a.createElement(W,{labelCol:{span:3,offset:2},label:"\u5f02\u5e38\u539f\u56e0"},r.getFieldDecorator("abnormal_reason",{initialValue:""})(P.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),P.a.createElement(S["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(_["a"],null,P.a.createElement(W,{labelCol:{span:3,offset:2},label:"\u4ea7\u751f\u91d1\u989d"},r.getFieldDecorator("abnormal_amount",{initialValue:""})(P.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),P.a.createElement(S["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(_["a"],null,P.a.createElement(W,{labelCol:{span:3,offset:2},label:"\u5904\u7406\u65b9\u5f0f"},r.getFieldDecorator("abnormal_resolve_type",{initialValue:""})(P.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),P.a.createElement(S["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(_["a"],null,P.a.createElement(W,{labelCol:{span:3,offset:2},label:"\u5907\u6ce8"},r.getFieldDecorator("abnormal_remark",{initialValue:""})(P.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}})))))))}}]),t}(H["PureComponent"]),r=o))||r),ee=(l=Object(Y["connect"])(function(e){var t=e.customer,a=e.company,n=e.abnormal,r=e.site,o=e.car,l=e.receiver,i=e.loading;return{customer:t,company:a,abnormal:n,site:r,car:o,receiver:l,loading:i.models.rule}}),i=R["a"].create(),l(c=i((s=function(e){function t(){var e,a;L()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=V()(this,(e=T()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,settleModalVisible:!1,downModalVisible:!1,signModalVisible:!1,cancelSignModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1},a.columns=[{title:"\u8d27\u5355\u53f7",dataIndex:"order_code",width:"80px",align:"right",render:function(e){return"".concat(e)},needTotal:!0},{title:"\u53d1\u8d27\u5ba2\u6237",dataIndex:"sendcustomer_name",width:"80px"},{title:"\u6536\u83b7\u5ba2\u6237",dataIndex:"getcustomer_name",width:"80px"},{title:"\u5e94\u6536\u8d27\u6b3e",dataIndex:"order_amount",width:"80px"},{title:"\u5b9e\u6536\u8d27\u6b3e",dataIndex:"order_real",width:"80px"},{title:"\u6298\u540e\u8fd0\u8d39",dataIndex:"trans_discount",width:"80px"},{title:"\u8fd0\u8d39\u65b9\u5f0f",dataIndex:"trans_type",width:"80px",render:function(e){return 1==e?"\u73b0\u4ed8":2==e?"\u56de\u4ed8":"\u63d0\u4ed8"}},{title:"\u57ab\u4ed8",dataIndex:"order_advancepay_amount",width:"80px"},{title:"\u9001\u8d27\u8d39",dataIndex:"deliver_amount",width:"80px"},{title:"\u4fdd\u4ef7\u8d39",dataIndex:"insurance_fee",width:"80px"},{title:"\u8d27\u7269\u540d\u79f0",dataIndex:"order_name",width:"150px"},{title:"\u5f55\u7968\u65f6\u95f4",dataIndex:"create_date",width:"170px",render:function(e){return P.a.createElement("span",null,e&&B()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss"))}},{title:"\u7ad9\u70b9",dataIndex:"site_name",width:"80px"},{title:"\u5f02\u5e38\u7c7b\u578b",dataIndex:"abnormal_type",width:"80px"},{title:"\u5904\u7406\u65b9\u5f0f",dataIndex:"abnormal_resolve_type",width:"80px"},{title:"\u5f02\u5e38\u91d1\u989d",dataIndex:"abnormal_amount",width:"80px"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.setCurrentCompany=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 2==Q["a"].company_type?(a.setState({currentCompany:Q["a"]}),Q["a"]):e&&e.length>0?(a.setState({currentCompany:e[0]}),e[0]):{}},a.handleFormReset=function(){var e=a.props,t=e.form,n=e.dispatch;t.resetFields(),a.setState({formValues:{}}),n({type:"rule/fetch",payload:{}})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchGetCustomerList=function(){var e=w()(f.a.mark(function e(t){var n;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=w()(f.a.mark(function e(t,n){var r,o;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.company.branchCompanyList,o=r.filter(function(e){if(e.company_id==t)return e}),o.length>0&&a.setState({currentCompany:o[0]});case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){n.abnormal_status=2,n.entrunk_date&&n.entrunk_date.length,Object.keys(n).forEach(function(e){n[e]||delete n[e]});var o=Object.assign({filter:n},e);r({type:"abnormal/getOrderListAction",payload:m()({pageNo:t||i,pageSize:c},o)}),r({type:"abnormal/getOrderStatisticAction",payload:m()({},o)})}})},a.handleStandardTableChange=function(){var e=w()(f.a.mark(function e(t,n,r){var o,l,i,c;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onPrint=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=w()(f.a.mark(function e(){var t,n,r;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"settle/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(u["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):u["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=w()(f.a.mark(function e(){var t,n,r;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"settle/downloadAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(u["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):u["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onUpdateOrderModalShow()},a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.abnormal,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=e.totalInsurancefee,l=e.totalAdvancepayAmount,i=e.totalDeliverAmount,c=e.totalAbnormalAmount;return P.a.createElement("div",{className:G.a.tableFooter},P.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),P.a.createElement("span",{className:G.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),P.a.createElement("span",{className:G.a.footerSplit},"\u57ab\u4ed8\u603b\u989d\uff1a",l||"0"),P.a.createElement("span",{className:G.a.footerSplit},"\u9001\u8d27\u8d39\u603b\u989d\uff1a",i||"0"),P.a.createElement("span",{className:G.a.footerSplit},"\u4fdd\u4ef7\u8d39\u603b\u989d\uff1a",o||"0"),P.a.createElement("span",{className:G.a.footerSplit},"\u7968\u6570\uff1a",t||"0"),P.a.createElement("span",{className:G.a.footerSplit},"\u8d54\u4ed8\u91d1\u989d\uff1a",c||"0"))},a}return N()(t,e),O()(t,[{key:"componentDidMount",value:function(){var e=w()(f.a.mark(function e(){var t,a,n;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"abnormal/initOrderListAction"});case 3:return e.next=5,t({type:"company/getBranchCompanyList",payload:m()({},Q["a"])});case 5:return a=e.sent,t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}}),n=this.setCurrentCompany(a),e.next=10,t({type:"abnormal/getAbnormalTypeListAction",payload:{pageNo:1,pageSize:100,company_id:n.company_id}});case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=(a.entrunkSiteList,a.normalSiteList),r=e.company.branchCompanyList,o=e.abnormal.abnormalTypes,l={};r.length>0&&1!=Q["a"].company_type&&(l.initialValue=r[0].company_id||"");var i=1==Q["a"].company_type;return P.a.createElement(R["a"],{onSubmit:this.handleSearch,layout:"inline"},P.a.createElement(W,{label:"\u5206\u516c\u53f8"},t("company_id",l)(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"},allowClear:i},r.map(function(e){return P.a.createElement(J,{key:e.company_id,value:e.company_id},e.company_name)})))),P.a.createElement(W,{label:"\u8fd0\u5355\u53f7"},t("order_code",{})(P.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),P.a.createElement(W,{label:"\u7ad9\u70b9"},t("site_id",{initialValue:Q["c"].site_id})(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"}},n.map(function(e){return P.a.createElement(J,{key:e.site_id,value:e.site_id},e.site_name)})))),P.a.createElement(W,{label:"\u5f02\u5e38\u7c7b\u578b"},t("abnormal_type_id")(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"}},o.map(function(e){return P.a.createElement(J,{key:e.abnormal_type_id,value:e.abnormal_type_id},e.abnormal_type)})))),P.a.createElement(W,{label:"\u6258\u8fd0\u65e5\u671f"},t("entrunk_date",{})(P.a.createElement(X,{style:{width:"250px"}}))),P.a.createElement(W,null,P.a.createElement(C["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.abnormal,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.loading),l=t.abnormal.abnormalTypes,i=this.state,c=i.selectedRows,s=i.accountStatistic,u=i.current,p=i.pageSize,m=i.updateOrderModalVisible,h=i.settleModalVisible,f=i.downModalVisible,y=i.signModalVisible,w=i.cancelSignModalVisible,b=i.downloadModalVisible,v=i.printModalVisible,x=i.record;return P.a.createElement("div",null,P.a.createElement(d["a"],{bordered:!1},P.a.createElement("div",{className:G.a.tableList},P.a.createElement("div",{className:G.a.tableListForm},this.renderForm()),P.a.createElement("div",{className:G.a.tableListOperator},c.length>0&&P.a.createElement("span",null,P.a.createElement(C["a"],{onClick:this.onDownload},"\u4e0b\u8f7d"))),P.a.createElement(K["a"],{selectedRows:c,loading:o,className:G.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:p,current:u,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick})),this.tableFooter()),P.a.createElement(U["a"],{modalVisible:m,record:x,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch}),P.a.createElement($,{modalVisible:f,downAccountHandle:this.downAccountHandle,downCancel:this.onDownCancel,selectedRows:c,abnormalTypes:l}),P.a.createElement(g["a"],{title:"\u53d6\u6d88\u7ed3\u8d26",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:h,onOk:this.onSettleOk,onCancel:this.onSettleCancel},P.a.createElement("p",null,"\u53d6\u6d88\u7ed3\u7b97\u8d27\u6b3e\u6761\u6570".concat(c.length,"\uff0c\u53d6\u6d88\u7ed3\u7b97\u603b\u989d ").concat(s.totalAccount," ")),P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u4e48\uff1f")),P.a.createElement(g["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:y,onOk:this.onSignOk,onCancel:this.onSignCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7b7e\u5b57\u4e48\uff1f")),P.a.createElement(g["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:w,onOk:this.onCancelSignOk,onCancel:this.onCancelSignCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u7b7e\u5b57\u4e48\uff1f")),P.a.createElement(g["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:v,onOk:this.onPrintOk,onCancel:this.onPrintCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),P.a.createElement(g["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:b,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(H["PureComponent"]),c=s))||c)||c);t["default"]=ee},Pc1n:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("miYZ"),a("tsqr")),p=a("p0pE"),m=a.n(p),h=(a("2qtc"),a("kLXV")),f=(a("14J3"),a("BMrR")),y=(a("jCWc"),a("kPKH")),w=a("jehZ"),g=a.n(w),b=(a("5NDa"),a("5rEg")),v=(a("+L6B"),a("2/Rp")),x=(a("O3gP"),a("lrIw")),S=a("d6i3"),_=a.n(S),C=a("1l/V"),E=a.n(C),k=a("2Taf"),L=a.n(k),M=a("vZ4D"),O=a.n(M),D=a("l4Ni"),V=a.n(D),I=a("ujKo"),T=a.n(I),F=a("MhPg"),N=a.n(F),A=(a("OaEy"),a("2fM7")),R=(a("y8nQ"),a("Vl3Y")),z=(a("iQDF"),a("+eQT")),H=a("q1tI"),P=a.n(H),Y=a("MuoO"),j=a("wd/R"),B=a.n(j),q=a("CkN6"),K=a("KbBV"),U=a.n(K),Z=a("XS0u"),G=z["a"].RangePicker,Q=R["a"].Item,X=A["a"].Option,W=(n=R["a"].create(),n((o=function(e){function t(e){var a;return L()(this,t),a=V()(this,T()(t).call(this,e)),a.onAbnormalSelect=function(e,t){a.setState({abnormal_type_id:t.props.abnormal_type_id,abnormal_type:t.props.text})},a.onAddHandler=function(){var e=a.props,t=e.addFormDataHandle,n=e.form,r=e.incomeTypes,o=void 0===r?[]:r,l=e.record,i=void 0===l?{}:l;n.validateFields(function(){var e=E()(_.a.mark(function e(a,r){var l,c;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=2;break}return e.abrupt("return");case 2:return l=!0,c="",o.forEach(function(e){e.incometype_id==r["incometype_id"]&&(l=!1,c=e.incometype)}),e.next=7,t({income_id:i.income_id||0,income_money:Number(r.income_money),incometype_id:l?"":r.incometype_id,incometype:l?r.incometype_id:c,income_reason:r.income_reason,remark:r.income_reason});case 7:i.income_id||n.setFieldsValue({income_money:"",income_reason:"",remark:""});case 8:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a.renderCustomerOption=function(e){var t=x["a"].Option;return P.a.createElement(t,{key:e.incometype_id,incometype_id:e.incometype_id,value:"".concat(e.incometype_id),text:e.incometype},e.incometype)},a.state={abnormal_type_id:"",abnormal_type:""},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return N()(t,e),O()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelHandler,n=e.record,r=void 0===n?{}:n,o=e.form,l=e.incomeTypes,i=void 0===l?[]:l;return P.a.createElement(h["a"],{destroyOnClose:!0,title:"\u6dfb\u52a0\u6536\u5165",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[P.a.createElement(v["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),P.a.createElement(v["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:U.a.modalForm},P.a.createElement(R["a"],null,P.a.createElement(f["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(y["a"],null,P.a.createElement(Q,g()({},this.formItemLayout,{label:"\u6536\u5165\u91d1\u989d"}),o.getFieldDecorator("income_money",{initialValue:r.income_money,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u6536\u5165\u91d1\u989d"}]})(P.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),P.a.createElement(f["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(y["a"],null,P.a.createElement(Q,g()({},this.formItemLayout,{label:"\u6536\u5165\u7c7b\u578b"}),o.getFieldDecorator("incometype_id",{initialValue:"".concat(r.incometype_id||""),rules:[{required:!0,message:"\u8bf7\u586b\u5199\u6536\u5165\u7c7b\u578b"}]})(P.a.createElement(x["a"],{size:"large",style:{width:"280px"},dataSource:i.map(this.renderCustomerOption),placeholder:"\u8bf7\u8f93\u5165",optionLabelProp:"text",allowClear:!0}," "))))),P.a.createElement(f["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(y["a"],null,P.a.createElement(Q,g()({},this.formItemLayout,{label:"\u6536\u5165\u539f\u56e0"}),o.getFieldDecorator("income_reason",{initialValue:r.income_reason})(P.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),P.a.createElement(f["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(y["a"],null,P.a.createElement(Q,{labelCol:{span:3,offset:2},label:"\u5907\u6ce8"},o.getFieldDecorator("remark",{initialValue:r.remark})(P.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}})))))))}}]),t}(H["PureComponent"]),r=o))||r),J=(l=Object(Y["connect"])(function(e){var t=e.customer,a=e.company,n=e.income,r=e.site,o=e.car,l=e.receiver,i=e.loading;return{customer:t,company:a,income:n,site:r,car:o,receiver:l,loading:i.models.rule}}),i=R["a"].create(),l(c=i((s=function(e){function t(){var e,a;L()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=V()(this,(e=T()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},currentCompany:{},currentSite:{},settleModalVisible:!1,addIncomeModalVisible:!1,signModalVisible:!1,cancelSignModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1},a.columns=[{title:"\u6536\u5165\u65e5\u671f",dataIndex:"income_date",width:"170px",sorter:!0,render:function(e){return P.a.createElement("span",null,e&&B()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss"))}},{title:"\u6536\u5165\u91d1\u989d",width:"80px",sorter:!0,dataIndex:"income_money"},{title:"\u6536\u5165\u7c7b\u578b",width:"140px",dataIndex:"incometype",sorter:!0},{title:"\u6536\u5165\u539f\u56e0",width:"120px",dataIndex:"income_reason",sorter:!0},{title:"\u7ad9\u70b9",width:"80px",dataIndex:"site_name",sorter:!0},{title:"\u5206\u516c\u53f8",width:"80px",dataIndex:"company_name",sorter:!0},{title:"\u64cd\u4f5c\u7528\u6237",dataIndex:"operator_name",sorter:!0},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchIncomeTypeList=E()(_.a.mark(function e(){var t,n,r;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n={},n.company_id=Z["a"].company_id||-1,1==Z["a"].company_type&&(n.site_id=Z["c"].site_id),e.next=6,t({type:"income/getIncomeTypesAction",payload:n});case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}},e)})),a.fetchCompanySiteList=function(){var e=E()(_.a.mark(function e(t){var n;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchGetCustomerList=function(){var e=E()(_.a.mark(function e(t){var n;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onSiteSelect=function(){var e=E()(_.a.mark(function e(t,n){var r,o,l;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.site.normalSiteList,o=void 0===r?[]:r,l=o.filter(function(e){if(e.site_id==t)return e}),l.length>0&&a.setState({currentSite:l[0]}),a.fetchIncomeTypeList({siteId:t});case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){n.income_date&&n.income_date.length>0&&(n.income_date=n.income_date.map(function(e){return"".concat(e.valueOf())})),n.company_id=Z["a"].company_id;var o=Object.assign({filter:n},e);r({type:"income/getIncomesAction",payload:m()({pageNo:t||i,pageSize:c},o)})}})},a.handleStandardTableChange=function(){var e=E()(_.a.mark(function e(t,n,r){var o,l,i,c;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.addFormDataHandle=function(){var e=E()(_.a.mark(function e(t){var n,r,o;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=m()({},t,{company_id:Z["a"].company_id,company_name:Z["a"].company_name}),Z["c"].site_id&&Object.assign(r,{site_id:Z["c"].site_id,site_name:Z["c"].site_name}),e.next=5,n({type:"income/addIncomeAction",payload:r});case 5:o=e.sent,o&&0==o.code?(u["a"].success(r.income_id?"\u7f16\u8f91\u6210\u529f":"\u6dfb\u52a0\u6210\u529f\uff01"),r.income_id&&a.onIncomeModalCancel()):u["a"].error(o&&o.msg||"\u6dfb\u52a0\u5931\u8d25");case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onAddIncomeClick=E()(_.a.mark(function e(){var t,n;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.currentSite,n=void 0===t?{}:t,1!=Z["a"].company_id||n.site_id){e.next=4;break}return h["a"].info({content:"\u8bf7\u5148\u9009\u62e9\u7ad9\u70b9"}),e.abrupt("return");case 4:a.setState({addIncomeModalVisible:!0,record:{}});case 5:case"end":return e.stop()}},e)})),a.onCancelIncomeClick=E()(_.a.mark(function e(){return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addIncomeModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onIncomeModalShow=function(){a.setState({addIncomeModalVisible:!0})},a.onIncomeModalCancel=function(){a.setState({addIncomeModalVisible:!1})},a.onUpdateOrder=function(){var e=E()(_.a.mark(function e(t,n){var r,o;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.props.dispatch,e.next=3,r({type:"order/updateOrderAction",payload:{orderIds:[t.order_id],order:{trans_real:n.trans_real,order_real:n.order_real}}});case 3:o=e.sent,0==o.code?(u["a"].success("\u4fee\u6539\u6210\u529f\uff01"),a.onIncomeModalCancel()):u["a"].error(o.msg);case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onRowClick=function(e,t,a){},a.onRowDoubleClick=function(e,t,n){var r=B()(Number(e.income_date)),o=B()(Number((new Date).getTime())),l=o.diff(r,"hours");l>=24?u["a"].error("\u8d85\u8fc724\u5c0f\u65f6\u8bb0\u5f55\u4e0d\u53ef\u7f16\u8f91"):(a.setState({record:e}),a.onIncomeModalShow())},a.tableFooter=function(){var e=a.props.income,t=e.total,n=e.totalIncome;return P.a.createElement("div",{className:U.a.tableFooter},P.a.createElement("span",null,"\u6536\u5165\u603b\u989d\uff1a",n||"0"),P.a.createElement("span",{className:U.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return N()(t,e),O()(t,[{key:"componentDidMount",value:function(){var e=E()(_.a.mark(function e(){var t;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,this.fetchCompanySiteList(Z["a"].company_id),e.next=4,this.fetchIncomeTypeList();case 4:return e.next=6,t({type:"income/getIncomeDetailsAction",payload:{}});case 6:this.getOrderList();case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=(a.entrunkSiteList,a.normalSiteList,e.company.branchCompanyList),r=void 0===n?[]:n,o=e.income.incomeTypes,l=void 0===o?[]:o,i={};return r.length>0&&(i.initialValue=r[0].company_id||""),P.a.createElement(R["a"],{onSubmit:this.handleSearch,layout:"inline"},1==Z["a"].company_type&&P.a.createElement(Q,{label:"\u7ad9\u70b9"},t("site_id",{initialValue:Z["c"].site_id})(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSiteSelect,style:{width:"150px"}},[Z["c"]].map(function(e){return P.a.createElement(X,{key:e.site_id,value:e.site_id},e.site_name)})))),P.a.createElement(Q,{label:"\u6536\u5165\u65e5\u671f"},t("income_date",{})(P.a.createElement(G,{style:{width:"250px"}}))),P.a.createElement(Q,{label:"\u6536\u5165\u5206\u7c7b"},t("incometype_id")(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"},allowClear:!0},l.map(function(e){return P.a.createElement(X,{key:e.incometype_id,value:e.incometype_id},e.incometype)})))),P.a.createElement(Q,null,P.a.createElement(v["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.income,n=a.incomeList,r=a.total,o=a.incomeTypes,l=(a.totalIncome,t.loading),i=this.state,c=i.selectedRows,s=i.current,u=i.pageSize,p=i.addIncomeModalVisible,m=i.downloadModalVisible,f=i.printModalVisible,y=i.record,w=!0;return["site_searchuser","site_admin"].indexOf(Z["b"].role_value)>=0&&(w=!1),P.a.createElement("div",null,P.a.createElement(d["a"],{bordered:!1},P.a.createElement("div",{className:U.a.tableList},P.a.createElement("div",{className:U.a.tableListForm},this.renderForm()),P.a.createElement("div",{className:U.a.tableListOperator},w&&P.a.createElement(v["a"],{icon:"plus",type:"primary",onClick:function(){return e.onAddIncomeClick(!0)}},"\u6dfb\u52a0")),P.a.createElement(q["a"],{selectedRows:c,loading:l,className:U.a.dataTable,scroll:{x:900,y:350},rowKey:"income_id",data:{list:n,pagination:{total:r,pageSize:u,current:s,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick})),this.tableFooter()),P.a.createElement(W,{modalVisible:p,addFormDataHandle:this.addFormDataHandle,onCancelHandler:this.onCancelIncomeClick,incomeTypes:o,selectedRows:c,record:y}),P.a.createElement(h["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:f,onOk:this.onPrintOk,onCancel:this.onPrintCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),P.a.createElement(h["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:m,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(H["PureComponent"]),c=s))||c)||c);t["default"]=J},PyAq:function(e,t,a){"use strict";a.r(t);a("2qtc");var n,r,o,l,i=a("kLXV"),c=(a("IzEo"),a("bx4M")),s=(a("+L6B"),a("2/Rp")),d=(a("5NDa"),a("5rEg")),u=a("jehZ"),p=a.n(u),m=(a("miYZ"),a("tsqr")),h=a("p0pE"),f=a.n(h),y=a("d6i3"),w=a.n(y),g=a("1l/V"),b=a.n(g),v=a("2Taf"),x=a.n(v),S=a("vZ4D"),_=a.n(S),C=a("l4Ni"),E=a.n(C),k=a("ujKo"),L=a.n(k),M=a("MhPg"),O=a.n(M),D=(a("OaEy"),a("2fM7")),V=(a("y8nQ"),a("Vl3Y")),I=a("q1tI"),T=a.n(I),F=a("MuoO"),N=a("wd/R"),A=a.n(N),R=a("B797"),z=a("CkN6"),H=a("82qg"),P=a("SLv7"),Y=a.n(P),j=a("XS0u"),B=V["a"].Item,q=D["a"].Option,K=(n=Object(F["connect"])(function(e){var t=e.common,a=e.customer,n=e.company,r=e.unsettle,o=e.site,l=e.car,i=e.receiver,c=e.loading;return{common:t,customer:a,company:n,unsettle:r,site:o,car:l,receiver:i,loading:c.models.rule}}),r=V["a"].create(),n(o=r((l=function(e){function t(){var e,a;x()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=E()(this,(e=L()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,settleModalVisible:!1,signModalVisible:!1,cancelSignModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1,currentCompany:{},currentShipSite:{},currentGetCustomer:{},currentSendCustomer:{}},a.columns=[{title:"\u8d27\u5355\u53f7",width:"80px",dataIndex:"order_code",sorter:!0},{title:"\u53d1\u8d27\u5ba2\u6237",width:"80px",dataIndex:"sendcustomer_name",sorter:!0},{title:"\u6536\u83b7\u5ba2\u6237",width:"80px",dataIndex:"getcustomer_name",sorter:!0},{title:"\u5e94\u6536\u8d27\u6b3e",width:"80px",dataIndex:"order_amount",sorter:!0},{title:"\u5b9e\u6536\u8d27\u6b3e",width:"80px",dataIndex:"order_real",sorter:!0},{title:"\u6298\u540e\u8fd0\u8d39",width:"80px",dataIndex:"trans_discount",sorter:!0},{title:"\u8fd0\u8d39\u65b9\u5f0f",width:"80px",dataIndex:"trans_type",sorter:!0,render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t}},{title:"\u57ab\u4ed8",width:"80px",dataIndex:"order_advancepay_amount"},{title:"\u9001\u8d27\u8d39",width:"80px",dataIndex:"deliver_amount"},{title:"\u4fdd\u4ef7\u8d39",width:"80px",dataIndex:"insurance_fee"},{title:"\u8d27\u7269\u540d\u79f0",width:"150px",dataIndex:"order_name"},{title:"\u5f55\u7968\u65f6\u95f4",width:"170px",dataIndex:"create_date",render:function(e){return T.a.createElement("span",null,e&&A()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u6ede\u7eb3\u91d1",width:"80px",dataIndex:"late_fee"},{title:"\u8d27\u8f66\u7f16\u53f7",width:"80px",dataIndex:"car_code"},{title:"\u7ad9\u70b9",width:"80px",dataIndex:"site_name"},{title:"\u4e2d\u8f6c",width:"80px",dataIndex:"transfer_type",render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t}},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.setCurrentCompany=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 2==j["a"].company_type?(a.setState({currentCompany:j["a"]}),j["a"]):e&&e.length>0?(a.setState({currentCompany:e[0]}),e[0]):{}},a.handleFormReset=function(){var e=a.props,t=e.form,n=e.dispatch;t.resetFields(),a.setState({formValues:{}}),n({type:"rule/fetch",payload:{}})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onGetCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchGetCustomerList()},a.onSendCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchSendCustomerList()},a.fetchGetCustomerList=function(){var e=b()(w.a.mark(function e(t){var n,r,o,l;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props,r=n.dispatch,o=n.branchCompanyList,l=a.state.currentCompany,l&&l.company_id||(l=o&&o[0]),r({type:"customer/getCustomerListAction",payload:{filter:{company_id:t||l&&l.company_id||0}}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchSendCustomerList=function(){var e=b()(w.a.mark(function e(t){var n;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/sendCustomerListAction",payload:{filter:{}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=b()(w.a.mark(function e(t,n){var r,o,l,i;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,o=r.dispatch,l=r.company.branchCompanyList,r.car.lastCar,o({type:"customer/resetCustomerPageNo",payload:{type:"Get"}}),a.fetchGetCustomerList(t),i=l.filter(function(e){if(e.company_id==t)return e}),i.length>0&&a.setState({currentCompany:i[0]});case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(n,o){if(!n){var l=Object.assign({filter:o},e);r({type:"unsettle/getOrderListAction",payload:f()({pageNo:t||i,pageSize:c},l)}),r({type:"unsettle/getOrderStatisticAction",payload:f()({},l)}),a.standardTable.cleanSelectedKeys()}})},a.handleStandardTableChange=function(){var e=b()(w.a.mark(function e(t,n,r){var o,l,i,c;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onSignOk=b()(w.a.mark(function e(){var t,n,r,o;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"unsettle/signAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(m["a"].success("\u7b7e\u5b57\u6210\u529f\uff01"),a.handleSearch(),a.onSignCancel()):m["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onSign=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({signModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onSignCancel=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({signModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettle=b()(w.a.mark(function e(){var t,n;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=a.state.selectedRows,n=Object(R["a"])(t),a.setState({accountStatistic:n,settleModalVisible:!0});case 3:case"end":return e.stop()}},e)})),a.onSettleCancel=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({settleModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettleOk=b()(w.a.mark(function e(){var t,n,r,o;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"unsettle/settleOrderAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(m["a"].success("\u6838\u5bf9\u6210\u529f\uff01"),a.onSettleCancel(),a.handleSearch()):m["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onCancelSign=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelSignModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onCancelSignCancel=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelSignModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelSignOk=b()(w.a.mark(function e(){var t,n,r,o;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"unsettle/cancelSignAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(m["a"].success("\u53d6\u6d88\u7b7e\u5b57\u6210\u529f\uff01"),a.handleSearch(),a.onCancelSignCancel()):m["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onPrint=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=b()(w.a.mark(function e(){var t,n,r;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"unsettle/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(m["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):m["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=b()(w.a.mark(function e(){var t,n,r;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"unsettle/downloadAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(m["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):m["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(){var e=b()(w.a.mark(function e(t,n,r){var o,l;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return o=a.props.dispatch,e.next=3,o({type:"customer/getCustomerAction",payload:{getcustomer_id:t.getcustomer_id,sendcustomer_id:t.sendcustomer_id}});case 3:l=e.sent,a.setState({record:t,currentGetCustomer:l.getCustomer,currentSendCustomer:l.sendCustomer}),a.onUpdateOrderModalShow();case 6:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onRowClick=function(e,t,a){},a.onRefTable=function(e){a.standardTable=e},a.tableFooter=function(){var e=a.props.unsettle,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=e.totalInsurancefee,l=e.totalAdvancepayAmount,i=e.totalDeliverAmount;return T.a.createElement("div",{className:Y.a.tableFooter},T.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),T.a.createElement("span",{className:Y.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),T.a.createElement("span",{className:Y.a.footerSplit},"\u57ab\u4ed8\u603b\u989d\uff1a",l||"0"),T.a.createElement("span",{className:Y.a.footerSplit},"\u9001\u8d27\u8d39\u603b\u989d\uff1a",i||"0"),T.a.createElement("span",{className:Y.a.footerSplit},"\u4fdd\u4ef7\u8d39\u603b\u989d\uff1a",o||"0"),T.a.createElement("span",{className:Y.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return O()(t,e),_()(t,[{key:"componentDidMount",value:function(){var e=b()(w.a.mark(function e(){var t,a,n,r,o;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getBranchCompanyList",payload:f()({},j["a"])});case 3:return a=e.sent,e.next=6,t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}});case 6:n=e.sent,t({type:"customer/sendCustomerListAction",payload:{pageNo:1,pageSize:100}}),r=this.setCurrentCompany(a),t({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:r.company_id}}}),n&&n.length>0&&(o=n.filter(function(e){return 3==e.site_type||2==e.site_type}),o.length>0&&this.setState({currentShipSite:o[0]})),t({type:"common/initOrderListAction"});case 12:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.customer,n=a.getCustomerList,r=a.sendCustomerList,o=e.company.branchCompanyList,l=e.site.entrunkSiteList,i=this.state,c=(i.currentShipSite,i.currentCompany),u=void 0===c?{}:c,m={},h={};1!=j["a"].company_type&&(h.initialValue=u.company_id||"");var f=1==j["a"].company_type;return T.a.createElement(V["a"],{onSubmit:this.handleSearch,layout:"inline"},T.a.createElement(B,p()({label:"\u5206\u516c\u53f8"},m),t("company_id",h)(T.a.createElement(D["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"},allowClear:f},o.map(function(e){return T.a.createElement(q,{key:e.company_id,value:e.company_id},e.company_name)})))),T.a.createElement(B,p()({label:"\u8fd0\u5355\u53f7"},m),t("order_code",{})(T.a.createElement(d["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),T.a.createElement(B,p()({label:"\u8d27\u8f66\u7f16\u53f7"},m),t("shipsite_id",{})(T.a.createElement(D["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onShipSiteSelect,style:{width:"100px"},allowClear:!0},(l||[]).map(function(e){return T.a.createElement(q,{key:e.site_id,value:e.site_id},e.site_name)}))),t("car_code",{})(T.a.createElement(d["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"80px"}}))),T.a.createElement(B,p()({label:"\u6536\u8d27\u4eba\u59d3\u540d"},m),t("getcustomer_id")(T.a.createElement(D["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onGetCustomerSelect,style:{width:"100px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onGetCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map(function(e){return T.a.createElement(q,{key:e.customer_id,value:e.customer_id},e.customer_name)})))),T.a.createElement(B,p()({label:"\u6536\u8d27\u4eba\u7535\u8bdd"},m),t("getcustomer_mobile",{})(T.a.createElement(d["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),T.a.createElement(B,p()({label:"\u53d1\u8d27\u4eba\u59d3\u540d"},m),t("sendcustomer_id")(T.a.createElement(D["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSendCustomerSelect,style:{width:"100px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onSendCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},r.map(function(e){return T.a.createElement(q,{key:e.get,value:e.customer_id},e.customer_name)})))),T.a.createElement(B,p()({label:"\u6536\u8d27\u4eba\u7535\u8bdd"},m),t("sendcustomer_mobile",{})(T.a.createElement(d["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),T.a.createElement(V["a"].Item,m,T.a.createElement(s["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.unsettle,n=a.orderList,r=a.total,o=t.loading,l=t.dispatch,d=this.state,u=d.selectedRows,p=d.accountStatistic,m=d.current,h=d.pageSize,f=d.updateOrderModalVisible,y=d.settleModalVisible,w=d.signModalVisible,g=d.cancelSignModalVisible,b=d.downloadModalVisible,v=d.printModalVisible,x=d.record,S=d.currentGetCustomer,_=void 0===S?{}:S,C=d.currentSendCustomer,E=void 0===C?{}:C,k=d.currentCompany,L=!0;return["site_admin","site_orderuser","site_pay","site_receipt","site_searchuser"].indexOf(j["b"].role_value)>=0&&(L=!1),T.a.createElement("div",null,T.a.createElement(c["a"],{bordered:!1},T.a.createElement("div",{className:Y.a.tableList},T.a.createElement("div",{className:Y.a.tableListForm},this.renderForm()),T.a.createElement("div",{className:Y.a.tableListOperator},u.length>0&&L&&T.a.createElement("span",null,T.a.createElement(s["a"],{onClick:this.onSettle},"\u8d26\u76ee\u6838\u5bf9"),T.a.createElement(s["a"],{onClick:this.onSign},"\u7b7e\u5b57"),T.a.createElement(s["a"],{onClick:this.onCancelSign},"\u53d6\u6d88\u7b7e\u5b57"),T.a.createElement(s["a"],{onClick:this.onPrint},"\u7ed3\u8d26\u6253\u5370"),T.a.createElement(s["a"],{onClick:this.onDownload},"\u4e0b\u8f7d"))),T.a.createElement(z["a"],{onRef:this.onRefTable,selectedRows:u,loading:o,className:Y.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:h,current:m,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,rowClassNameHandler:function(e,t){return 1==e.sign_status?Y.a.signColor:""}})),this.tableFooter()),T.a.createElement(H["a"],{modalVisible:f,record:x,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch,isEdit:["site_admin","site_pay","site_receipt"].indexOf(j["b"].role_value)>=0?1:0,dispatch:l,currentCompany:k,currentGetCustomer:_,currentSendCustomer:E}),T.a.createElement(i["a"],{title:"\u786e\u8ba4\u7ed3\u8d26",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:y,onOk:this.onSettleOk,onCancel:this.onSettleCancel},T.a.createElement("p",null,"\u7ed3\u7b97\u8d27\u6b3e\u6761\u6570".concat(u.length,"\uff0c\u7ed3\u7b97\u603b\u989d ").concat(p.totalAccount," ")),T.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u4e48\uff1f")),T.a.createElement(i["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:w,onOk:this.onSignOk,onCancel:this.onSignCancel},T.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7b7e\u5b57\u4e48\uff1f")),T.a.createElement(i["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:g,onOk:this.onCancelSignOk,onCancel:this.onCancelSignCancel},T.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u7b7e\u5b57\u4e48\uff1f")),T.a.createElement(i["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:v,onOk:this.onPrintOk,onCancel:this.onPrintCancel},T.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),T.a.createElement(i["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:b,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},T.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(I["PureComponent"]),o=l))||o)||o);t["default"]=K},R1Dz:function(e,t,a){"use strict";var n=a("q1tI");t["a"]=Object(n["createContext"])()},SLv7:function(e,t,a){e.exports={"antd-pro-components-global-header-index-header":"antd-pro-pages-account-account-antd-pro-components-global-header-index-header",tableList:"antd-pro-pages-account-account-tableList",tableListOperator:"antd-pro-pages-account-account-tableListOperator",tableFooter:"antd-pro-pages-account-account-tableFooter",footerSplit:"antd-pro-pages-account-account-footerSplit",signColor:"antd-pro-pages-account-account-signColor",settleColor:"antd-pro-pages-account-account-settleColor",payColor:"antd-pro-pages-account-account-payColor",selectedColor:"antd-pro-pages-account-account-selectedColor",tableDetail:"antd-pro-pages-account-account-tableDetail",modalForm:"antd-pro-pages-account-account-modalForm",formItemFloat:"antd-pro-pages-account-account-formItemFloat",tableListForm:"antd-pro-pages-account-account-tableListForm",submitButtons:"antd-pro-pages-account-account-submitButtons",dataTable:"antd-pro-pages-account-account-dataTable","ant-form-item":"antd-pro-pages-account-account-ant-form-item","ant-select":"antd-pro-pages-account-account-ant-select",formItemNoBreak:"antd-pro-pages-account-account-formItemNoBreak"}},VlJg:function(e,t,a){e.exports={"antd-pro-components-global-header-index-header":"antd-pro-pages-trans-confirm-trans-confirm-antd-pro-components-global-header-index-header",tableList:"antd-pro-pages-trans-confirm-trans-confirm-tableList",tableListOperator:"antd-pro-pages-trans-confirm-trans-confirm-tableListOperator",tableFooter:"antd-pro-pages-trans-confirm-trans-confirm-tableFooter",footerSplit:"antd-pro-pages-trans-confirm-trans-confirm-footerSplit",signColor:"antd-pro-pages-trans-confirm-trans-confirm-signColor",settleColor:"antd-pro-pages-trans-confirm-trans-confirm-settleColor",payColor:"antd-pro-pages-trans-confirm-trans-confirm-payColor",selectedColor:"antd-pro-pages-trans-confirm-trans-confirm-selectedColor",tableDetail:"antd-pro-pages-trans-confirm-trans-confirm-tableDetail",modalForm:"antd-pro-pages-trans-confirm-trans-confirm-modalForm",formItemFloat:"antd-pro-pages-trans-confirm-trans-confirm-formItemFloat",tableListForm:"antd-pro-pages-trans-confirm-trans-confirm-tableListForm",submitButtons:"antd-pro-pages-trans-confirm-trans-confirm-submitButtons",dataTable:"antd-pro-pages-trans-confirm-trans-confirm-dataTable","ant-form-item":"antd-pro-pages-trans-confirm-trans-confirm-ant-form-item","ant-select":"antd-pro-pages-trans-confirm-trans-confirm-ant-select",formItemNoBreak:"antd-pro-pages-trans-confirm-trans-confirm-formItemNoBreak"}},W660:function(e,t,a){e.exports={content:"antd-pro-layouts-basic-layout-content"}},ZeH8:function(e,t,a){e.exports={"antd-pro-components-global-header-index-header":"antd-pro-pages-pay-pay-antd-pro-components-global-header-index-header",tableList:"antd-pro-pages-pay-pay-tableList",tableListOperator:"antd-pro-pages-pay-pay-tableListOperator",tableFooter:"antd-pro-pages-pay-pay-tableFooter",footerSplit:"antd-pro-pages-pay-pay-footerSplit",signColor:"antd-pro-pages-pay-pay-signColor",settleColor:"antd-pro-pages-pay-pay-settleColor",payColor:"antd-pro-pages-pay-pay-payColor",selectedColor:"antd-pro-pages-pay-pay-selectedColor",tableDetail:"antd-pro-pages-pay-pay-tableDetail",modalForm:"antd-pro-pages-pay-pay-modalForm",formItemFloat:"antd-pro-pages-pay-pay-formItemFloat",tableListForm:"antd-pro-pages-pay-pay-tableListForm",submitButtons:"antd-pro-pages-pay-pay-submitButtons",dataTable:"antd-pro-pages-pay-pay-dataTable","ant-form-item":"antd-pro-pages-pay-pay-ant-form-item","ant-select":"antd-pro-pages-pay-pay-ant-select",formItemNoBreak:"antd-pro-pages-pay-pay-formItemNoBreak"}},a0Pg:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("miYZ"),a("tsqr")),p=a("d6i3"),m=a.n(p),h=a("1l/V"),f=a.n(h),y=(a("2qtc"),a("kLXV")),w=(a("5NDa"),a("5rEg")),g=(a("14J3"),a("BMrR")),b=(a("jCWc"),a("kPKH")),v=a("jehZ"),x=a.n(v),S=(a("+L6B"),a("2/Rp")),_=(a("O3gP"),a("lrIw")),C=a("p0pE"),E=a.n(C),k=a("2Taf"),L=a.n(k),M=a("vZ4D"),O=a.n(M),D=a("l4Ni"),V=a.n(D),I=a("ujKo"),T=a.n(I),F=a("MhPg"),N=a.n(F),A=(a("OaEy"),a("2fM7")),R=(a("y8nQ"),a("Vl3Y")),z=(a("iQDF"),a("+eQT")),H=a("q1tI"),P=a.n(H),Y=a("MuoO"),j=a("wd/R"),B=a.n(j),q=(a("B797"),a("CkN6")),K=a("82qg"),U=a("b5ys"),Z=a.n(U),G=(a("S+eF"),a("XS0u")),Q=z["a"].RangePicker,X=R["a"].Item,W=A["a"].Option,J=(n=R["a"].create(),n((o=function(e){function t(e){var a;return L()(this,t),a=V()(this,T()(t).call(this,e)),a.onAbnormalSelect=function(e,t){a.setState({abnormal_type_id:t.props.abnormal_type_id,abnormal_type:t.props.text})},a.onDownAccountHandler=function(){var e=a.props,t=e.onResolveAbnormal,n=e.form,r=e.abnormalTypes,o=void 0===r?[]:r;n.validateFields(function(e,a){var n;e||(o.forEach(function(e){e.abnormal_type_id==a.abnormal_type_id&&(n=e)}),n||(n={abnormal_type:a.abnormal_type,abnormal_type_id:0}),t(E()({abnormal_status:2,abnormal_reason:a.abnormal_reason,abnormal_amount:a.abnormal_amount,abnormal_resolve_type:a.abnormal_resolve_type,abnormal_remark:a.abnormal_remark},n)))})},a.renderCustomerOption=function(e){var t=_["a"].Option;return P.a.createElement(t,{key:e.abnormal_type_id,abnormal_type_id:e.abnormal_type_id,value:"".concat(e.abnormal_type_id),text:e.abnormal_type},e.abnormal_type)},a.state={abnormal_type_id:"",abnormal_type:""},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return N()(t,e),O()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onResolveAbnormalModalCancel,n=e.selectedRows,r=e.form,o=e.abnormalTypes;return console.log(n),P.a.createElement(y["a"],{destroyOnClose:!0,title:"\u5904\u7406\u5f02\u5e38",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[P.a.createElement(S["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),P.a.createElement(S["a"],{key:"btn-save",type:"primary",onClick:this.onDownAccountHandler},"\u4fdd \u5b58")],width:800,className:Z.a.modalForm},P.a.createElement(R["a"],null,P.a.createElement(g["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(b["a"],null,P.a.createElement(X,x()({},this.formItemLayout,{label:"\u5f02\u5e38\u7c7b\u578b"}),r.getFieldDecorator("abnormal_type_id",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u5f02\u5e38\u7c7b\u578b"}],initialValue:n.length>0?"".concat(n[0].abnormal_type_id):""})(P.a.createElement(_["a"],{size:"large",style:{width:"100%"},dataSource:o.map(this.renderCustomerOption),onSelect:this.onAbnormalSelect,placeholder:"\u8bf7\u8f93\u5165",optionLabelProp:"text",filterOption:function(e,t){return-1!==t.props.children.indexOf(e)}}))))),P.a.createElement(g["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(b["a"],null,P.a.createElement(X,{labelCol:{span:3,offset:2},label:"\u5f02\u5e38\u539f\u56e0"},r.getFieldDecorator("abnormal_reason",{initialValue:n.length>0?n[0].abnormal_reason:""})(P.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),P.a.createElement(g["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(b["a"],null,P.a.createElement(X,{labelCol:{span:3,offset:2},label:"\u4ea7\u751f\u91d1\u989d"},r.getFieldDecorator("abnormal_amount",{initialValue:""})(P.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),P.a.createElement(g["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(b["a"],null,P.a.createElement(X,{labelCol:{span:3,offset:2},label:"\u5904\u7406\u65b9\u5f0f"},r.getFieldDecorator("abnormal_resolve_type",{initialValue:""})(P.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),P.a.createElement(g["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(b["a"],null,P.a.createElement(X,{labelCol:{span:3,offset:2},label:"\u5907\u6ce8"},r.getFieldDecorator("abnormal_remark",{initialValue:""})(P.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}})))))))}}]),t}(H["PureComponent"]),r=o))||r),$=(l=Object(Y["connect"])(function(e){var t=e.customer,a=e.company,n=e.abnormal,r=e.site,o=e.car,l=e.receiver,i=e.loading;return{customer:t,company:a,abnormal:n,site:r,car:o,receiver:l,loading:i.models.rule}}),i=R["a"].create(),l(c=i((s=function(e){function t(){var e,a;L()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=V()(this,(e=T()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,settleModalVisible:!1,abnormalModalVisible:!1,signModalVisible:!1,cancelSignModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1},a.columns=[{title:"\u8d27\u5355\u53f7",dataIndex:"order_code",width:"80px",align:"right",render:function(e){return"".concat(e)},needTotal:!0},{title:"\u53d1\u8d27\u5ba2\u6237",dataIndex:"sendcustomer_name",width:"80px"},{title:"\u6536\u83b7\u5ba2\u6237",dataIndex:"getcustomer_name",sorter:!0,width:"80px"},{title:"\u5e94\u6536\u8d27\u6b3e",dataIndex:"order_amount",width:"80px"},{title:"\u5b9e\u6536\u8d27\u6b3e",dataIndex:"order_real",width:"80px"},{title:"\u6298\u540e\u8fd0\u8d39",dataIndex:"trans_discount",width:"80px"},{title:"\u8fd0\u8d39\u65b9\u5f0f",dataIndex:"trans_type",width:"80px",render:function(e){return 1==e?"\u73b0\u4ed8":2==e?"\u56de\u4ed8":"\u63d0\u4ed8"}},{title:"\u57ab\u4ed8",dataIndex:"order_advancepay_amount",width:"80px"},{title:"\u9001\u8d27\u8d39",dataIndex:"deliver_amount",width:"80px"},{title:"\u4fdd\u4ef7\u8d39",dataIndex:"insurance_fee",width:"80px"},{title:"\u8d27\u7269\u540d\u79f0",dataIndex:"order_name",width:"150px"},{title:"\u5f55\u7968\u65f6\u95f4",width:"170px",dataIndex:"create_date",render:function(e){return P.a.createElement("span",null,e&&B()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss"))}},{title:"\u7ad9\u70b9",dataIndex:"site_name",width:"80px"},{title:"\u4e2d\u8f6c",dataIndex:"transfer_type",width:"80px",render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t}},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.setCurrentCompany=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 2==G["a"].company_type?(a.setState({currentCompany:G["a"]}),G["a"]):e&&e.length>0?(a.setState({currentCompany:e[0]}),e[0]):{}},a.handleFormReset=function(){var e=a.props,t=e.form,n=e.dispatch;t.resetFields(),a.setState({formValues:{}}),n({type:"rule/fetch",payload:{}})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchGetCustomerList=function(){var e=f()(m.a.mark(function e(t){var n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=f()(m.a.mark(function e(t,n){var r,o;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.company.branchCompanyList,o=r.filter(function(e){if(e.company_id==t)return e}),o.length>0&&a.setState({currentCompany:o[0]});case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){n.abnormal_status=1,Object.keys(n).forEach(function(e){n[e]||delete n[e]}),n.entrunk_date&&n.entrunk_date.length;var o=Object.assign({filter:n},e);r({type:"abnormal/getOrderListAction",payload:E()({pageNo:t||i,pageSize:c},o)}),r({type:"abnormal/getOrderStatisticAction",payload:E()({},o)})}})},a.handleStandardTableChange=function(){var e=f()(m.a.mark(function e(t,n,r){var o,l,i,c;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onCancelAbnormal=function(){var e=f()(m.a.mark(function e(t){var n,r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.selectedRows,o=r.map(function(e){return e.order_id}),e.next=5,n({type:"abnormal/cancelAbnormalAction",payload:{order:{abnormal_status:0},orderIds:o}});case 5:return l=e.sent,0==l.code?(u["a"].success("\u53d6\u6d88\u5f02\u5e38\u6210\u529f\uff01"),a.handleSearch()):u["a"].error(l.msg),e.abrupt("return",Promise.resolve());case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCancelAbnormalModal=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:y["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u53d6\u6d88\u5f02\u5e38\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onCancelAbnormal});case 1:case"end":return e.stop()}},e)})),a.onResolveAbnormal=function(){var e=f()(m.a.mark(function e(t){var n,r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.selectedRows,o=r.map(function(e){return e.order_id}),e.next=5,n({type:"abnormal/resolveAbnormalAction",payload:Object.assign(t,{order_id:o})});case 5:return l=e.sent,0==l.code?(u["a"].success("\u5904\u7406\u5f02\u5e38\u6210\u529f\uff01"),a.onResolveAbnormalModalCancel(),a.handleSearch()):u["a"].error(l.msg),e.abrupt("return",Promise.resolve());case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onResolveAbnormalModal=function(){a.setState({abnormalModalVisible:!0})},a.onResolveAbnormalModalCancel=function(){a.setState({abnormalModalVisible:!1})},a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onUpdateOrderModalShow()},a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.abnormal,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=e.totalInsurancefee,l=e.totalAdvancepayAmount,i=e.totalDeliverAmount;return P.a.createElement("div",{className:Z.a.tableFooter},P.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u57ab\u4ed8\u603b\u989d\uff1a",l||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u9001\u8d27\u8d39\u603b\u989d\uff1a",i||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u4fdd\u4ef7\u8d39\u603b\u989d\uff1a",o||"0"),P.a.createElement("span",{className:Z.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return N()(t,e),O()(t,[{key:"componentDidMount",value:function(){var e=f()(m.a.mark(function e(){var t,a,n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"abnormal/initOrderListAction"});case 3:return e.next=5,t({type:"company/getBranchCompanyList",payload:E()({},G["a"])});case 5:return a=e.sent,t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}}),n=this.setCurrentCompany(a),e.next=10,t({type:"abnormal/getAbnormalTypeListAction",payload:{pageNo:1,pageSize:100,company_id:n.company_id}});case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=(a.entrunkSiteList,a.normalSiteList),r=e.company.branchCompanyList,o=e.abnormal.abnormalTypes,l={};r.length>0&&1!=G["a"].company_type&&(l.initialValue=r[0].company_id||"");var i=1==G["a"].company_type;return P.a.createElement(R["a"],{onSubmit:this.handleSearch,layout:"inline"},P.a.createElement(X,{label:"\u5206\u516c\u53f8"},t("company_id",l)(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"},allowClear:i},r.map(function(e){return P.a.createElement(W,{key:e.company_id,value:e.company_id},e.company_name)})))),P.a.createElement(X,{label:"\u8fd0\u5355\u53f7"},t("order_code",{})(P.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),P.a.createElement(X,{label:"\u7ad9\u70b9"},t("site_id",{initialValue:G["c"].site_id})(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"}},n.map(function(e){return P.a.createElement(W,{key:e.site_id,value:e.site_id},e.site_name)})))),P.a.createElement(X,{label:"\u5f02\u5e38\u7c7b\u578b"},t("abnormal_type_id")(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"}},o.map(function(e){return P.a.createElement(W,{key:e.abnormal_type_id,value:e.abnormal_type_id},e.abnormal_type)})))),P.a.createElement(X,{label:"\u6258\u8fd0\u65e5\u671f"},t("entrunk_date",{})(P.a.createElement(Q,{style:{width:"250px"}}))),P.a.createElement(X,null,P.a.createElement(S["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.abnormal,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.loading),l=t.abnormal.abnormalTypes,i=this.state,c=i.selectedRows,s=i.accountStatistic,u=i.current,p=i.pageSize,m=i.updateOrderModalVisible,h=i.settleModalVisible,f=i.abnormalModalVisible,w=i.signModalVisible,g=i.cancelSignModalVisible,b=i.downloadModalVisible,v=i.printModalVisible,x=i.record,_=!0;return["site_searchuser"].indexOf(G["b"].role_value)>=0&&(_=!1),P.a.createElement("div",null,P.a.createElement(d["a"],{bordered:!1},P.a.createElement("div",{className:Z.a.tableList},P.a.createElement("div",{className:Z.a.tableListForm},this.renderForm()),P.a.createElement("div",{className:Z.a.tableListOperator},c.length>0&&_&&P.a.createElement("span",null,P.a.createElement(S["a"],{onClick:this.onCancelAbnormalModal},"\u53d6\u6d88\u5f02\u5e38"),P.a.createElement(S["a"],{onClick:this.onResolveAbnormalModal},"\u5904\u7406\u5f02\u5e38"))),P.a.createElement(q["a"],{selectedRows:c,loading:o,className:Z.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:p,current:u,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,rowClassNameHandler:function(e,t){}})),this.tableFooter()),P.a.createElement(K["a"],{modalVisible:m,record:x,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch}),P.a.createElement(J,{modalVisible:f,onResolveAbnormal:this.onResolveAbnormal,onResolveAbnormalModalCancel:this.onResolveAbnormalModalCancel,selectedRows:c,abnormalTypes:l}),P.a.createElement(y["a"],{title:"\u53d6\u6d88\u7ed3\u8d26",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:h,onOk:this.onSettleOk,onCancel:this.onSettleCancel},P.a.createElement("p",null,"\u53d6\u6d88\u7ed3\u7b97\u8d27\u6b3e\u6761\u6570".concat(c.length,"\uff0c\u53d6\u6d88\u7ed3\u7b97\u603b\u989d ").concat(s.totalAccount," ")),P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u4e48\uff1f")),P.a.createElement(y["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:w,onOk:this.onSignOk,onCancel:this.onSignCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7b7e\u5b57\u4e48\uff1f")),P.a.createElement(y["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:g,onOk:this.onCancelSignOk,onCancel:this.onCancelSignCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u7b7e\u5b57\u4e48\uff1f")),P.a.createElement(y["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:v,onOk:this.onPrintOk,onCancel:this.onPrintCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),P.a.createElement(y["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:b,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(H["PureComponent"]),c=s))||c)||c);t["default"]=$},aGMH:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("5NDa"),a("5rEg")),p=(a("miYZ"),a("tsqr")),m=a("p0pE"),h=a.n(m),f=a("d6i3"),y=a.n(f),w=a("1l/V"),g=a.n(w),b=(a("2qtc"),a("kLXV")),v=(a("14J3"),a("BMrR")),x=(a("jCWc"),a("kPKH")),S=a("jehZ"),_=a.n(S),C=(a("+L6B"),a("2/Rp")),E=a("2Taf"),k=a.n(E),L=a("vZ4D"),M=a.n(L),O=a("l4Ni"),D=a.n(O),V=a("ujKo"),I=a.n(V),T=a("MhPg"),F=a.n(T),N=(a("iQDF"),a("+eQT")),A=(a("OaEy"),a("2fM7")),R=(a("y8nQ"),a("Vl3Y")),z=a("q1tI"),H=a.n(z),P=a("MuoO"),Y=a("wd/R"),j=a.n(Y),B=(a("B797"),a("CkN6")),q=a("82qg"),K=a("9yR7"),U=a.n(K),Z=a("XS0u"),G=R["a"].Item,Q=A["a"].Option,X=N["a"].RangePicker,W=(n=R["a"].create(),n((o=function(e){function t(e){var a;return k()(this,t),a=D()(this,I()(t).call(this,e)),a.onAddHandler=function(){var e=a.props,t=e.addFormDataHandle,n=e.form,r=e.receiverList,o=void 0===r?[]:r;n.validateFields(function(e,a){var n;e||(o.forEach(function(e){e.courier_id==a["courier_id"]&&(n=e)}),delete n["__typename"],t(n))})},a.state={},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return F()(t,e),M()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelHandler,n=e.receiverList,r=e.form;return H.a.createElement(b["a"],{destroyOnClose:!0,title:"\u66f4\u6539\u63a5\u8d27\u4eba",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[H.a.createElement(C["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),H.a.createElement(C["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:U.a.modalForm},H.a.createElement(R["a"],null,H.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(x["a"],null,H.a.createElement(G,_()({},this.formItemLayout,{label:"\u63a5\u8d27\u4eba"}),r.getFieldDecorator("courier_id",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u63a5\u8d27\u4eba"}]})(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"}},n.map(function(e){return H.a.createElement(Q,{key:e.courier_id,value:e.courier_id},e.courier_name)}))))))))}}]),t}(z["PureComponent"]),r=o))||r),J=(l=Object(P["connect"])(function(e){var t=e.customer,a=e.company,n=e.order,r=e.site,o=e.car,l=e.courier,i=e.loading;return{customer:t,company:a,order:n,site:r,car:o,courier:l,loading:i.models.rule}}),i=R["a"].create(),l(c=i((s=function(e){function t(){var e,a;k()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=D()(this,(e=I()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,downloadModalVisible:!1,addFormModalVisible:!1,currentSite:{}},a.columns=[{title:"\u63a5\u8d27\u4eba",width:"80px",dataIndex:"receiver_name",sorter:!0},{title:"\u8d27\u5355\u53f7",width:"80px",dataIndex:"order_code",sorter:!0},{title:"\u53d1\u8d27\u5ba2\u6237",width:"80px",dataIndex:"sendcustomer_name",sorter:!0},{title:"\u6536\u83b7\u5ba2\u6237",width:"80px",dataIndex:"getcustomer_name",sorter:!0},{title:"\u5e94\u6536\u8d27\u6b3e",width:"80px",dataIndex:"order_amount",sorter:!0},{title:"\u5b9e\u6536\u8d27\u6b3e",width:"80px",dataIndex:"order_real",sorter:!0},{title:"\u6298\u540e\u8fd0\u8d39",width:"80px",dataIndex:"trans_discount",sorter:!0},{title:"\u8fd0\u8d39\u65b9\u5f0f",width:"80px",dataIndex:"trans_type",sorter:!0,render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t}},{title:"\u57ab\u4ed8",width:"80px",dataIndex:"order_advancepay_amount"},{title:"\u9001\u8d27\u8d39",width:"80px",dataIndex:"deliver_amount"},{title:"\u4fdd\u4ef7\u8d39",width:"80px",dataIndex:"insurance_fee"},{title:"\u8d27\u7269\u540d\u79f0",width:"250px",dataIndex:"order_name"},{title:"\u5f55\u7968\u65f6\u95f4",width:"190px",dataIndex:"create_date",render:function(e){return H.a.createElement("span",null,e&&j()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u7ed3\u7b97\u65f6\u95f4",width:"190px",dataIndex:"settle_date",render:function(e){return H.a.createElement("span",null,e&&j()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u4ed8\u6b3e\u65e5\u671f",width:"80px",dataIndex:"pay_date"},{title:"\u8d27\u8f66\u7f16\u53f7",width:"80px",dataIndex:"car_code"},{title:"\u7ad9\u70b9",width:"80px",dataIndex:"site_name"},{title:"\u914d\u8f7d\u7ad9",width:"80px",dataIndex:"shipsite_name"},{title:"\u4e2d\u8f6c",width:"80px",dataIndex:"transfer_type",render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t}},{title:"\u5f02\u5e38\u60c5\u51b5",width:"80px",dataIndex:"abnormal_type"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onGetCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchGetCustomerList()},a.onSendCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchSendCustomerList()},a.fetchGetCustomerList=function(){var e=g()(y.a.mark(function e(t){var n,r,o,l;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props,r=n.dispatch,o=n.branchCompanyList,l=a.state.currentCompany,l&&l.company_id||(l=o&&o[0]),r({type:"customer/getCustomerListAction",payload:{filter:{company_id:t||l&&l.company_id||0}}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchReceiverList=function(){var e=g()(y.a.mark(function e(t){var n,r,o;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props,r=n.dispatch,n.site.siteList,o=a.state.currentSite,r({type:"courier/getCourierListAction",payload:{pageNo:1,pageSize:100,type:"receiver",filter:{site_id:o.site_id}}});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchSendCustomerList=function(){var e=g()(y.a.mark(function e(t){var n;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/sendCustomerListAction",payload:{filter:{}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onSiteSelect=g()(y.a.mark(function e(){var t,n,r,o,l=arguments;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=l.length>0&&void 0!==l[0]?l[0]:"",l.length>1?l[1]:void 0,n=a.props,n.dispatch,r=n.site.siteList,o=r.filter(function(e){if(e.site_id==t)return e}),o.length>0?a.setState({currentSite:o[0]}):a.setState({currentSite:{}}),a.fetchReceiverList();case 6:case"end":return e.stop()}},e)})),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){Object.keys(n).forEach(function(e){var t=n[e];t||delete n[e]});var o=Object.assign({filter:n},e);r({type:"courier/getOrderListAction",payload:h()({pageNo:t||i,pageSize:c},o)}),r({type:"courier/getOrderStatisticAction",payload:h()({},o)})}})},a.handleStandardTableChange=function(){var e=g()(y.a.mark(function e(t,n,r){var o,l,i,c;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onPrint=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=g()(y.a.mark(function e(){var t,n,r;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"unsettle/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(p["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):p["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=g()(y.a.mark(function e(){var t,n,r;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"unsettle/downloadAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(p["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):p["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onUpdateReceiverModal=function(){a.setState({addFormModalVisible:!0})},a.addFormDataHandle=function(){var e=g()(y.a.mark(function e(t){var n,r,o,l,i,c;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.selectedRows,o=void 0===r?[]:r,l=[],i=[],o.forEach(function(e){l.push(e.order_id),i.push(e.getcustomer_id)}),e.next=7,n({type:"courier/updateCustomerCourierAction",payload:{type:"receiver",order_id:l,customer_id:i,courier:t}});case 7:c=e.sent,c&&0==c.code?(p["a"].success("\u66f4\u65b0\u6210\u529f\uff01"),a.handleSearch(),a.onCancelAddFormClick()):p["a"].error(c&&c.msg||"\u66f4\u65b0\u5931\u8d25");case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCancelAddFormClick=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addFormModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDelReceiver=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:b["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u8981\u53d6\u6d88\u52fe\u9009\u8ba2\u5355\u3001\u53d1\u8d27\u5ba2\u6237\u5173\u8054\u7684\u63a5\u8d27\u4eba\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onDelReceiverConfirm});case 1:case"end":return e.stop()}},e)})),a.onDelReceiverConfirm=g()(y.a.mark(function e(){var t,n,r,o,l,i;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=void 0===n?[]:n,o=[],l=[],r.forEach(function(e){o.push(e.order_id),l.push(e.getcustomer_id)}),e.next=7,t({type:"courier/updateCustomerCourierAction",payload:{type:"receiver",order_id:o,customer_id:l,courier:{}}});case 7:i=e.sent,i&&0==i.code?(p["a"].success("\u53d6\u6d88\u6210\u529f\uff01"),a.handleSearch()):p["a"].error(i&&i.msg||"\u53d6\u6d88\u5931\u8d25");case 9:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onUpdateOrderModalShow()},a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.courier,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=(e.totalInsurancefee,e.totalRealTransAmount,e.totalRealOrderAmount),l=e.totalAdvancepayAmount,i=e.totalDeliverAmount,c=e.totalTifuTransAmount,s=e.totalXianTransAmount,d=e.totalLatefee,u=e.totalBonusfee,p=e.totalCarFeeConfirm,m=e.totalCarFee,h=e.totalTifuInsurance,f=e.totalXianInsurence;return H.a.createElement("div",{className:U.a.tableFooter},H.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),H.a.createElement("span",{className:U.a.footerSplit},"\u5b9e\u6536\u8d27\u6b3e\uff1a",o||"0"),H.a.createElement("span",{className:U.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),H.a.createElement("span",{className:U.a.footerSplit},"\u63d0\u4ed8\u8fd0\u8d39\uff1a",c||"0"),H.a.createElement("span",{className:U.a.footerSplit},"\u897f\u5b89\u8fd0\u8d39\uff1a",s||"0"),H.a.createElement("span",{className:U.a.footerSplit},"\u57ab\u4ed8\u8fd0\u8d39\uff1a",l||"0"),H.a.createElement("span",{className:U.a.footerSplit},"\u9001\u8d27\u8d39\uff1a",i||"0"),H.a.createElement("span",{className:U.a.footerSplit},"\u897f\u5b89\u4fdd\u8d39\uff1a",f||"0"),H.a.createElement("span",{className:U.a.footerSplit},"\u63d0\u4ed8\u4fdd\u8d39\uff1a",h||"0"),H.a.createElement("span",{className:U.a.footerSplit},"\u6ede\u7eb3\u91d1\uff1a",d||"0"),H.a.createElement("span",{className:U.a.footerSplit},"\u5956\u91d1\uff1a",u||"0"),H.a.createElement("span",{className:U.a.footerSplit},"\u672a\u7ed3\u7b97\u8d27\u8f66\u8fd0\u8d39\uff1a",m||"0"),H.a.createElement("span",{className:U.a.footerSplit},"\u5df2\u7ed3\u7b97\u8d27\u8f66\u8fd0\u8d39\uff1a",p||"0"),H.a.createElement("span",{className:U.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return F()(t,e),M()(t,[{key:"componentDidMount",value:function(){var e=g()(y.a.mark(function e(){var t,a;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,t({type:"courier/initOrderListAction"}),e.next=4,t({type:"company/getBranchCompanyList",payload:h()({},Z["a"])});case 4:a=t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}}),a&&a.length>0&&this.setState({currentSite:a[0]}),this.fetchSendCustomerList(),this.fetchReceiverList();case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.company.branchCompanyList,n=e.customer,r=(n.getCustomerList,n.sendCustomerList),o=e.site,l=o.siteList,i=o.entrunkSiteList,c=e.courier.receiverList,s={},d={};l.length>0&&(d.initialValue=l[0].company_id||"");var p={};return a.length>0&&(p.initialValue=a[0].company_id||""),H.a.createElement(R["a"],{onSubmit:this.handleSearch,layout:"inline"},H.a.createElement(G,{label:"\u5206\u516c\u53f8"},t("company_id",p)(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"},allowClear:!0},a.map(function(e){return H.a.createElement(Q,{key:e.company_id,value:e.company_id},e.company_name)})))),H.a.createElement(G,_()({label:"\u7ad9\u70b9"},s),t("site_id",d)(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSiteSelect,onChange:this.onSiteSelect,style:{width:"100px"},allowClear:!0},l.map(function(e){return H.a.createElement(Q,{key:e.site_id,value:e.site_id},e.site_name)})))),H.a.createElement(G,{label:"\u8fd0\u5355\u65e5\u671f"},t("create_date",{})(H.a.createElement(X,{style:{width:"150px"}}))),H.a.createElement(G,_()({label:"\u8fd0\u5355\u53f7"},s),t("order_code",{})(H.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),H.a.createElement(G,_()({label:"\u8d27\u8f66\u7f16\u53f7"},s),t("shipsite_id",{})(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onShipSiteSelect,style:{width:"100px"},allowClear:!0},(i||[]).map(function(e){return H.a.createElement(Q,{key:e.site_id,value:e.site_id},e.site_name)}))),t("car_code",{})(H.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"80px"}}))),H.a.createElement(G,_()({label:"\u63a5\u8d27\u4eba"},s),t("receiver_id",{})(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"}},c.map(function(e){return H.a.createElement(Q,{key:e.courier_id,value:e.courier_id},e.courier_name)})))),H.a.createElement(G,_()({label:"\u6536\u8d27\u4eba\u59d3\u540d"},s),t("sendcustomer_id")(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSendCustomerSelect,style:{width:"100px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onSendCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},r.map(function(e){return H.a.createElement(Q,{key:e.customer_id,value:e.customer_id},e.customer_name)})))),H.a.createElement(R["a"].Item,s,H.a.createElement(C["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.courier,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.courier.receiverList),l=t.loading,i=t.dispatch,c=this.state,s=c.selectedRows,u=c.current,p=c.pageSize,m=c.updateOrderModalVisible,h=c.downloadModalVisible,f=c.addFormModalVisible,y=c.record,w=!0;return["site_searchuser"].indexOf(Z["b"].role_value)>=0&&(w=!1),H.a.createElement("div",null,H.a.createElement(d["a"],{bordered:!1},H.a.createElement("div",{className:U.a.tableList},H.a.createElement("div",{className:U.a.tableListForm},this.renderForm()),H.a.createElement("div",{className:U.a.tableListOperator},s.length>0&&w&&H.a.createElement("span",null,H.a.createElement(C["a"],{onClick:this.onUpdateReceiverModal},"\u66f4\u6539\u63a5\u8d27\u4eba"),H.a.createElement(C["a"],{onClick:this.onDelReceiver},"\u53d6\u6d88\u63a5\u8d27\u4eba"),H.a.createElement(C["a"],{onClick:this.onDownload},"\u4e0b\u8f7d"))),H.a.createElement(B["a"],{selectedRows:s,loading:l,className:U.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:p,current:u,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},rowClassNameHandler:function(e,t){return 6===e.order_status?U.a.settleColor:7===e.order_status?U.a.payColor:""},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick})),this.tableFooter()),H.a.createElement(q["a"],{modalVisible:m,record:y,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch,isEdit:1,dispatch:i}),H.a.createElement(W,{modalVisible:f,addFormDataHandle:this.addFormDataHandle,onCancelHandler:this.onCancelAddFormClick,receiverList:o,selectedRows:s}),H.a.createElement(b["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:h,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(z["PureComponent"]),c=s))||c)||c);t["default"]=J},b5ys:function(e,t,a){e.exports={"antd-pro-components-global-header-index-header":"antd-pro-pages-abnormal-abnormal-antd-pro-components-global-header-index-header",tableList:"antd-pro-pages-abnormal-abnormal-tableList",tableListOperator:"antd-pro-pages-abnormal-abnormal-tableListOperator",tableFooter:"antd-pro-pages-abnormal-abnormal-tableFooter",footerSplit:"antd-pro-pages-abnormal-abnormal-footerSplit",signColor:"antd-pro-pages-abnormal-abnormal-signColor",settleColor:"antd-pro-pages-abnormal-abnormal-settleColor",payColor:"antd-pro-pages-abnormal-abnormal-payColor",selectedColor:"antd-pro-pages-abnormal-abnormal-selectedColor",tableDetail:"antd-pro-pages-abnormal-abnormal-tableDetail",modalForm:"antd-pro-pages-abnormal-abnormal-modalForm",formItemFloat:"antd-pro-pages-abnormal-abnormal-formItemFloat",tableListForm:"antd-pro-pages-abnormal-abnormal-tableListForm",submitButtons:"antd-pro-pages-abnormal-abnormal-submitButtons",dataTable:"antd-pro-pages-abnormal-abnormal-dataTable","ant-form-item":"antd-pro-pages-abnormal-abnormal-ant-form-item","ant-select":"antd-pro-pages-abnormal-abnormal-ant-select",formItemNoBreak:"antd-pro-pages-abnormal-abnormal-formItemNoBreak"}},btmg:function(e,t,a){e.exports={popover:"antd-pro-components-notice-icon-index-popover",noticeButton:"antd-pro-components-notice-icon-index-noticeButton",icon:"antd-pro-components-notice-icon-index-icon",tabs:"antd-pro-components-notice-icon-index-tabs"}},cZlJ:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("miYZ"),a("tsqr")),p=a("p0pE"),m=a.n(p),h=a("d6i3"),f=a.n(h),y=a("1l/V"),w=a.n(y),g=(a("2qtc"),a("kLXV")),b=(a("5NDa"),a("5rEg")),v=(a("14J3"),a("BMrR")),x=(a("jCWc"),a("kPKH")),S=(a("+L6B"),a("2/Rp")),_=a("2Taf"),C=a.n(_),E=a("vZ4D"),k=a.n(E),L=a("l4Ni"),M=a.n(L),O=a("ujKo"),D=a.n(O),V=a("MhPg"),I=a.n(V),T=(a("OaEy"),a("2fM7")),F=(a("y8nQ"),a("Vl3Y")),N=a("q1tI"),A=a.n(N),R=a("MuoO"),z=a("wd/R"),H=a.n(z),P=a("B797"),Y=a("CkN6"),j=a("82qg"),B=a("ZeH8"),q=a.n(B),K=(a("S+eF"),a("XS0u")),U=F["a"].Item,Z=T["a"].Option,G=(n=F["a"].create(),n((o=function(e){function t(e){var a;return C()(this,t),a=M()(this,D()(t).call(this,e)),a.onAgencyFeeSelect=function(e,t){a.setState({agencyFee:parseFloat(e)})},a.onDownAccountHandler=function(){var e=a.props,t=e.downAccountHandle,n=e.form,r=a.state.agencyFee;n.validateFields(function(e,a){console.log(a),e||t({rate:r,bank_account:a.bank_account})})},a.state={agencyFee:4},a}return I()(t,e),k()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.downCancel,n=e.selectedRows,r=e.form,o=Object(P["b"])(n),l=n.length>0?n[0]:{},i=this.state.agencyFee;return A.a.createElement(g["a"],{destroyOnClose:!0,title:"\u4e0b\u8d26",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[A.a.createElement(S["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),A.a.createElement(S["a"],{key:"btn-save",type:"primary",onClick:this.onDownAccountHandler},"\u4fdd \u5b58")],width:800,className:q.a.modalForm},A.a.createElement(F["a"],null,A.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},A.a.createElement(x["a"],null,A.a.createElement(U,{labelCol:{span:3,offset:2},label:"\u4e0b\u8d26\u6761\u6570"},n.length))),A.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},A.a.createElement(x["a"],null,A.a.createElement(U,{labelCol:{span:3,offset:2},label:"\u4e0b\u8d26\u603b\u91d1\u989d"},o.totalActualGoodsFund||"0"," - \u4ee3\u529e\u8d39 *",A.a.createElement(T["a"],{placeholder:"\u8bf7\u9009\u62e9",defaultValue:"4",onSelect:this.onAgencyFeeSelect,style:{width:"80px"}},A.a.createElement(Z,{value:"0"},"0\u2030"),A.a.createElement(Z,{value:"1"},"1\u2030"),A.a.createElement(Z,{value:"2"},"2\u2030"),A.a.createElement(Z,{value:"3"},"3\u2030"),A.a.createElement(Z,{value:"4"},"4\u2030"),A.a.createElement(Z,{value:"5"},"5\u2030")),o.totalTransFunds?A.a.createElement("span",null," `- (\u8fd0\u8d39) $",o.totalTransFunds,"`"):A.a.createElement("span",null),"="," ",o.totalActualGoodsFund-Math.ceil(o.totalActualGoodsFund*i/1e3)-o.totalTransFunds||0))),A.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},A.a.createElement(x["a"],null,A.a.createElement(U,{labelCol:{span:3,offset:2},label:"\u6237\u4e3b"},l.sendcustomer_name||"")),A.a.createElement(x["a"],null,A.a.createElement(U,{labelCol:{span:3,offset:2},label:"\u8d26\u6237"},r.getFieldDecorator("bank_account",{initialValue:l.bank_account})(A.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),A.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},A.a.createElement(x["a"],null,A.a.createElement(U,{labelCol:{span:3,offset:2},className:q.a.tableDetail,label:"\u660e\u7ec6"},A.a.createElement("table",null,A.a.createElement("thead",null,A.a.createElement("tr",null,A.a.createElement("th",null,"\u8fd0\u5355\u53f7"),A.a.createElement("th",null,"\u5b9e\u6536\u8d27\u6b3e"),A.a.createElement("th",null,"\u5e94\u6536\u8d27\u6b3e"))),A.a.createElement("tbody",null,n.map(function(e){return A.a.createElement("tr",null,A.a.createElement("td",null,e.order_code),A.a.createElement("td",null,e.order_real),A.a.createElement("td",null,e.order_amount))}))))))))}}]),t}(N["PureComponent"]),r=o))||r),Q=(l=Object(R["connect"])(function(e){var t=e.customer,a=e.company,n=e.pay,r=e.site,o=e.car,l=e.receiver,i=e.loading;return{customer:t,company:a,pay:n,site:r,car:o,receiver:l,loading:i.models.rule}}),i=F["a"].create(),l(c=i((s=function(e){function t(){var e,a;C()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=M()(this,(e=D()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,settleModalVisible:!1,downModalVisible:!1,signModalVisible:!1,cancelDownAccountModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1,currentCompany:{}},a.columns=[{title:"\u8d27\u5355\u53f7",dataIndex:"order_code",sorter:!0,align:"right",render:function(e){return"".concat(e)},needTotal:!0,width:"80px"},{title:"\u53d1\u8d27\u5ba2\u6237",dataIndex:"sendcustomer_name",width:"80px",sorter:!0},{title:"\u94f6\u884c\u8d26\u53f7",dataIndex:"bank_account",width:"150px",sorter:!0},{title:"\u6536\u83b7\u5ba2\u6237",dataIndex:"getcustomer_name",sorter:!0,width:"80px"},{title:"\u5e94\u6536\u8d27\u6b3e",dataIndex:"order_amount",width:"80px"},{title:"\u5b9e\u6536\u8d27\u6b3e",dataIndex:"order_real",sorter:!0,width:"80px"},{title:"\u5b9e\u6536\u8fd0\u8d39",dataIndex:"trans_discount",sorter:!0,width:"80px"},{title:"\u8fd0\u8d39\u65b9\u5f0f",dataIndex:"trans_type",sorter:!0,render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t},width:"80px"},{title:"\u57ab\u4ed8",dataIndex:"order_advancepay_amount",width:"80px"},{title:"\u9001\u8d27\u8d39",dataIndex:"deliver_amount",width:"80px"},{title:"\u4fdd\u4ef7\u8d39",dataIndex:"insurance_fee",width:"80px"},{title:"\u8d27\u7269\u540d\u79f0",dataIndex:"order_name",width:"150px"},{title:"\u5f55\u7968\u65f6\u95f4",dataIndex:"create_date",render:function(e){return A.a.createElement("span",null,e&&H()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"170px"},{title:"\u7ed3\u7b97\u65f6\u95f4",dataIndex:"settle_date",render:function(e){return A.a.createElement("span",null,e&&H()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"170px"},{title:"\u4ed8\u6b3e\u65f6\u95f4",dataIndex:"pay_date",render:function(e){return A.a.createElement("span",null,e&&H()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"170px"},{title:"\u7ad9\u70b9",dataIndex:"site_name",width:"80px"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onSendCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchSendCustomerList()},a.fetchSendCustomerList=function(){var e=w()(f.a.mark(function e(t){var n;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/sendCustomerListAction",payload:{filter:{}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=w()(f.a.mark(function e(t,a){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){n.pay_status=0,n.order_amount=-1;var o=Object.assign({filter:n},e);r({type:"pay/getOrderListAction",payload:m()({pageNo:t||i,pageSize:c},o)}),r({type:"pay/getOrderStatisticAction",payload:m()({},o)})}})},a.handleStandardTableChange=function(){var e=w()(f.a.mark(function e(t,n,r){var o,l,i,c;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.downAccountHandle=function(){var e=w()(f.a.mark(function e(t){var n,r,o,l;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.selectedRows,o=r.map(function(e){return e.order_id}),e.next=5,n({type:"pay/downAccountAction",payload:{order_id:o,rate:t.rate,bank_account:t.bank_account}});case 5:l=e.sent,0==l.code?(u["a"].success("\u4e0b\u8d26\u6210\u529f\uff01"),a.onDownCancel(),a.handleSearch()):u["a"].error(l.msg);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onDownAccount=w()(f.a.mark(function e(){var t,n;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.selectedRows,n=Object(P["b"])(t),n.isSameSendCustomer&&n.isSameBankAccount){e.next=5;break}return u["a"].error("\u8bf7\u9009\u62e9\u76f8\u540c\u5ba2\u6237/\u8d26\u53f7\u7684\u8ba2\u5355\u8fdb\u884c\u4e0b\u8d26"),e.abrupt("return");case 5:if(n.isSettled){e.next=8;break}return u["a"].error("\u53ea\u80fd\u9009\u62e9\u5df2\u7ecf\u7ed3\u7b97\u7684\u8ba2\u5355\u8fdb\u884c\u4e0b\u8d26"),e.abrupt("return");case 8:a.setState({downModalVisible:!0});case 9:case"end":return e.stop()}},e)})),a.onDownCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettle=w()(f.a.mark(function e(){var t,n;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=a.state.selectedRows,n=Object(P["a"])(t),a.setState({accountStatistic:n,settleModalVisible:!0});case 3:case"end":return e.stop()}},e)})),a.onSettleCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({settleModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettleOk=w()(f.a.mark(function e(){var t,n,r,o;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"settle/cancelSettleOrderAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(u["a"].success("\u53d6\u6d88\u7ed3\u7b97\u6210\u529f\uff01"),a.onSettleCancel(),a.handleSearch()):u["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onAddAbnormal=w()(f.a.mark(function e(){var t,n,r,o;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"pay/updatePayAbnormalAction",payload:{orderIds:r,order:{pay_status:1}}});case 5:o=e.sent,0==o.code?(u["a"].success("\u6dfb\u52a0\u5f02\u5e38\u6210\u529f\uff01"),a.handleSearch()):u["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onAddNormalModal=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:g["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u5c06\u6240\u9009\u8ba2\u5355\u6dfb\u52a0\u4e3a\u5f02\u5e38\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onAddAbnormal});case 1:case"end":return e.stop()}},e)})),a.onCancelSign=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelDownAccountModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onCancelDownAccountCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelDownAccountModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelDownAccountOk=w()(f.a.mark(function e(){var t,n,r,o,l;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.props.dispatch,n=a.state.selectedRows,r=!0,o=[],0,n.forEach(function(e){var t=H()((new Date).getTime()),a=t.subtract(H()(Number(e.pay_date)||0)).hours();a>=24&&(r=!1),o.push(e.order_id),Number(e.order_real||e.order_amount||0)}),r){e.next=9;break}return u["a"].error("\u4e0b\u8d26\u8d85\u8fc724\u5c0f\u65f6\u4e0d\u53ef\u4ee5\u53d6\u6d88"),e.abrupt("return");case 9:return e.next=11,t({type:"pay/cancelDownAccountAction",payload:{order_id:o}});case 11:l=e.sent,l&&0==l.code?(u["a"].success("\u53d6\u6d88\u4e0b\u8d26\u6210\u529f\uff01"),a.handleSearch(),a.onCancelDownAccountCancel()):u["a"].error(l.msg);case 13:case"end":return e.stop()}},e)})),a.onPrint=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=w()(f.a.mark(function e(){var t,n,r;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"pay/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(u["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):u["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=w()(f.a.mark(function e(){var t,n,r;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"pay/downloadAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(u["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):u["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onUpdateOrderModalShow()},a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.pay,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=e.totalInsurancefee,l=e.totalAdvancepayAmount,i=e.totalDeliverAmount;return A.a.createElement("div",{className:q.a.tableFooter},A.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),A.a.createElement("span",{className:q.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),A.a.createElement("span",{className:q.a.footerSplit},"\u57ab\u4ed8\u603b\u989d\uff1a",l||"0"),A.a.createElement("span",{className:q.a.footerSplit},"\u9001\u8d27\u8d39\u603b\u989d\uff1a",i||"0"),A.a.createElement("span",{className:q.a.footerSplit},"\u4fdd\u4ef7\u8d39\u603b\u989d\uff1a",o||"0"),A.a.createElement("span",{className:q.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return I()(t,e),k()(t,[{key:"componentDidMount",value:function(){var e=w()(f.a.mark(function e(){var t;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getBranchCompanyList",payload:m()({},K["a"])});case 3:t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}}),this.fetchSendCustomerList(),this.getOrderList();case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=(a.entrunkSiteList,a.normalSiteList),r=void 0===n?[]:n,o=e.customer,l=(o.getCustomerList,o.sendCustomerList),i=e.company.branchCompanyList,c={};return A.a.createElement(F["a"],{onSubmit:this.handleSearch,layout:"inline"},A.a.createElement(U,{label:"\u5206\u516c\u53f8"},t("company_id",c)(A.a.createElement(T["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"80px"},allowClear:!0},i.map(function(e){return A.a.createElement(Z,{key:e.company_id,value:e.company_id},e.company_name)})))),A.a.createElement(U,{label:"\u8fd0\u5355\u53f7"},t("order_code",{})(A.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"100px"}}))),A.a.createElement(U,{label:"\u7ad9\u70b9"},t("site_id",{})(A.a.createElement(T["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"80px"},allowClear:!0},r.map(function(e){return A.a.createElement(Z,{key:e.site_id,value:e.site_id},e.site_name)})))),A.a.createElement(U,{label:"\u53d1\u8d27\u4eba\u59d3\u540d"},t("sendcustomer_id")(A.a.createElement(T["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSendCustomerSelect,style:{width:"80px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onSendCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},l.map(function(e){return A.a.createElement(Z,{key:e.get,value:e.customer_id},e.customer_name)})))),A.a.createElement(U,{label:"\u53d1\u8d27\u4eba\u7535\u8bdd"},t("sendcustomer_mobile",{})(A.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),A.a.createElement(U,null,A.a.createElement(S["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.pay,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.loading),l=this.state,i=l.selectedRows,c=l.accountStatistic,s=l.current,u=l.pageSize,p=l.updateOrderModalVisible,m=l.settleModalVisible,h=l.downModalVisible,f=l.signModalVisible,y=l.cancelDownAccountModalVisible,w=l.downloadModalVisible,b=l.printModalVisible,v=l.record,x=!0;return["site_searchuser","site_admin"].indexOf(K["b"].role_value)>=0&&(x=!1),A.a.createElement("div",null,A.a.createElement(d["a"],{bordered:!1},A.a.createElement("div",{className:q.a.tableList},A.a.createElement("div",{className:q.a.tableListForm},this.renderForm()),A.a.createElement("div",{className:q.a.tableListOperator},i.length>0&&x&&A.a.createElement("span",null,A.a.createElement(S["a"],{onClick:this.onDownAccount},"\u4e0b\u8d26"),A.a.createElement(S["a"],{onClick:this.onAddNormalModal},"\u6dfb\u52a0\u5f02\u5e38"),A.a.createElement(S["a"],{onClick:this.onPrint},"\u6253\u5370"))),A.a.createElement(Y["a"],{selectedRows:i,loading:o,className:q.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:u,current:s,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,rowClassNameHandler:function(e,t){return 6===e.order_status?q.a.settleColor:7===e.order_status?q.a.payColor:""}})),this.tableFooter()),A.a.createElement(j["a"],{modalVisible:p,record:v,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch}),A.a.createElement(G,{modalVisible:h,downAccountHandle:this.downAccountHandle,downCancel:this.onDownCancel,selectedRows:i}),A.a.createElement(g["a"],{title:"\u53d6\u6d88\u7ed3\u7b97",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:m,onOk:this.onSettleOk,onCancel:this.onSettleCancel},A.a.createElement("p",null,"\u53d6\u6d88\u7ed3\u7b97\u8d27\u6b3e\u6761\u6570".concat(i.length,"\uff0c\u53d6\u6d88\u7ed3\u7b97\u603b\u989d ").concat(c.totalAccount," ")),A.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u7b97\u4e48\uff1f")),A.a.createElement(g["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:f,onOk:this.onSignOk,onCancel:this.onSignCancel},A.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7b7e\u5b57\u4e48\uff1f")),A.a.createElement(g["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:y,onOk:this.onCancelDownAccountOk,onCancel:this.onCancelDownAccountCancel},A.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u4e0b\u8d26\u4e48\uff1f")),A.a.createElement(g["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:b,onOk:this.onPrintOk,onCancel:this.onPrintCancel},A.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),A.a.createElement(g["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:w,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},A.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(N["PureComponent"]),c=s))||c)||c);t["default"]=Q},ckwQ:function(e,t,a){e.exports={"antd-pro-components-global-header-index-header":"antd-pro-components-editable-table-index-antd-pro-components-global-header-index-header",tableList:"antd-pro-components-editable-table-index-tableList",tableListOperator:"antd-pro-components-editable-table-index-tableListOperator",tableFooter:"antd-pro-components-editable-table-index-tableFooter",selectedColor:"antd-pro-components-editable-table-index-selectedColor",tableDetail:"antd-pro-components-editable-table-index-tableDetail",modalForm:"antd-pro-components-editable-table-index-modalForm",formItemFloat:"antd-pro-components-editable-table-index-formItemFloat",tableListForm:"antd-pro-components-editable-table-index-tableListForm","ant-select":"antd-pro-components-editable-table-index-ant-select",formItemNoBreak:"antd-pro-components-editable-table-index-formItemNoBreak",signColor:"antd-pro-components-editable-table-index-signColor",settleColor:"antd-pro-components-editable-table-index-settleColor",payColor:"antd-pro-components-editable-table-index-payColor",submitButtons:"antd-pro-components-editable-table-index-submitButtons",dataTable:"antd-pro-components-editable-table-index-dataTable",footerSplit:"antd-pro-components-editable-table-index-footerSplit","ant-form-item":"antd-pro-components-editable-table-index-ant-form-item"}},fmXB:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("miYZ"),a("tsqr")),p=a("d6i3"),m=a.n(p),h=a("1l/V"),f=a.n(h),y=(a("2qtc"),a("kLXV")),w=(a("14J3"),a("BMrR")),g=(a("jCWc"),a("kPKH")),b=a("jehZ"),v=a.n(b),x=(a("5NDa"),a("5rEg")),S=(a("+L6B"),a("2/Rp")),_=(a("O3gP"),a("lrIw")),C=a("2Taf"),E=a.n(C),k=a("vZ4D"),L=a.n(k),M=a("l4Ni"),O=a.n(M),D=a("ujKo"),V=a.n(D),I=a("MhPg"),T=a.n(I),F=(a("OaEy"),a("2fM7")),N=(a("y8nQ"),a("Vl3Y")),A=(a("iQDF"),a("+eQT")),R=a("q1tI"),z=a.n(R),H=a("MuoO"),P=(a("wd/R"),a("CkN6")),Y=a("o6JX"),j=a.n(Y),B=(a("XS0u"),A["a"].RangePicker,N["a"].Item),q=F["a"].Option,K=(n=N["a"].create(),n((o=function(e){function t(e){var a;return E()(this,t),a=O()(this,V()(t).call(this,e)),a.onAbnormalSelect=function(e,t){},a.onAddHandler=function(){var e=a.props,t=e.addFormDataHandle,n=e.form,r=e.record,o=void 0===r?{}:r;n.validateFields(function(e,a){if(!e){var n={user:a};o.user_id&&(n.ids=[o.user_id],a.user_id=o.user_id),t(n)}})},a.renderCustomerOption=function(e){var t=_["a"].Option;return z.a.createElement(t,{key:e.expensetype_id,expensetype_id:e.expensetype_id,text:e.expensetype},e.expensetype)},a.state={abnormal_type_id:"",abnormal_type:""},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return T()(t,e),L()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelHandler,n=e.record,r=e.form,o=e.roleList,l=e.currentCompany;return z.a.createElement(y["a"],{destroyOnClose:!0,title:"\u6dfb\u52a0\u7528\u6237",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[z.a.createElement(S["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),z.a.createElement(S["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:j.a.modalForm},z.a.createElement(N["a"],null,z.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(g["a"],null,z.a.createElement(B,v()({},this.formItemLayout,{label:"\u7528\u6237\u540d"}),r.getFieldDecorator("user_name",{initialValue:n.user_name,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7528\u6237\u540d"}]})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),z.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(g["a"],null,z.a.createElement(B,v()({},this.formItemLayout,{label:"\u7528\u6237\u5bc6\u7801"}),r.getFieldDecorator("user_pass",{initialValue:n.user_pass?"******":"",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7528\u6237\u5bc6\u7801"}]})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),z.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(g["a"],null,z.a.createElement(B,v()({},this.formItemLayout,{label:"\u7528\u6237\u89d2\u8272"}),r.getFieldDecorator("role_id",{initialValue:n.role&&n.role.role_id||"",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7528\u6237\u89d2\u8272"}]})(z.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"}},o.map(function(e){return e.company_type==l.company_type&&z.a.createElement(q,{key:e.role_id,value:e.role_id},e.role_name)})))))),z.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(g["a"],null,z.a.createElement(B,v()({},this.formItemLayout,{label:"\u7528\u6237\u7535\u8bdd"}),r.getFieldDecorator("user_mobile",{initialValue:n.user_mobile,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7528\u6237\u7535\u8bdd"}]})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}})))))))}}]),t}(R["PureComponent"]),r=o))||r),U=(l=Object(H["connect"])(function(e){var t=e.customer,a=e.user,n=e.site,r=e.company,o=e.loading;return{customer:t,user:a,site:n,company:r,loading:o.models.rule}}),i=N["a"].create(),l(c=i((s=function(e){function t(){var e,a;E()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=O()(this,(e=V()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],formValues:{},current:1,pageSize:20,record:{},currentCompany:{},currentSite:{},addModalVisible:!1},a.columns=[{title:"\u7528\u6237\u540d",dataIndex:"user_name",width:"80px"},{title:"\u7528\u6237\u7535\u8bdd",dataIndex:"user_mobile",width:"130px"},{title:"\u7ad9\u70b9",dataIndex:"site_name",width:"100px"},{title:"\u89d2\u8272",dataIndex:"role.role_name",width:"100px"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchCompanySiteList=function(){var e=f()(m.a.mark(function e(t){var n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchGetCustomerList=function(){var e=f()(m.a.mark(function e(t){var n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=f()(m.a.mark(function e(t,n){var r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,o=r.company.companyList,r.form,a.fetchCompanySiteList(t),l=o.filter(function(e){if(e.company_id==t)return e}),l.length>0&&a.setState({currentCompany:l[0]});case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onSiteSelect=function(){var e=f()(m.a.mark(function e(t,n){var r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.site.siteList,o=void 0===r?[]:r,l=o.filter(function(e){if(e.site_id==t)return e}),l.length>0&&a.setState({currentSite:l[0]});case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=a.props,n=t.dispatch,r=t.form,o=a.state,l=o.current,i=o.pageSize,c=o.currentCompany,s=void 0===c?{}:c,d=o.currentSite,u=void 0===d?{}:d;r.validateFields(function(t,a){if(!t){var r={company_id:s.company_id};1==s.company_type&&u.site_id&&(r.site_id=u.site_id),n({type:"user/getUserListAction",payload:{pageNo:e||l,pageSize:i,filter:r}})}})},a.handleStandardTableChange=function(){var e=f()(m.a.mark(function e(t,n,r){var o,l,i,c;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.addFormDataHandle=function(){var e=f()(m.a.mark(function e(t){var n,r,o,l,i,c,s,d,p;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=t.user,r=t.ids,o=a.props.dispatch,l=a.state,i=l.currentCompany,c=void 0===i?{}:i,s=l.currentSite,d=void 0===s?{}:s,n.company_id||(n.company_id=c.company_id),!n.site_id&&1==c.company_type&&d.site_id&&(n.site_id=d.site_id),e.next=7,o({type:"user/addUserAction",payload:{user:n,ids:r}});case 7:p=e.sent,p&&0==p.code?(u["a"].success("\u6dfb\u52a0\u6210\u529f\uff01"),a.handleSearch(),a.onCancelModalClick()):u["a"].error(p&&p.msg||"\u6dfb\u52a0\u5931\u8d25");case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onAddClick=f()(m.a.mark(function e(){var t,n,r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state,n=t.currentCompany,r=void 0===n?{}:n,o=t.currentSite,l=void 0===o?{}:o,r.company_id){e.next=4;break}return y["a"].info({content:"\u8bf7\u5148\u9009\u62e9\u516c\u53f8"}),e.abrupt("return");case 4:if(1!=r.company_type||l.site_id){e.next=7;break}return y["a"].info({content:"\u8bf7\u5148\u9009\u62e9\u7ad9\u70b9"}),e.abrupt("return");case 7:a.setState({addModalVisible:!0,record:{}});case 8:case"end":return e.stop()}},e)})),a.onCancelModalClick=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onModalShow=function(){a.setState({addModalVisible:!0})},a.onModalCancel=function(){a.setState({addModalVisible:!1})},a.onSiteChange=function(e){console.log("site",e),e||a.setState({currentSite:{}})},a.onCompanyChange=function(e){console.log("company",e),e||a.setState({currentCompany:{}})},a.onUpdateOrder=function(){var e=f()(m.a.mark(function e(t,n){var r,o;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.props.dispatch,console.log(t,n),e.next=4,r({type:"order/updateOrderAction",payload:{orderIds:[t.order_id],order:{trans_real:n.trans_real,order_real:n.order_real}}});case 4:o=e.sent,0==o.code?(u["a"].success("\u4fee\u6539\u6210\u529f\uff01"),a.onModalCancel()):u["a"].error(o.msg);case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onRowClick=function(e,t,a){},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onModalShow()},a}return T()(t,e),L()(t,[{key:"componentDidMount",value:function(){var e=f()(m.a.mark(function e(){var t,a;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getCompanyList",payload:{filter:{}}});case 3:return a=e.sent,e.next=6,t({type:"user/getRoleListAction",payload:{}});case 6:this.setState({currentCompany:a[0]});case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){var e=this,t=this.props,a=t.form.getFieldDecorator,n=t.company.companyList,r=t.user,o=r.userList,l=r.total,i=r.roleList,c=t.site,s=c.siteList,u=(c.siteTotal,t.loading),p=this.state,m=p.selectedRows,h=p.current,f=p.pageSize,y=p.addModalVisible,w=p.record,g=p.currentCompany,b={};return n.length>0&&(b.initialValue=n[0].company_id||""),z.a.createElement("div",null,z.a.createElement(d["a"],{bordered:!1},z.a.createElement("div",{className:j.a.tableList},z.a.createElement("div",{className:j.a.tableListOperator},z.a.createElement(N["a"],{onSubmit:this.handleSearch,layout:"inline"},z.a.createElement(B,{label:"\u516c\u53f8"},a("company_id",b)(z.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"150px"}},n.map(function(e){return z.a.createElement(q,{key:e.company_id,value:e.company_id},e.company_name)})))),1==g.company_type&&z.a.createElement(B,{label:"\u7ad9\u70b9"},z.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSiteSelect,style:{width:"150px"},allowClear:!0},s.map(function(e){return z.a.createElement(q,{key:e.site_id,value:e.site_id},e.site_name)}))),z.a.createElement(B,null,z.a.createElement(S["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")),z.a.createElement(B,null,z.a.createElement(S["a"],{icon:"plus",type:"primary",onClick:function(){return e.onAddClick(!0)}},"\u6dfb\u52a0")))),z.a.createElement(P["a"],{selectedRows:m,loading:u,className:j.a.dataTable,scroll:{x:900,y:350},rowKey:"user_id",data:{list:o,pagination:{total:l,pageSize:f,current:h,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,footer:function(){}}))),z.a.createElement(K,{modalVisible:y,addFormDataHandle:this.addFormDataHandle,onCancelHandler:this.onCancelModalClick,record:w,selectedRows:m,roleList:i,currentCompany:g}))}}]),t}(R["PureComponent"]),c=s))||c)||c);t["default"]=U},gA67:function(e,t,a){e.exports={"antd-pro-components-global-header-index-header":"antd-pro-pages-order-order-list-antd-pro-components-global-header-index-header",tableList:"antd-pro-pages-order-order-list-tableList",tableListOperator:"antd-pro-pages-order-order-list-tableListOperator",tableFooter:"antd-pro-pages-order-order-list-tableFooter",footerSplit:"antd-pro-pages-order-order-list-footerSplit",signColor:"antd-pro-pages-order-order-list-signColor",settleColor:"antd-pro-pages-order-order-list-settleColor",payColor:"antd-pro-pages-order-order-list-payColor",selectedColor:"antd-pro-pages-order-order-list-selectedColor",tableDetail:"antd-pro-pages-order-order-list-tableDetail",modalForm:"antd-pro-pages-order-order-list-modalForm",formItemFloat:"antd-pro-pages-order-order-list-formItemFloat",tableListForm:"antd-pro-pages-order-order-list-tableListForm",submitButtons:"antd-pro-pages-order-order-list-submitButtons",dataTable:"antd-pro-pages-order-order-list-dataTable","ant-form-item":"antd-pro-pages-order-order-list-ant-form-item","ant-select":"antd-pro-pages-order-order-list-ant-select",formItemNoBreak:"antd-pro-pages-order-order-list-formItemNoBreak"}},h3zL:function(e,t,a){e.exports={header:"antd-pro-components-global-header-index-header",logo:"antd-pro-components-global-header-index-logo",navbar:"antd-pro-components-global-header-index-navbar",menu:"antd-pro-components-global-header-index-menu",trigger:"antd-pro-components-global-header-index-trigger","ant-dropdown-trigger":"antd-pro-components-global-header-index-ant-dropdown-trigger",right:"antd-pro-components-global-header-index-right",action:"antd-pro-components-global-header-index-action",search:"antd-pro-components-global-header-index-search",account:"antd-pro-components-global-header-index-account",avatar:"antd-pro-components-global-header-index-avatar",dark:"antd-pro-components-global-header-index-dark",rightMenu:"antd-pro-components-global-header-index-rightMenu",name:"antd-pro-components-global-header-index-name"}},hOu5:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("iQDF"),a("+eQT")),p=(a("miYZ"),a("tsqr")),m=a("p0pE"),h=a.n(m),f=a("d6i3"),y=a.n(f),w=a("1l/V"),g=a.n(w),b=a("rlhR"),v=a.n(b),x=(a("2qtc"),a("kLXV")),S=(a("5NDa"),a("5rEg")),_=(a("14J3"),a("BMrR")),C=(a("jCWc"),a("kPKH")),E=(a("+L6B"),a("2/Rp")),k=a("2Taf"),L=a.n(k),M=a("vZ4D"),O=a.n(M),D=a("l4Ni"),V=a.n(D),I=a("ujKo"),T=a.n(I),F=a("MhPg"),N=a.n(F),A=(a("OaEy"),a("2fM7")),R=(a("y8nQ"),a("Vl3Y")),z=a("q1tI"),H=a.n(z),P=a("MuoO"),Y=a("wd/R"),j=a.n(Y),B=a("B797"),q=a("CkN6"),K=a("82qg"),U=a("ZeH8"),Z=a.n(U),G=(a("S+eF"),a("XS0u")),Q=R["a"].Item,X=A["a"].Option,W=(n=R["a"].create(),n((o=function(e){function t(e){var a;return L()(this,t),a=V()(this,T()(t).call(this,e)),a.onAgencyFeeSelect=function(e,t){a.setState({agencyFee:parseFloat(e)})},a.onDownAccountHandler=function(){var e=a.props,t=e.downAccountHandle,n=e.form,r=a.state.agencyFee;n.validateFields(function(e,a){console.log(a),e||t({rate:r,bank_account:a.bank_account})})},a.state={agencyFee:0},a}return N()(t,e),O()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.downCancel,n=e.selectedRows,r=e.form,o=Object(B["b"])(n),l=n.length>0?n[0]:{},i=this.state.agencyFee;return H.a.createElement(x["a"],{destroyOnClose:!0,title:"\u4e0b\u8d26",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[H.a.createElement(E["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),H.a.createElement(E["a"],{key:"btn-save",type:"primary",onClick:this.onDownAccountHandler},"\u4fdd \u5b58")],width:800,className:Z.a.modalForm},H.a.createElement(R["a"],null,H.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(C["a"],null,H.a.createElement(Q,{labelCol:{span:3,offset:2},label:"\u4e0b\u8d26\u6761\u6570"},n.length))),H.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(C["a"],null,H.a.createElement(Q,{labelCol:{span:3,offset:2},label:"\u4e0b\u8d26\u603b\u91d1\u989d"},o.totalActualGoodsFund||"0"," - \u4ee3\u529e\u8d39 *",H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",defaultValue:"0",onSelect:this.onAgencyFeeSelect,style:{width:"80px"}},H.a.createElement(X,{value:"0"},"0\u2030"),H.a.createElement(X,{value:"1"},"1\u2030"),H.a.createElement(X,{value:"2"},"2\u2030"),H.a.createElement(X,{value:"3"},"3\u2030"),H.a.createElement(X,{value:"4"},"4\u2030"),H.a.createElement(X,{value:"5"},"5\u2030")),o.totalTransFunds?H.a.createElement("span",null," `- (\u8fd0\u8d39) $",o.totalTransFunds,"`"):H.a.createElement("span",null),"="," ",o.totalActualGoodsFund-Math.ceil(o.totalActualGoodsFund*i/1e3)-o.totalTransFunds||0))),H.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(C["a"],null,H.a.createElement(Q,{labelCol:{span:3,offset:2},label:"\u6237\u4e3b"},l.getcustomer_name||"")),H.a.createElement(C["a"],null,H.a.createElement(Q,{labelCol:{span:3,offset:2},label:"\u8d26\u6237"},r.getFieldDecorator("bank_account",{initialValue:l.bank_account})(H.a.createElement(S["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),H.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(C["a"],null,H.a.createElement(Q,{labelCol:{span:3,offset:2},className:Z.a.tableDetail,label:"\u660e\u7ec6"},H.a.createElement("table",null,H.a.createElement("thead",null,H.a.createElement("tr",null,H.a.createElement("th",null,"\u8fd0\u5355\u53f7"),H.a.createElement("th",null,"\u5b9e\u6536\u8d27\u6b3e"),H.a.createElement("th",null,"\u5e94\u6536\u8d27\u6b3e"))),H.a.createElement("tbody",null,n.map(function(e){return H.a.createElement("tr",null,H.a.createElement("td",null,e.order_code),H.a.createElement("td",null,e.order_real),H.a.createElement("td",null,e.order_amount))}))))))))}}]),t}(z["PureComponent"]),r=o))||r),J=(l=Object(P["connect"])(function(e){var t=e.customer,a=e.company,n=e.pay,r=e.site,o=e.car,l=e.receiver,i=e.loading;return{customer:t,company:a,pay:n,site:r,car:o,receiver:l,loading:i.models.rule}}),i=R["a"].create(),l(c=i((s=function(e){function t(){var e,a;L()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=V()(this,(e=T()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,settleModalVisible:!1,downModalVisible:!1,signModalVisible:!1,cancelDownAccountModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1,currentCompany:{}},a.columns=[{title:"\u53d1\u8d27\u5ba2\u6237",dataIndex:"sendcustomer_name",width:"80px",sorter:!0},{title:"\u5408\u8ba1\u7968\u6570",dataIndex:"order_code",sorter:!0,width:"80px",render:function(e){return H.a.createElement("span",null,e&&e.split(",").length||"")}},{title:"\u5408\u8ba1\u8d27\u6b3e",dataIndex:"order_amount",sorter:!0,width:"80px"},{title:"\u5408\u8ba1\u4ed8\u6b3e",dataIndex:"pay_amount",sorter:!0,width:"80px"},{title:"\u4ee3\u529e\u8d39",dataIndex:"agency_fee",sorter:!0,width:"80px"},{title:"\u5408\u8ba1\u8fd0\u8d39",dataIndex:"trans_amount",sorter:!0,width:"80px"},{title:"\u94f6\u884c\u8d26\u53f7",dataIndex:"bank_account",width:"80px"},{title:"\u4ed8\u6b3e\u65f6\u95f4",dataIndex:"pay_date",width:"170px",render:function(e){return H.a.createElement("span",null,e&&j()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u7968\u53f7",dataIndex:"order_code",width:"150px"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onSendCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchSendCustomerList()},a.fetchSendCustomerList=function(){var e=g()(y.a.mark(function e(t){var n;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/sendCustomerListAction",payload:{filter:{}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=g()(y.a.mark(function e(t,a){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){n.pay_date?n.pay_date=n.pay_date.valueOf():delete n.pay_date;var o=Object.assign({filter:n},e);r({type:"pay/getTodayPayListAction",payload:h()({pageNo:t||i,pageSize:c},o)}),r({type:"pay/getTodayPayStatisticAction",payload:h()({},o)})}})},a.handleStandardTableChange=function(){var e=g()(y.a.mark(function e(t,n,r){var o,l,i,c;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.downAccountHandle=function(){var e=g()(y.a.mark(function e(t){var n,r,o,l;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.selectedRows,o=r.map(function(e){return e.order_id}),e.next=5,n({type:"pay/downAccountAction",payload:{order_id:o,rate:t.rate,bank_account:t.bank_account}});case 5:l=e.sent,0==l.code?(p["a"].success("\u4e0b\u8d26\u6210\u529f\uff01"),a.onDownCancel(),a.handleSearch()):p["a"].error(l.msg);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onDownAccount=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettle=g()(y.a.mark(function e(){var t,n;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=a.state.selectedRows,n=Object(B["a"])(t),a.setState({accountStatistic:n,settleModalVisible:!0});case 3:case"end":return e.stop()}},e)})),a.onSettleCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({settleModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettleOk=g()(y.a.mark(function e(){var t,n,r,o;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"settle/cancelSettleOrderAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(p["a"].success("\u53d6\u6d88\u7ed3\u7b97\u6210\u529f\uff01"),a.onSettleCancel(),a.handleSearch()):p["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onAddAbnormal=g()(y.a.mark(function e(){var t,n,r,o;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"pay/updatePayAbnormalAction",payload:{order_id:r,order:{pay_status:0}}});case 5:o=e.sent,0==o.code?(p["a"].success("\u53d6\u6d88\u5f02\u5e38\u6210\u529f\uff01"),a.handleSearch()):p["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onAddNormalModal=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:x["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u5c06\u6240\u9009\u8ba2\u5355\u53d6\u6d88\u5f02\u5e38\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onAddAbnormal});case 1:case"end":return e.stop()}},e)})),a.onCancelSign=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelDownAccountModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onCancelDownAccountCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelDownAccountModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelDownAccountOk=g()(y.a.mark(function e(){var t,n,r,o;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"pay/cancelDownAccountAction",payload:{order_id:r}});case 5:o=e.sent,o&&0==o.code?(p["a"].success("\u53d6\u6d88\u4e0b\u8d26\u6210\u529f\uff01"),a.handleSearch(),a.onCancelDownAccountCancel()):p["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onPrint=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=g()(y.a.mark(function e(){var t,n,r;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"pay/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(p["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):p["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=g()(y.a.mark(function e(){return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=g()(y.a.mark(function e(){var t,n,r,o;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"pay/downloadAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(p["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):p["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e})},a.onCancelPay=g()(y.a.mark(function e(){var t,n,r,o,l,i;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.props.dispatch,n=a.state.selectedRows,r=v()(a),o=!0,l=[],i=0,n.forEach(function(e){var t=j()((new Date).getTime()),a=t.subtract(j()(Number(e.pay_date)||0)).hours();a>=24&&(o=!1),l.push(e.pay_id),i+=Number(e.pay_amount||e.order_amount||0)}),o){e.next=10;break}return p["a"].error("\u4e0b\u8d26\u8d85\u8fc724\u5c0f\u65f6\u4e0d\u53ef\u4ee5\u53d6\u6d88"),e.abrupt("return");case 10:x["a"].confirm({content:H.a.createElement("div",null,"\u786e\u5b9a\u53d6\u6d88\u4e0b\u8d26\u4e48\uff1f\u4e0b\u8d26\u6761\u6570\uff1a",n.length,"\uff1b\u4e0b\u8d26\u603b\u989d\uff1a",i),onOk:function(){var e=g()(y.a.mark(function e(){var a;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t({type:"pay/cancelTodayDownAccountOrderAction",payload:{pay_id:l}});case 2:a=e.sent,a&&0==a.code?(p["a"].success("\u53d6\u6d88\u4e0b\u8d26\u6210\u529f\uff01"),r.handleSearch()):p["a"].error(a.msg);case 4:case"end":return e.stop()}},e)}));function a(){return e.apply(this,arguments)}return a}()});case 11:case"end":return e.stop()}},e)})),a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.pay,t=e.todayPayTotal,n=e.todayPayStatistic,r=void 0===n?{}:n;return H.a.createElement("div",{className:Z.a.tableFooter},H.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",r.totalOrderAmount||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r.totalTransAmount||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u4ed8\u6b3e\u603b\u989d\uff1a",r.totalPayAmount||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u4ee3\u529e\u8d39\u603b\u989d\uff1a",r.totalAgencyFee||"0"),H.a.createElement("span",{className:Z.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return N()(t,e),O()(t,[{key:"componentDidMount",value:function(){var e=g()(y.a.mark(function e(){var t;return y.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getBranchCompanyList",payload:h()({},G["a"])});case 3:t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}}),this.fetchSendCustomerList(),this.getOrderList();case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=(a.entrunkSiteList,a.normalSiteList),r=void 0===n?[]:n,o=e.customer,l=(o.getCustomerList,o.sendCustomerList),i=e.company.branchCompanyList,c={};return H.a.createElement(R["a"],{onSubmit:this.handleSearch,layout:"inline"},H.a.createElement(Q,{label:"\u5206\u516c\u53f8"},t("company_id",c)(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"80px"},allowClear:!0},i.map(function(e){return H.a.createElement(X,{key:e.company_id,value:e.company_id},e.company_name)})))),H.a.createElement(Q,{label:"\u8fd0\u5355\u53f7"},t("order_code",{})(H.a.createElement(S["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),H.a.createElement(Q,{label:"\u7ad9\u70b9"},t("site_id",{})(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"80px"},allowClear:!0},r.map(function(e){return H.a.createElement(X,{key:e.site_id,value:e.site_id},e.site_name)})))),H.a.createElement(Q,{label:"\u53d1\u8d27\u4eba\u59d3\u540d"},t("sendcustomer_id")(H.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSendCustomerSelect,style:{width:"80px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onSendCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},l.map(function(e){return H.a.createElement(X,{key:e.get,value:e.customer_id},e.customer_name)})))),H.a.createElement(Q,{label:"\u53d1\u8d27\u4eba\u7535\u8bdd"},t("sendcustomer_mobile",{})(H.a.createElement(S["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),H.a.createElement(Q,{label:"\u4ed8\u6b3e\u65e5\u671f"},t("pay_date",{initialValue:j()((new Date).getTime())})(H.a.createElement(u["a"],{format:"YYYY-MM-DD"}))),H.a.createElement(Q,null,H.a.createElement(E["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.pay,n=a.todayPayList,r=a.todayPayTotal,o=t.loading,l=this.state,i=l.selectedRows,c=l.accountStatistic,s=l.current,u=l.pageSize,p=l.updateOrderModalVisible,m=l.settleModalVisible,h=l.downModalVisible,f=l.signModalVisible,y=l.cancelDownAccountModalVisible,w=l.downloadModalVisible,g=l.printModalVisible,b=l.record;return H.a.createElement("div",null,H.a.createElement(d["a"],{bordered:!1},H.a.createElement("div",{className:Z.a.tableList},H.a.createElement("div",{className:Z.a.tableListForm},this.renderForm()),i.length>0&&H.a.createElement("span",null,H.a.createElement(E["a"],{onClick:this.onCancelPay},"\u53d6\u6d88\u4e0b\u8d26")),H.a.createElement(q["a"],{selectedRows:i,loading:o,className:Z.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:u,current:s,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick})),this.tableFooter()),H.a.createElement(K["a"],{modalVisible:p,record:b,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch}),H.a.createElement(W,{modalVisible:h,downAccountHandle:this.downAccountHandle,downCancel:this.onDownCancel,selectedRows:i}),H.a.createElement(x["a"],{title:"\u53d6\u6d88\u7ed3\u7b97",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:m,onOk:this.onSettleOk,onCancel:this.onSettleCancel},H.a.createElement("p",null,"\u53d6\u6d88\u7ed3\u7b97\u8d27\u6b3e\u6761\u6570".concat(i.length,"\uff0c\u53d6\u6d88\u7ed3\u7b97\u603b\u989d ").concat(c.totalAccount," ")),H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u7b97\u4e48\uff1f")),H.a.createElement(x["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:f,onOk:this.onSignOk,onCancel:this.onSignCancel},H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7b7e\u5b57\u4e48\uff1f")),H.a.createElement(x["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:y,onOk:this.onCancelDownAccountOk,onCancel:this.onCancelDownAccountCancel},H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u4e0b\u8d26\u4e48\uff1f")),H.a.createElement(x["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:g,onOk:this.onPrintOk,onCancel:this.onPrintCancel},H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),H.a.createElement(x["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:w,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},H.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(z["PureComponent"]),c=s))||c)||c);t["default"]=J},"hqF/":function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("miYZ"),a("tsqr")),p=a("p0pE"),m=a.n(p),h=a("d6i3"),f=a.n(h),y=a("1l/V"),w=a.n(y),g=(a("2qtc"),a("kLXV")),b=(a("5NDa"),a("5rEg")),v=(a("14J3"),a("BMrR")),x=(a("jCWc"),a("kPKH")),S=(a("+L6B"),a("2/Rp")),_=a("2Taf"),C=a.n(_),E=a("vZ4D"),k=a.n(E),L=a("l4Ni"),M=a.n(L),O=a("ujKo"),D=a.n(O),V=a("MhPg"),I=a.n(V),T=(a("OaEy"),a("2fM7")),F=(a("y8nQ"),a("Vl3Y")),N=a("q1tI"),A=a.n(N),R=a("MuoO"),z=a("wd/R"),H=a.n(z),P=a("B797"),Y=a("CkN6"),j=a("82qg"),B=a("ZeH8"),q=a.n(B),K=(a("S+eF"),a("XS0u")),U=F["a"].Item,Z=T["a"].Option,G=(n=F["a"].create(),n((o=function(e){function t(e){var a;return C()(this,t),a=M()(this,D()(t).call(this,e)),a.onAgencyFeeSelect=function(e,t){a.setState({agencyFee:parseFloat(e)})},a.onDownAccountHandler=function(){var e=a.props,t=e.downAccountHandle,n=e.form,r=a.state.agencyFee;n.validateFields(function(e,a){console.log(a),e||t({rate:r,bank_account:a.bank_account})})},a.state={agencyFee:4},a}return I()(t,e),k()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.downCancel,n=e.selectedRows,r=e.form,o=Object(P["b"])(n),l=n.length>0?n[0]:{},i=this.state.agencyFee;return A.a.createElement(g["a"],{destroyOnClose:!0,title:"\u4e0b\u8d26",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[A.a.createElement(S["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),A.a.createElement(S["a"],{key:"btn-save",type:"primary",onClick:this.onDownAccountHandler},"\u4fdd \u5b58")],width:800,className:q.a.modalForm},A.a.createElement(F["a"],null,A.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},A.a.createElement(x["a"],null,A.a.createElement(U,{labelCol:{span:3,offset:2},label:"\u4e0b\u8d26\u6761\u6570"},n.length))),A.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},A.a.createElement(x["a"],null,A.a.createElement(U,{labelCol:{span:3,offset:2},label:"\u4e0b\u8d26\u603b\u91d1\u989d"},o.totalActualGoodsFund||"0"," - \u4ee3\u529e\u8d39 *",A.a.createElement(T["a"],{placeholder:"\u8bf7\u9009\u62e9",defaultValue:"4",onSelect:this.onAgencyFeeSelect,style:{width:"80px"}},A.a.createElement(Z,{value:"0"},"0\u2030"),A.a.createElement(Z,{value:"1"},"1\u2030"),A.a.createElement(Z,{value:"2"},"2\u2030"),A.a.createElement(Z,{value:"3"},"3\u2030"),A.a.createElement(Z,{value:"4"},"4\u2030"),A.a.createElement(Z,{value:"5"},"5\u2030")),o.totalTransFunds?A.a.createElement("span",null," `- (\u8fd0\u8d39) $",o.totalTransFunds,"`"):A.a.createElement("span",null),"="," ",o.totalActualGoodsFund-Math.ceil(o.totalActualGoodsFund*i/1e3)-o.totalTransFunds||0))),A.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},A.a.createElement(x["a"],null,A.a.createElement(U,{labelCol:{span:3,offset:2},label:"\u6237\u4e3b"},l.getcustomer_name||"")),A.a.createElement(x["a"],null,A.a.createElement(U,{labelCol:{span:3,offset:2},label:"\u8d26\u6237"},r.getFieldDecorator("bank_account",{initialValue:l.bank_account})(A.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),A.a.createElement(v["a"],{gutter:{md:8,lg:24,xl:48}},A.a.createElement(x["a"],null,A.a.createElement(U,{labelCol:{span:3,offset:2},className:q.a.tableDetail,label:"\u660e\u7ec6"},A.a.createElement("table",null,A.a.createElement("thead",null,A.a.createElement("tr",null,A.a.createElement("th",null,"\u8fd0\u5355\u53f7"),A.a.createElement("th",null,"\u5b9e\u6536\u8d27\u6b3e"),A.a.createElement("th",null,"\u5e94\u6536\u8d27\u6b3e"))),A.a.createElement("tbody",null,n.map(function(e){return A.a.createElement("tr",null,A.a.createElement("td",null,e.order_code),A.a.createElement("td",null,e.order_real),A.a.createElement("td",null,e.order_amount))}))))))))}}]),t}(N["PureComponent"]),r=o))||r),Q=(l=Object(R["connect"])(function(e){var t=e.customer,a=e.company,n=e.pay,r=e.site,o=e.car,l=e.receiver,i=e.loading;return{customer:t,company:a,pay:n,site:r,car:o,receiver:l,loading:i.models.rule}}),i=F["a"].create(),l(c=i((s=function(e){function t(){var e,a;C()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=M()(this,(e=D()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,settleModalVisible:!1,downModalVisible:!1,signModalVisible:!1,cancelDownAccountModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1,currentCompany:{}},a.columns=[{title:"\u8d27\u5355\u53f7",dataIndex:"order_code",sorter:!0,align:"right",render:function(e){return"".concat(e)},needTotal:!0,width:"80px"},{title:"\u53d1\u8d27\u5ba2\u6237",dataIndex:"sendcustomer_name",width:"80px",sorter:!0},{title:"\u6536\u83b7\u5ba2\u6237",dataIndex:"getcustomer_name",sorter:!0,width:"80px"},{title:"\u5e94\u6536\u8d27\u6b3e",dataIndex:"order_amount",sorter:!0,width:"80px"},{title:"\u5b9e\u6536\u8d27\u6b3e",dataIndex:"order_real",sorter:!0,width:"80px"},{title:"\u5b9e\u6536\u8fd0\u8d39",dataIndex:"trans_discount",sorter:!0,width:"80px"},{title:"\u8fd0\u8d39\u65b9\u5f0f",dataIndex:"trans_type",sorter:!0,render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t},width:"80px"},{title:"\u57ab\u4ed8",dataIndex:"order_advancepay_amount",width:"80px"},{title:"\u9001\u8d27\u8d39",dataIndex:"deliver_amount",width:"80px"},{title:"\u4fdd\u4ef7\u8d39",dataIndex:"insurance_fee",width:"80px"},{title:"\u8d27\u7269\u540d\u79f0",dataIndex:"order_name",width:"150px"},{title:"\u5f55\u7968\u65f6\u95f4",dataIndex:"create_date",render:function(e){return A.a.createElement("span",null,e&&H()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"170px"},{title:"\u7ed3\u7b97\u65f6\u95f4",dataIndex:"settle_date",render:function(e){return A.a.createElement("span",null,e&&H()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"170px"},{title:"\u4ed8\u6b3e\u65f6\u95f4",dataIndex:"pay_date",render:function(e){return A.a.createElement("span",null,e&&H()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"170px"},{title:"\u7ad9\u70b9",dataIndex:"site_name",width:"80px"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onSendCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchSendCustomerList()},a.fetchSendCustomerList=function(){var e=w()(f.a.mark(function e(t){var n;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/sendCustomerListAction",payload:{filter:{}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=w()(f.a.mark(function e(t,a){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){n.pay_status=1;var o=Object.assign({filter:n},e);r({type:"pay/getOrderListAction",payload:m()({pageNo:t||i,pageSize:c},o)}),r({type:"pay/getOrderStatisticAction",payload:m()({},o)})}})},a.handleStandardTableChange=function(){var e=w()(f.a.mark(function e(t,n,r){var o,l,i,c;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.downAccountHandle=function(){var e=w()(f.a.mark(function e(t){var n,r,o,l;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log(t),n=a.props.dispatch,r=a.state.selectedRows,o=r.map(function(e){return e.order_id}),e.next=6,n({type:"pay/downAccountAction",payload:{order_id:o,rate:t.rate,bank_account:t.bank_account}});case 6:l=e.sent,0==l.code?(u["a"].success("\u4e0b\u8d26\u6210\u529f\uff01"),a.onDownCancel(),a.handleSearch()):u["a"].error(l.msg);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onDownAccount=w()(f.a.mark(function e(){var t,n;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.selectedRows,n=Object(P["b"])(t),n.isSameSendCustomer){e.next=5;break}return u["a"].error("\u8bf7\u9009\u62e9\u76f8\u540c\u5ba2\u6237\u7684\u8ba2\u5355\u8fdb\u884c\u4e0b\u8d26"),e.abrupt("return");case 5:if(n.isSettled){e.next=8;break}return u["a"].error("\u53ea\u80fd\u9009\u62e9\u5df2\u7ecf\u7ed3\u7b97\u7684\u8ba2\u5355\u8fdb\u884c\u4e0b\u8d26"),e.abrupt("return");case 8:a.setState({downModalVisible:!0});case 9:case"end":return e.stop()}},e)})),a.onDownCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettle=w()(f.a.mark(function e(){var t,n;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=a.state.selectedRows,n=Object(P["a"])(t),a.setState({accountStatistic:n,settleModalVisible:!0});case 3:case"end":return e.stop()}},e)})),a.onSettleCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({settleModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettleOk=w()(f.a.mark(function e(){var t,n,r,o;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"settle/cancelSettleOrderAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(u["a"].success("\u53d6\u6d88\u7ed3\u7b97\u6210\u529f\uff01"),a.onSettleCancel(),a.handleSearch()):u["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onAddAbnormal=w()(f.a.mark(function e(){var t,n,r,o;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"pay/updatePayAbnormalAction",payload:{order_id:r,order:{pay_status:0}}});case 5:o=e.sent,0==o.code?(u["a"].success("\u53d6\u6d88\u5f02\u5e38\u6210\u529f\uff01"),a.handleSearch()):u["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onAddNormalModal=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:g["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u5c06\u6240\u9009\u8ba2\u5355\u53d6\u6d88\u5f02\u5e38\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onAddAbnormal});case 1:case"end":return e.stop()}},e)})),a.onCancelSign=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelDownAccountModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onCancelDownAccountCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelDownAccountModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelDownAccountOk=w()(f.a.mark(function e(){var t,n,r,o;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"pay/cancelDownAccountAction",payload:{order_id:r}});case 5:o=e.sent,o&&0==o.code?(u["a"].success("\u53d6\u6d88\u4e0b\u8d26\u6210\u529f\uff01"),a.handleSearch(),a.onCancelDownAccountCancel()):u["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onPrint=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=w()(f.a.mark(function e(){var t,n,r;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"pay/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(u["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):u["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=w()(f.a.mark(function e(){var t,n,r;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"pay/downloadAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(u["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):u["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onUpdateOrderModalShow()},a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.pay,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=e.totalInsurancefee,l=e.totalAdvancepayAmount,i=e.totalDeliverAmount;return A.a.createElement("div",{className:q.a.tableFooter},A.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),A.a.createElement("span",{className:q.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),A.a.createElement("span",{className:q.a.footerSplit},"\u57ab\u4ed8\u603b\u989d\uff1a",l||"0"),A.a.createElement("span",{className:q.a.footerSplit},"\u9001\u8d27\u8d39\u603b\u989d\uff1a",i||"0"),A.a.createElement("span",{className:q.a.footerSplit},"\u4fdd\u4ef7\u8d39\u603b\u989d\uff1a",o||"0"),A.a.createElement("span",{className:q.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return I()(t,e),k()(t,[{key:"componentDidMount",value:function(){var e=w()(f.a.mark(function e(){var t;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getBranchCompanyList",payload:m()({},K["a"])});case 3:t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}}),this.fetchSendCustomerList(),this.getOrderList();case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=(a.entrunkSiteList,a.normalSiteList),r=void 0===n?[]:n,o=e.customer,l=(o.getCustomerList,o.sendCustomerList),i=e.company.branchCompanyList,c={};return A.a.createElement(F["a"],{onSubmit:this.handleSearch,layout:"inline"},A.a.createElement(U,{label:"\u5206\u516c\u53f8"},t("company_id",c)(A.a.createElement(T["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"80px"},allowClear:!0},i.map(function(e){return A.a.createElement(Z,{key:e.company_id,value:e.company_id},e.company_name)})))),A.a.createElement(U,{label:"\u8fd0\u5355\u53f7"},t("order_code",{})(A.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),A.a.createElement(U,{label:"\u7ad9\u70b9"},t("site_id",{})(A.a.createElement(T["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"80px"},allowClear:!0},r.map(function(e){return A.a.createElement(Z,{key:e.site_id,value:e.site_id},e.site_name)})))),A.a.createElement(U,{label:"\u53d1\u8d27\u4eba\u59d3\u540d"},t("sendcustomer_id")(A.a.createElement(T["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSendCustomerSelect,style:{width:"80px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onSendCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},l.map(function(e){return A.a.createElement(Z,{key:e.get,value:e.customer_id},e.customer_name)})))),A.a.createElement(U,{label:"\u53d1\u8d27\u4eba\u7535\u8bdd"},t("sendcustomer_mobile",{})(A.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),A.a.createElement(U,null,A.a.createElement(S["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.pay,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.loading),l=this.state,i=l.selectedRows,c=l.accountStatistic,s=l.current,u=l.pageSize,p=l.updateOrderModalVisible,m=l.settleModalVisible,h=l.downModalVisible,f=l.signModalVisible,y=l.cancelDownAccountModalVisible,w=l.downloadModalVisible,b=l.printModalVisible,v=l.record,x=!0;return["site_searchuser","site_admin"].indexOf(K["b"].role_value)>=0&&(x=!1),A.a.createElement("div",null,A.a.createElement(d["a"],{bordered:!1},A.a.createElement("div",{className:q.a.tableList},A.a.createElement("div",{className:q.a.tableListForm},this.renderForm()),A.a.createElement("div",{className:q.a.tableListOperator},i.length>0&&x&&A.a.createElement("span",null,A.a.createElement(S["a"],{onClick:this.onDownAccount},"\u4e0b\u8d26"),A.a.createElement(S["a"],{onClick:this.onAddNormalModal},"\u53d6\u6d88\u5f02\u5e38"),A.a.createElement(S["a"],{onClick:this.onPrint},"\u6253\u5370"))),A.a.createElement(Y["a"],{selectedRows:i,loading:o,className:q.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:u,current:s,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,rowClassNameHandler:function(e,t){return 6===e.order_status?q.a.settleColor:7===e.order_status?q.a.payColor:""}})),this.tableFooter()),A.a.createElement(j["a"],{modalVisible:p,record:v,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch}),A.a.createElement(G,{modalVisible:h,downAccountHandle:this.downAccountHandle,downCancel:this.onDownCancel,selectedRows:i}),A.a.createElement(g["a"],{title:"\u53d6\u6d88\u7ed3\u7b97",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:m,onOk:this.onSettleOk,onCancel:this.onSettleCancel},A.a.createElement("p",null,"\u53d6\u6d88\u7ed3\u7b97\u8d27\u6b3e\u6761\u6570".concat(i.length,"\uff0c\u53d6\u6d88\u7ed3\u7b97\u603b\u989d ").concat(c.totalAccount," ")),A.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u7b97\u4e48\uff1f")),A.a.createElement(g["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:f,onOk:this.onSignOk,onCancel:this.onSignCancel},A.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7b7e\u5b57\u4e48\uff1f")),A.a.createElement(g["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:y,onOk:this.onCancelDownAccountOk,onCancel:this.onCancelDownAccountCancel},A.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u4e0b\u8d26\u4e48\uff1f")),A.a.createElement(g["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:b,onOk:this.onPrintOk,onCancel:this.onPrintCancel},A.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),A.a.createElement(g["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:w,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},A.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(N["PureComponent"]),c=s))||c)||c);t["default"]=Q},ilQV:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i=a("bx4M"),c=(a("+L6B"),a("2/Rp")),s=(a("iQDF"),a("+eQT")),d=a("p0pE"),u=a.n(d),p=a("d6i3"),m=a.n(p),h=a("1l/V"),f=a.n(h),y=a("2Taf"),w=a.n(y),g=a("vZ4D"),b=a.n(g),v=a("l4Ni"),x=a.n(v),S=a("ujKo"),_=a.n(S),C=a("MhPg"),E=a.n(C),k=(a("OaEy"),a("2fM7")),L=(a("y8nQ"),a("Vl3Y")),M=a("q1tI"),O=a.n(M),D=a("MuoO"),V=a("wd/R"),I=a.n(V),T=(a("B797"),a("CkN6"),a("82qg"),a("LTkr")),F=a.n(T),N=(a("S+eF"),a("XS0u")),A=L["a"].Item,R=k["a"].Option,z=(n=Object(D["connect"])(function(e){var t=e.customer,a=e.company,n=e.courier,r=e.site,o=e.search,l=e.receiver,i=e.loading;return{customer:t,company:a,courier:n,site:r,search:o,receiver:l,loading:i.models.rule}}),r=L["a"].create(),n(o=r((l=function(e){function t(){var e,a;w()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=x()(this,(e=_()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,settleModalVisible:!1,downModalVisible:!1,signModalVisible:!1,cancelDownAccountModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1,currentCompany:{}},a.columns=[{title:"\u6536\u652f",dataIndex:"account_type",sorter:!0},{title:"\u7c7b\u578b\u9879\u76ee",dataIndex:"account_name"},{title:"\u91d1\u989d",dataIndex:"account_amount",sorter:!0},{title:"\u7528\u6237\u540d",dataIndex:"operator_name",sorter:!0},{title:"\u7ad9\u70b9",dataIndex:"site_name",sorter:!0},{title:"\u5206\u516c\u53f8",dataIndex:"company_name",sorter:!0},{title:"\u65e5\u671f",dataIndex:"account_date",render:function(e){return O.a.createElement("span",null,e&&I()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchCompanySiteList=f()(m.a.mark(function e(){var t;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=a.props.dispatch,t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:N["a"].company_id}}});case 2:case"end":return e.stop()}},e)})),a.fetchOperatorList=function(){var e=f()(m.a.mark(function e(t){var n,r,o;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,r=a.state.currentSite,o={},o.company_id=N["a"].company_id,r&&r.site_id&&(o.site_id=r.site_id),n({type:"courier/getOperatorListAction",payload:{pageNo:1,pageSize:100,filter:o}});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchGetCustomerList=function(){var e=f()(m.a.mark(function e(t){var n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=f()(m.a.mark(function e(t,a){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],a.props),n=t.dispatch,r=t.form,o=a.state;o.current,o.pageSize;r.validateFields(function(t,a){if(!t){a.company_id=N["a"].company_id,a.account_date&&a.account_date.valueOf&&(a.account_date=["".concat(new Date(0).getTime()),"".concat(a.account_date.valueOf())]);var r=Object.assign({filter:a},e);n({type:"search/getTodayAccountStatisticAction",payload:u()({},r)})}})},a.handleStandardTableChange=function(){var e=f()(m.a.mark(function e(t,n,r){var o,l,i,c;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onRowDoubleClick=function(e,t,n){a.setState({record:e})},a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.search,t=e.totalAccount,n=e.totalIncomeAccount,r=e.totalExpenseAccount;return O.a.createElement("div",null,O.a.createElement("span",null,"\u5e93\u5b58\u603b\u989d\uff1a",t||""),O.a.createElement("span",{className:F.a.footerSplit},"\u6536\u5165\u603b\u989d\uff1a",n||""),O.a.createElement("span",{className:F.a.footerSplit},"\u652f\u51fa\u603b\u989d\uff1a",r||""))},a}return E()(t,e),b()(t,[{key:"componentDidMount",value:function(){var e=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.props.dispatch,this.fetchCompanySiteList(),this.fetchOperatorList(),this.getOrderList();case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=a.siteList,r=void 0===n?[]:n;a.normalSiteList,e.courier.operatorList;return O.a.createElement(L["a"],{onSubmit:this.handleSearch,layout:"inline"},1==N["a"].company_type&&O.a.createElement(A,{label:"\u7ad9\u70b9"},t("site_id",{})(O.a.createElement(k["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"},allowClear:!0},r.map(function(e){return O.a.createElement(R,{key:e.site_id,value:e.site_id},e.site_name)})))),O.a.createElement(A,{label:"\u65e5\u671f"},t("account_date",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u65e5\u671f"}],initialValue:I()((new Date).getTime())})(O.a.createElement(s["a"],{placeholder:"\u8bf7\u9009\u62e9",format:"YYYY-MM-DD",style:{width:"100%"}}))),O.a.createElement(A,null,O.a.createElement(c["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this.props,t=e.search,a=(t.accounts,t.accountTotal,e.loading,this.state);a.selectedRows,a.current,a.pageSize;return O.a.createElement("div",null,O.a.createElement(i["a"],{bordered:!1},O.a.createElement("div",{className:F.a.tableList},O.a.createElement("div",{className:F.a.tableListForm},this.renderForm()),this.tableFooter())))}}]),t}(M["PureComponent"]),o=l))||o)||o);t["default"]=z},j6ho:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("miYZ"),a("tsqr")),p=a("d6i3"),m=a.n(p),h=a("1l/V"),f=a.n(h),y=(a("2qtc"),a("kLXV")),w=(a("14J3"),a("BMrR")),g=(a("jCWc"),a("kPKH")),b=a("jehZ"),v=a.n(b),x=(a("5NDa"),a("5rEg")),S=(a("+L6B"),a("2/Rp")),_=(a("O3gP"),a("lrIw")),C=a("2Taf"),E=a.n(C),k=a("vZ4D"),L=a.n(k),M=a("l4Ni"),O=a.n(M),D=a("ujKo"),V=a.n(D),I=a("MhPg"),T=a.n(I),F=(a("OaEy"),a("2fM7")),N=(a("y8nQ"),a("Vl3Y")),A=(a("iQDF"),a("+eQT")),R=a("q1tI"),z=a.n(R),H=a("MuoO"),P=(a("wd/R"),a("CkN6")),Y=a("9yR7"),j=a.n(Y),B=a("XS0u"),q=(A["a"].RangePicker,N["a"].Item),K=F["a"].Option,U=(n=N["a"].create(),n((o=function(e){function t(e){var a;return E()(this,t),a=O()(this,V()(t).call(this,e)),a.onAbnormalSelect=function(e,t){},a.onAddHandler=function(){var e=a.props,t=e.addFormDataHandle,n=e.form,r=e.record,o=void 0===r?{}:r;n.validateFields(function(e,a){if(!e){var n={courier:a};o.courier_id&&(n.ids=[o.courier_id],a.courier_id=o.courier_id),t(n)}})},a.renderCustomerOption=function(e){var t=_["a"].Option;return z.a.createElement(t,{key:e.expensetype_id,expensetype_id:e.expensetype_id,text:e.expensetype},e.expensetype)},a.state={abnormal_type_id:"",abnormal_type:""},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return T()(t,e),L()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelHandler,n=e.record,r=e.form;e.roleList;return z.a.createElement(y["a"],{destroyOnClose:!0,title:"\u6dfb\u52a0\u9001\u8d27\u4eba",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[z.a.createElement(S["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),z.a.createElement(S["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:j.a.modalForm},z.a.createElement(N["a"],null,z.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(g["a"],null,z.a.createElement(q,v()({},this.formItemLayout,{label:"\u59d3\u540d"}),r.getFieldDecorator("courier_name",{initialValue:n.courier_name,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u59d3\u540d"}]})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),z.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(g["a"],null,z.a.createElement(q,v()({},this.formItemLayout,{label:"\u7535\u8bdd"}),r.getFieldDecorator("courier_mobile",{initialValue:n.courier_mobile,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7535\u8bdd"}]})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}})))))))}}]),t}(R["PureComponent"]),r=o))||r),Z=(l=Object(H["connect"])(function(e){var t=e.customer,a=e.courier,n=e.site,r=e.company,o=e.loading;return{customer:t,courier:a,site:n,company:r,loading:o.models.rule}}),i=N["a"].create(),l(c=i((s=function(e){function t(){var e,a;E()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=O()(this,(e=V()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],formValues:{},current:1,pageSize:20,record:{},currentCompany:{},currentSite:{},addModalVisible:!1},a.columns=[{title:"\u59d3\u540d",dataIndex:"courier_name",width:"100px"},{title:"\u7528\u6237\u7535\u8bdd",dataIndex:"courier_mobile",width:"150px"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchCompanySiteList=function(){var e=f()(m.a.mark(function e(t){var n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchGetCustomerList=function(){var e=f()(m.a.mark(function e(t){var n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=f()(m.a.mark(function e(t,n){var r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,o=r.company.companyList,r.form,a.fetchCompanySiteList(t),l=o.filter(function(e){if(e.company_id==t)return e}),l.length>0&&a.setState({currentCompany:l[0]});case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onSiteSelect=function(){var e=f()(m.a.mark(function e(t,n){var r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.site.siteList,o=void 0===r?[]:r,l=o.filter(function(e){if(e.site_id==t)return e}),l.length>0&&a.setState({currentSite:l[0]});case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=a.props,n=t.dispatch,r=t.form,o=a.state,l=o.current,i=o.pageSize;r.validateFields(function(t,a){t||n({type:"courier/getCourierListAction",payload:{pageNo:e||l,pageSize:i,type:"sender",filter:{company_id:B["a"].company_id}}})})},a.handleStandardTableChange=function(){var e=f()(m.a.mark(function e(t,n,r){var o,l,i,c;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.addFormDataHandle=function(){var e=f()(m.a.mark(function e(t){var n,r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=t.courier,r=t.ids,o=a.props.dispatch,console.log(n,r),n.company_id||(n.company_id=B["a"].company_id),e.next=6,o({type:"courier/updateCourierAction",payload:{courier:n,ids:r,type:"sender"}});case 6:l=e.sent,l&&0==l.code?(u["a"].success("\u6dfb\u52a0\u6210\u529f\uff01"),a.handleSearch(),a.onCancelModalClick()):u["a"].error(l&&l.msg||"\u6dfb\u52a0\u5931\u8d25");case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onAddClick=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addModalVisible:!0,record:{}});case 1:case"end":return e.stop()}},e)})),a.onCancelModalClick=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onModalShow=function(){a.setState({addModalVisible:!0})},a.onModalCancel=function(){a.setState({addModalVisible:!1})},a.onSiteChange=function(e){console.log("site",e),e||a.setState({currentSite:{}})},a.onCompanyChange=function(e){console.log("company",e),e||a.setState({currentCompany:{}})},a.onRowClick=function(e,t,a){},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onModalShow()},a}return T()(t,e),L()(t,[{key:"componentDidMount",value:function(){var e=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){var e=this,t=this.props,a=(t.company.companyList,t.courier),n=a.senderList,r=a.senderTotal,o=t.loading,l=this.state,i=l.selectedRows,c=l.current,s=l.pageSize,u=l.addModalVisible,p=l.record;l.currentCompany;return z.a.createElement("div",null,z.a.createElement(d["a"],{bordered:!1},z.a.createElement("div",{className:j.a.tableList},z.a.createElement("div",{className:j.a.tableListOperator},z.a.createElement(N["a"],{onSubmit:this.handleSearch,layout:"inline"},z.a.createElement(q,{label:"\u516c\u53f8"},z.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"},defaultValue:B["a"].company_id},[B["a"]].map(function(e){return z.a.createElement(K,{key:e.company_id,value:e.company_id},e.company_name)}))),z.a.createElement(q,null,z.a.createElement(S["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")),z.a.createElement(q,null,z.a.createElement(S["a"],{icon:"plus",type:"primary",onClick:function(){return e.onAddClick(!0)}},"\u6dfb\u52a0")))),z.a.createElement(P["a"],{selectedRows:i,loading:o,className:j.a.dataTable,scroll:{x:900,y:350},rowKey:"courier_id",data:{list:n,pagination:{total:r,pageSize:s,current:c,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,footer:function(){}}))),z.a.createElement(U,{modalVisible:u,addFormDataHandle:this.addFormDataHandle,onCancelHandler:this.onCancelModalClick,record:p,selectedRows:i}))}}]),t}(R["PureComponent"]),c=s))||c)||c);t["default"]=Z},kLEI:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=a("d6i3"),p=a.n(u),m=a("1l/V"),h=a.n(m),f=(a("2qtc"),a("kLXV")),y=(a("7Kak"),a("9yH6")),w=(a("14J3"),a("BMrR")),g=(a("jCWc"),a("kPKH")),b=a("jehZ"),v=a.n(b),x=(a("5NDa"),a("5rEg")),S=(a("+L6B"),a("2/Rp")),_=(a("O3gP"),a("lrIw")),C=(a("miYZ"),a("tsqr")),E=a("2Taf"),k=a.n(E),L=a("vZ4D"),M=a.n(L),O=a("l4Ni"),D=a.n(O),V=a("ujKo"),I=a.n(V),T=a("MhPg"),F=a.n(T),N=(a("OaEy"),a("2fM7")),A=(a("y8nQ"),a("Vl3Y")),R=(a("iQDF"),a("+eQT")),z=a("q1tI"),H=a.n(z),P=a("MuoO"),Y=(a("wd/R"),a("CkN6")),j=a("o6JX"),B=a.n(j),q=(a("XS0u"),R["a"].RangePicker,A["a"].Item),K=N["a"].Option,U=(n=A["a"].create(),n((o=function(e){function t(e){var a;return k()(this,t),a=D()(this,I()(t).call(this,e)),a.onAbnormalSelect=function(e,t){},a.onAddHandler=function(){var e=a.props,t=e.addFormDataHandle,n=e.form,r=e.record,o=void 0===r?{}:r;n.validateFields(function(e,a){if(e)for(var n=["1","2","3"],r=0;r<3;r++){var l=n[r];if(e["sendfee_ratio_".concat(l)]){var i=e["sendfee_ratio_".concat(l)].errors[0]||{};return void C["a"].error(i.message)}}else{a.trans_regional_ratio=Number(a.trans_regional_ratio||1),a.remember_sender=Number(a.remember_sender),a.late_fee_days=Number(a.late_fee_days),a.late_fee_beginamount=Number(a.late_fee_beginamount),a.late_fee_rate=Number(a.late_fee_rate),a.rewards_24h=Number(a.rewards_24h),a.rewards_48h=Number(a.rewards_48h),a.rewards_72h=Number(a.rewards_72h),a.alarm_days=Number(a.alarm_days),a.agency_fee=Number(a.agency_fee),a.bonus_type=Number(a.bonus_type),a.sendfee_ratio=Number(a["sendfee_ratio_".concat(a.bonus_type)]),a.unsendfee_ratio=Number(a["unsendfee_ratio_".concat(a.bonus_type)]),["1","2","3"].forEach(function(e){delete a["sendfee_ratio_".concat(e)],delete a["unsendfee_ratio_".concat(e)]});var c={company:a};o.company_id&&(c.ids=[o.company_id]),t(c)}})},a.renderCustomerOption=function(e){var t=_["a"].Option;return H.a.createElement(t,{key:e.expensetype_id,expensetype_id:e.expensetype_id,text:e.expensetype},e.expensetype)},a.state={abnormal_type_id:"",abnormal_type:""},a.formItemLayout={labelCol:{xs:{span:6},sm:{span:3}},wrapperCol:{xs:{span:30},sm:{span:20}}},a}return F()(t,e),M()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelHandler,n=e.record,r=e.form;return H.a.createElement(f["a"],{destroyOnClose:!0,title:"\u6dfb\u52a0\u516c\u53f8",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[H.a.createElement(S["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),H.a.createElement(S["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:900,className:B.a.modalForm},H.a.createElement(A["a"],null,H.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(g["a"],null,H.a.createElement(q,v()({},this.formItemLayout,{label:"\u516c\u53f8\u540d\u79f0"}),r.getFieldDecorator("company_name",{initialValue:n.company_name,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u516c\u53f8\u540d\u79f0"}]})(H.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),H.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(g["a"],null,H.a.createElement(q,v()({},this.formItemLayout,{label:"\u5e94\u6253\u6b3e"}),r.getFieldDecorator("bonus_type",{initialValue:n.bonus_type,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5e94\u6253\u6b3e"},{pattern:/^\d+(\.\d+)?$/,message:"\u5e94\u6253\u6b3e\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(y["a"].Group,null,H.a.createElement(y["a"],{value:1},H.a.createElement("strong",null,"\u5e73\u5206\u6cd5\uff1a")," (\u8fd0\u8d39\u603b\u989d-\u5927\u8f66\u8fd0\u8d39)/2 + \u9001\u8d27\u8fd0\u8d39 \u2715",r.getFieldDecorator("sendfee_ratio_1",{initialValue:1==n.bonus_type&&n.sendfee_ratio||.06,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u9001\u8d27\u8fd0\u8d39\u7387"},{pattern:/^\d+(\.\d+)?$/,message:"\u9001\u8d27\u8fd0\u8d39\u7387\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"60px"}})),"+ \u4e0d\u9001\u8d27\u8fd0\u8d39 \u2715",r.getFieldDecorator("unsendfee_ratio_1",{initialValue:1==n.bonus_type&&n.unsendfee_ratio||.11,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u4e0d\u9001\u8d27\u8fd0\u8d39\u7387"},{pattern:/^\d+(\.\d+)?$/,message:"\u4e0d\u9001\u8d27\u8fd0\u8d39\u7387\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"60px"}})),"- \u897f\u5b89\u6536\u8fd0\u8d39 + \u5b9e\u6536\u8d27\u6b3e - \u6253\u6b3e\u603b\u989d"),H.a.createElement(y["a"],{value:2},H.a.createElement("strong",null,"\u591a\u52b3\u591a\u5f97\uff1a")," \u8fd0\u8d39\u603b\u989d - \u9001\u8d27\u8fd0\u8d39 \u2715",r.getFieldDecorator("sendfee_ratio_2",{initialValue:2==n.bonus_type&&n.sendfee_ratio||.22,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u9001\u8d27\u8fd0\u8d39\u7387"},{pattern:/^\d+(\.\d+)?$/,message:"\u9001\u8d27\u8fd0\u8d39\u7387\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"60px"}})),"- \u4e0d\u9001\u8d27\u8fd0\u8d39 \u2715",r.getFieldDecorator("unsendfee_ratio_2",{initialValue:2==n.bonus_type&&n.unsendfee_ratio||.12,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u4e0d\u9001\u8d27\u8fd0\u8d39\u7387"},{pattern:/^\d+(\.\d+)?$/,message:"\u4e0d\u9001\u8d27\u8fd0\u8d39\u7387\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"60px"}})),"- \u5927\u8f66\u8fd0\u8d39 - \u897f\u5b89\u6536\u8fd0\u8d39 + \u5b9e\u6536\u8d27\u6b3e - \u6253\u6b3e\u603b\u989d"),H.a.createElement(y["a"],{value:3},H.a.createElement("strong",null,"\u4f18\u60e0\u6cd5\uff1a")," \u9001\u8d27\u8fd0\u8d39 \u2715",r.getFieldDecorator("sendfee_ratio_3",{initialValue:3==n.bonus_type&&n.sendfee_ratio||.25,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u9001\u8d27\u8fd0\u8d39\u7387"},{pattern:/^\d+(\.\d+)?$/,message:"\u9001\u8d27\u8fd0\u8d39\u7387\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"60px"}})),"+ \u4e0d\u9001\u8d27\u8fd0\u8d39 \u2715",r.getFieldDecorator("unsendfee_ratio_3",{initialValue:3==n.bonus_type&&n.unsendfee_ratio||.3,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u4e0d\u9001\u8d27\u8fd0\u8d39\u7387"},{pattern:/^\d+(\.\d+)?$/,message:"\u4e0d\u9001\u8d27\u8fd0\u8d39\u7387\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"60px"}})),"- \u4e0a\u7ad9\u8fd0\u8d39 + \u5b9e\u6536\u8d27\u6b3e - \u6253\u6b3e\u603b\u989d")))))),H.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(g["a"],null,H.a.createElement(q,v()({},this.formItemLayout,{label:"\u8fd0\u8d39\u8d39\u7387"}),r.getFieldDecorator("trans_regional_ratio",{initialValue:n.trans_regional_ratio||1,rules:[{required:!0,message:""},{pattern:/^\d+(\.\d+)?$/,message:"\u8fd0\u8d39\u8d39\u7387\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"80px"}})),H.a.createElement("strong",{className:"inner-form-label"},"\xa0\u4ee3\u529e\u8d39\u7387\uff1a"),r.getFieldDecorator("agency_fee",{initialValue:n.agency_fee||.4,rules:[{required:!0,message:""},{pattern:/^\d+(\.\d+)?$/,message:"\u4ee3\u529e\u8d39\u7387\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"62px"}})),"\u2030",H.a.createElement("strong",{className:"inner-form-label"},"\xa0\u62a5\u8b66\u5929\u6570\uff1a"),r.getFieldDecorator("alarm_days",{initialValue:n.alarm_days||0,rules:[{required:!0,message:""},{pattern:/^\d+(\.\d+)?$/,message:"\u62a5\u8b66\u5929\u6570\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"80px"}}))))),H.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(g["a"],null,H.a.createElement(q,v()({},this.formItemLayout,{label:"24H\u5956\u91d1"}),r.getFieldDecorator("rewards_24h",{initialValue:n.rewards_24h||1,rules:[{required:!0,message:""},{pattern:/^\d+(\.\d+)?$/,message:"\u5956\u91d1\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"62px"}})),"\u2030",H.a.createElement("strong",{className:"inner-form-label"},"\xa048H\u5956\u91d1\uff1a"),r.getFieldDecorator("rewards_48h",{initialValue:n.rewards_48h||.04,rules:[{required:!0,message:""},{pattern:/^\d+(\.\d+)?$/,message:"\u5956\u91d1\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"62px"}})),"\u2030",H.a.createElement("strong",{className:"inner-form-label"},"\xa072H\u5956\u91d1\uff1a"),r.getFieldDecorator("rewards_72h",{initialValue:n.rewards_72h||.01,rules:[{required:!0,message:""},{pattern:/^\d+(\.\d+)?$/,message:"\u5956\u91d1\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"80px"}})),"\u2030"))),H.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(g["a"],null,H.a.createElement(q,v()({},this.formItemLayout,{label:"\u6ede\u7eb3\u91d1\u5929\u6570"}),r.getFieldDecorator("late_fee_days",{initialValue:n.late_fee_days||12,rules:[{required:!0,message:""},{pattern:/^\d+(\.\d+)?$/,message:"\u6ede\u7eb3\u91d1\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"80px"}})),H.a.createElement("strong",{className:"inner-form-label"},"\xa0\u6ede\u7eb3\u91d1\u8d77\u59cb\u91d1\u989d\uff1a"),r.getFieldDecorator("late_fee_beginamount",{initialValue:n.late_fee_beginamount||10,rules:[{required:!0,message:""},{pattern:/^\d+(\.\d+)?$/,message:"\u6ede\u7eb3\u91d1\u91d1\u989d\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"80px"}})),H.a.createElement("strong",{className:"inner-form-label"},"\xa0\u6ede\u7eb3\u91d1\u8d39\u7387\uff1a"),r.getFieldDecorator("late_fee_rate",{initialValue:n.late_fee_rate||.5,rules:[{required:!0,message:""},{pattern:/^\d+(\.\d+)?$/,message:"\u6ede\u7eb3\u91d1\u8d39\u7387\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"80px"}})),"\u2030"))),H.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(g["a"],null,H.a.createElement(q,v()({},this.formItemLayout,{label:"\u516c\u53f8\u7535\u8bdd"}),r.getFieldDecorator("company_mobile",{initialValue:n.company_mobile,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u516c\u53f8\u7535\u8bdd"}]})(H.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}})),H.a.createElement("strong",{className:"inner-form-label"},"\xa0\u9001\u8d27\u4eba\u662f\u5426\u8bb0\u5fc6\uff1a"),r.getFieldDecorator("remember_sender",{initialValue:n.remember_sender||1,rules:[{required:!0,message:""}]})(H.a.createElement(N["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"}},H.a.createElement(K,{value:1},"\u662f"),H.a.createElement(K,{value:0},"\u5426")))))),H.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},H.a.createElement(g["a"],null,H.a.createElement(q,v()({},this.formItemLayout,{label:"\u5730\u5740"}),r.getFieldDecorator("company_address",{initialValue:n.company_address})(H.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}})),H.a.createElement("strong",{className:"inner-form-label"},"\xa0\u4fdd\u4ef7\u8d39\u7387\uff1a"),r.getFieldDecorator("insurance_ratio",{initialValue:n.insurance_ratio||2,rules:[{required:!0,message:""},{pattern:/^\d+(\.\d+)?$/,message:"\u4fdd\u4ef7\u8d39\u7387\u683c\u5f0f\u9519\u8bef"}]})(H.a.createElement(x["a"],{placeholder:"",style:{width:"80px"}})),"\u2030")))))}}]),t}(z["PureComponent"]),r=o))||r),Z=(l=Object(P["connect"])(function(e){var t=e.customer,a=e.company,n=e.loading;return{customer:t,company:a,loading:n.models.rule}}),i=A["a"].create(),l(c=i((s=function(e){function t(){var e,a;k()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=D()(this,(e=I()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],formValues:{},current:1,pageSize:20,record:{},currentCompany:{},currentSite:{},addModalVisible:!1},a.columns=[{title:"\u516c\u53f8\u540d\u79f0",width:"100px",dataIndex:"company_name"},{title:"\u516c\u53f8\u7535\u8bdd",dataIndex:"company_mobile",width:"130px"},{title:"\u5730\u57df\u7cfb\u6570",dataIndex:"trans_regional_ratio",width:"80px"},{title:"\u5730\u5740",dataIndex:"company_address",width:"100px"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchCompanySiteList=function(){var e=h()(p.a.mark(function e(t){var n;return p.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchGetCustomerList=function(){var e=h()(p.a.mark(function e(t){var n;return p.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=h()(p.a.mark(function e(t,n){var r,o,l;return p.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,o=r.company.branchCompanyList,r.form,a.fetchCompanySiteList(t),l=o.filter(function(e){if(e.company_id==t)return e}),l.length>0&&a.setState({currentCompany:l[0]});case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onSiteSelect=function(){var e=h()(p.a.mark(function e(t,n){var r,o,l;return p.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.site.normalSiteList,o=void 0===r?[]:r,l=o.filter(function(e){if(e.site_id==t)return e}),l.length>0&&a.setState({currentSite:l[0]}),a.fetchExpenseTypeList({siteId:t});case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]&&arguments[1];var e=a.props,t=e.dispatch,n=e.form,r=a.state;r.current,r.pageSize,r.currentCompany;n.validateFields(function(e,a){e||t({type:"company/getBranchCompanyList",payload:{company_type:1}})})},a.handleStandardTableChange=function(){var e=h()(p.a.mark(function e(t,n,r){var o,l,i,c;return p.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.addFormDataHandle=function(){var e=h()(p.a.mark(function e(t){var n,r,o,l;return p.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=t.company,r=t.ids,o=a.props.dispatch,e.next=4,o({type:"company/addCompany",payload:{company:n,ids:r}});case 4:l=e.sent,l&&0==l.code?(C["a"].success("\u6dfb\u52a0\u6210\u529f\uff01"),a.handleSearch(),a.onCancelModalClick()):C["a"].error(l&&l.msg||"\u6dfb\u52a0\u5931\u8d25");case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onAddClick=h()(p.a.mark(function e(){return p.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addModalVisible:!0,record:{}});case 1:case"end":return e.stop()}},e)})),a.onCancelModalClick=h()(p.a.mark(function e(){return p.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onModalShow=function(){a.setState({addModalVisible:!0})},a.onModalCancel=function(){a.setState({addModalVisible:!1})},a.onSiteChange=function(e){console.log("site",e),e||a.setState({currentSite:{}})},a.onCompanyChange=function(e){console.log("company",e),e||a.setState({currentCompany:{}})},a.onUpdateOrder=function(){var e=h()(p.a.mark(function e(t,n){var r,o;return p.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.props.dispatch,console.log(t,n),e.next=4,r({type:"order/updateOrderAction",payload:{orderIds:[t.order_id],order:{trans_real:n.trans_real,order_real:n.order_real}}});case 4:o=e.sent,0==o.code?(C["a"].success("\u4fee\u6539\u6210\u529f\uff01"),a.onModalCancel()):C["a"].error(o.msg);case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onRowClick=function(e,t,a){},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onModalShow()},a}return F()(t,e),M()(t,[{key:"componentDidMount",value:function(){var e=h()(p.a.mark(function e(){var t;return p.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=this.props.dispatch,t({type:"company/getBranchCompanyList",payload:{company_type:1}}),this.getOrderList();case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){var e=this,t=this.props,a=t.company,n=a.branchCompanyList,r=a.branchTotal,o=t.loading,l=this.state,i=l.selectedRows,c=l.current,s=l.pageSize,u=l.addModalVisible,p=l.record;return H.a.createElement("div",null,H.a.createElement(d["a"],{bordered:!1},H.a.createElement("div",{className:B.a.tableList},H.a.createElement("div",{className:B.a.tableListOperator},H.a.createElement(S["a"],{icon:"plus",type:"primary",onClick:function(){return e.onAddClick(!0)}},"\u6dfb\u52a0")),H.a.createElement(Y["a"],{selectedRows:i,loading:o,className:B.a.dataTable,scroll:{x:900,y:350},rowKey:"company_id",data:{list:n,pagination:{total:r,pageSize:s,current:c,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,footer:function(){}}))),H.a.createElement(U,{modalVisible:u,addFormDataHandle:this.addFormDataHandle,onCancelHandler:this.onCancelModalClick,record:p,selectedRows:i}))}}]),t}(z["PureComponent"]),c=s))||c)||c);t["default"]=Z},"lh+i":function(e,t,a){e.exports={main:"antd-pro-components-page-header-wrapper-grid-content-main",wide:"antd-pro-components-page-header-wrapper-grid-content-wide"}},lvrh:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("miYZ"),a("tsqr")),p=a("p0pE"),m=a.n(p),h=(a("2qtc"),a("kLXV")),f=(a("5NDa"),a("5rEg")),y=a("jehZ"),w=a.n(y),g=(a("14J3"),a("BMrR")),b=(a("jCWc"),a("kPKH")),v=(a("+L6B"),a("2/Rp")),x=a("d6i3"),S=a.n(x),_=a("1l/V"),C=a.n(_),E=(a("O3gP"),a("lrIw")),k=a("2Taf"),L=a.n(k),M=a("vZ4D"),O=a.n(M),D=a("l4Ni"),V=a.n(D),I=a("ujKo"),T=a.n(I),F=a("MhPg"),N=a.n(F),A=(a("OaEy"),a("2fM7")),R=(a("y8nQ"),a("Vl3Y")),z=(a("iQDF"),a("+eQT")),H=a("q1tI"),P=a.n(H),Y=a("MuoO"),j=a("wd/R"),B=a.n(j),q=(a("B797"),a("CkN6")),K=a("KbBV"),U=a.n(K),Z=(a("S+eF"),a("XS0u")),G=z["a"].RangePicker,Q=R["a"].Item,X=A["a"].Option,W=(n=R["a"].create(),n((o=function(e){function t(e){var a;return L()(this,t),a=V()(this,T()(t).call(this,e)),a.onAddHandler=function(){var e=a.props,t=e.addFormDataHandle,n=e.form,r=e.debtTypes,o=e.debtUserList;n.validateFields(function(e,a){var n,l;e||(r.forEach(function(e){e.debttype_id==a["debttype_id"]&&(n=e)}),n?(a.debttype_id=Number(a.debttype_id),a.debttype=n.debttype,a.debttype_type=n.debttype_type):(a.debttype=a.debttype_id,a.debttype_id=0),o.forEach(function(e){e.debtuser_id==a.debtuser_id&&(l=e)}),l?a.debtuser_name=l.debtuser_name:(a.debtuser_name=a.debtuser_id,a.debtuser_id=0),t(a))})},a.renderCustomerOption=function(e){var t=E["a"].Option;return P.a.createElement(t,{key:e.debttype_id,debttype_id:e.debttype_id,text:e.debttype},e.debttype)},a.onDebtTypeSelect=function(e){var t=a.props,n=t.debtTypes,r=void 0===n?[]:n,o=t.form;r.forEach(function(t){t.debttype_id==e&&o.setFieldsValue({debttype_type:t.debttype_type})})},a.onDebtUserSearch=function(){var e=C()(S.a.mark(function e(t){return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t&&a.setState({currentDebtUserName:t});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onDebtUserBlur=function(e){for(var t,n=a.props,r=n.form,o=n.debtUserList,l=a.state.currentDebtUserName,i=0;i<o.length;i++){var c=o[i];if(c.debtuser_name==l||c.debtuser_name==e||c.debtuser_id==e){t=c;break}}t||r.setFieldsValue({debtuser_id:l})},a.state={currentDebtUserName:""},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return N()(t,e),O()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelHandler,n=e.onCustomerScroll,r=e.form,o=e.debtUserList,l=void 0===o?[]:o,i=e.debtTypes,c=void 0===i?[]:i;return P.a.createElement(h["a"],{destroyOnClose:!0,title:"\u6dfb\u52a0\u6536\u6b20\u6761",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[P.a.createElement(v["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),P.a.createElement(v["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:U.a.modalForm},P.a.createElement(R["a"],null,P.a.createElement(g["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(b["a"],null,P.a.createElement(Q,{labelCol:{span:5},wrapperCol:{span:14},label:"\u7c7b\u578b"},r.getFieldDecorator("debttype_id",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7c7b\u578b"}]})(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"}},c.map(function(e){return P.a.createElement(X,{key:e.debttype_id,value:e.debttype_id},e.debttype)})))))),"\u3001",P.a.createElement(g["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(b["a"],null,P.a.createElement(Q,w()({},this.formItemLayout,{label:"\u59d3\u540d"}),r.getFieldDecorator("debtuser_id",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u59d3\u540d"}]})(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onGetCustomerSelect,style:{width:"150px"},allowClear:!0,showSearch:!0,onSearch:this.onDebtUserSearch,onBlur:this.onDebtUserBlur,optionLabelProp:"children",onPopupScroll:n,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},l.map(function(e){return P.a.createElement(X,{key:e.debtuser_id,value:e.debtuser_id},e.debtuser_name)})))))),P.a.createElement(g["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(b["a"],null,P.a.createElement(Q,w()({},this.formItemLayout,{label:"\u91d1\u989d"}),r.getFieldDecorator("debt_money",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u91d1\u989d"}]})(P.a.createElement(f["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),P.a.createElement(g["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(b["a"],null,P.a.createElement(Q,{labelCol:{span:3,offset:2},label:"\u5907\u6ce8"},r.getFieldDecorator("remark",{initialValue:""})(P.a.createElement(f["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}})))))))}}]),t}(H["PureComponent"]),r=o))||r),J=(l=Object(Y["connect"])(function(e){var t=e.customer,a=e.company,n=e.debt,r=e.site,o=e.loading;return{customer:t,company:a,debt:n,site:r,loading:o.models.rule}}),i=R["a"].create(),l(c=i((s=function(e){function t(){var e,a;L()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=V()(this,(e=T()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],formValues:{},current:1,pageSize:20,record:{},currentDebtUserName:"",currentSite:{},addDebtModalVisible:!1},a.columns=[{title:"\u65e5\u671f",dataIndex:"debt_date",width:"170px",sorter:!0,render:function(e){return P.a.createElement("span",null,B()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss"))}},{title:"\u91d1\u989d",dataIndex:"debt_money",width:"80px",sorter:!0},{title:"\u7c7b\u578b",dataIndex:"debttype",width:"80px",sorter:!0},{title:"\u5ba2\u6237\u59d3\u540d",dataIndex:"debtuser_name",width:"80px",sorter:!0},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchDebtTypeList=C()(S.a.mark(function e(){var t,n;return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=a.props.dispatch,n=a.state.currentSite,t({type:"debt/getDebtTypesAction",payload:{company_id:Z["a"].company_id,site_id:n&&n.site_id||0}});case 3:case"end":return e.stop()}},e)})),a.fetchCompanySiteList=function(){var e=C()(S.a.mark(function e(t){var n,r;return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,e.next=3,n({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 3:r=e.sent,r.length>0&&a.setState({currentSite:r[0]});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchDebtUserList=function(){var e=C()(S.a.mark(function e(t){var n,r,o,l;return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,r=a.state.currentSite,o=void 0===r?{}:r,l={company_id:Z["a"].company_id},o.site_id&&(l.site_id=o.site_id),n({type:"debt/getDebtUsersAction",payload:{filter:l}});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onSiteSelect=function(){var e=C()(S.a.mark(function e(t,n){var r,o,l,i,c;return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,o=r.site.normalSiteList,l=void 0===o?[]:o,i=r.dispatch,c=l.filter(function(e){if(e.site_id==t)return e}),c.length>0&&a.setState({currentSite:c[0]}),i({type:"debt/resetDebtUserPageNoAction",payload:{}}),a.fetchDebtTypeList(),a.fetchDebtUserList();case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=n.debt.debtUserList,i=void 0===l?[]:l,c=a.state,s=c.current,d=c.pageSize;o.validateFields(function(a,n){if(!a){n.debt_date&&n.debt_date.length>0&&(n.debt_date=n.debt_date.map(function(e){return"".concat(e.valueOf())}));var o=!1;i.forEach(function(e){e.debtuser_id==n.debtuser_id&&(o=!0)}),o||(n.debtuser_name=n.debtuser_id,delete n.debtuser_id),n.company_id=Z["a"].company_id;var l=Object.assign({filter:n},e);r({type:"debt/getDebtsAction",payload:m()({pageNo:t||s,pageSize:d},l)}),r({type:"debt/getDebtsStatisticAction",payload:m()({},l)})}})},a.handleStandardTableChange=function(){var e=C()(S.a.mark(function e(t,n,r){var o,l,i,c;return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.addFormDataHandle=function(){var e=C()(S.a.mark(function e(t){var n,r,o,l;return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.currentSite,o=void 0===r?{}:r,e.next=4,n({type:"debt/addDebtAction",payload:m()({},t,{company_id:Z["a"].company_id,site_id:o.site_id})});case 4:l=e.sent,l&&0==l.code?(u["a"].success("\u6dfb\u52a0\u6210\u529f\uff01"),a.handleSearch(),a.onCancelDebtClick(),a.fetchDebtTypeList()):u["a"].error(l.msg);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onAddDebtClick=C()(S.a.mark(function e(){var t;return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.currentSite,1!=Z["a"].company_type||t&&t.site_id){e.next=4;break}return h["a"].info({content:"\u8bf7\u5148\u9009\u62e9\u7ad9\u70b9"}),e.abrupt("return");case 4:a.setState({addDebtModalVisible:!0});case 5:case"end":return e.stop()}},e)})),a.onCancelDebtClick=C()(S.a.mark(function e(){return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addDebtModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onRowClick=function(e,t,a){},a.onRowDoubleClick=function(e,t,a){},a.onDebtUserScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchDebtUserList()},a.onDebtUserSearch=function(){var e=C()(S.a.mark(function e(t){return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t&&a.setState({currentDebtUserName:t});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onDebtUserBlur=function(e){for(var t,n=a.props,r=n.form,o=n.debt.debtUserList,l=a.state.currentDebtUserName,i=0;i<o.length;i++){var c=o[i];if(c.debtuser_name==l||c.debtuser_name==e||c.debtuser_id==e){t=c;break}}t||r.setFieldsValue({debtuser_id:l})},a.onDebtUserSelect=function(){},a.onSettleModal=function(){h["a"].confirm({title:"\u786e\u8ba4",content:"\u786e\u5b9a\u5c06\u52fe\u9009\u8bb0\u5f55\u5f52\u96f6\u5417\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:a.onSettleDebt})},a.onSettleDebt=C()(S.a.mark(function e(){var t,n,r,o;return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.debt_id}),e.next=5,t({type:"debt/settleDebtAction",payload:{debt_id:r}});case 5:o=e.sent,0==o.code?(u["a"].success("\u5f52\u96f6\u6210\u529f\uff01"),a.handleSearch()):u["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.tableFooter=function(){var e=a.props.debt,t=e.total,n=(e.totalDebtMoney,e.totalIncome),r=e.totalExpense;return console.log(a.props.debt,r),P.a.createElement("div",{className:U.a.tableFooter},P.a.createElement("span",null,"\u6536\u5165\u603b\u989d\uff1a",n||"0"),P.a.createElement("span",{className:U.a.footerSplit},"\u652f\u51fa\u603b\u989d\uff1a",r||"0"),P.a.createElement("span",{className:U.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return N()(t,e),O()(t,[{key:"componentDidMount",value:function(){var e=C()(S.a.mark(function e(){return S.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.fetchCompanySiteList(Z["a"].company_id);case 2:return e.next=4,this.fetchDebtUserList();case 4:return e.next=6,this.fetchDebtTypeList({});case 6:this.getOrderList();case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=(a.entrunkSiteList,a.normalSiteList,e.debt),r=n.debtTypes,o=n.debtUserList,l=this.state,i=(l.currentSite,l.currentDebtUserName,[Z["a"]]),c={};return i.length>0&&(c.initialValue=i[0].company_id||""),P.a.createElement(R["a"],{onSubmit:this.handleSearch,layout:"inline"},1==Z["a"].company_type&&P.a.createElement(Q,{label:"\u7ad9\u70b9"},t("site_id",{initialValue:Z["c"].site_id})(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSiteSelect,onChange:this.onSiteChange,style:{width:"100px"}},[Z["c"]].map(function(e){return P.a.createElement(X,{key:e.site_id,value:e.site_id},e.site_name)})))),P.a.createElement(Q,{label:"\u59d3\u540d"},t("debtuser_id")(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onDebtUserSelect,style:{width:"100px"},allowClear:!0,showSearch:!0,onBlur:this.onDebtUserBlur,onSearch:this.onDebtUserSearch,optionLabelProp:"children",onPopupScroll:this.onDebtUserScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},o.map(function(e){return P.a.createElement(X,{key:e.debtuser_id,value:e.debtuser_id},e.debtuser_name)})))),P.a.createElement(Q,{label:"\u65e5\u671f"},t("debt_date",{})(P.a.createElement(G,{style:{width:"250px"}}))),P.a.createElement(Q,{label:"\u5206\u7c7b"},t("debttype_id")(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},allowClear:!0},r.map(function(e){return P.a.createElement(X,{key:e.debttype_id,value:e.debttype_id},e.debttype)})))),P.a.createElement(Q,{label:"\u5f52\u96f6\u9879"},t("debt_status")(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"80px"},allowClear:!0},P.a.createElement(X,{value:0},"\u672a\u5f52\u96f6"),P.a.createElement(X,{value:1},"\u5df2\u5f52\u96f6")))),P.a.createElement(Q,null,P.a.createElement(v["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.debt,n=a.debtList,r=a.total,o=a.debtTypes,l=a.debtUserList,i=t.loading,c=this.state,s=c.selectedRows,u=c.current,p=c.pageSize,m=c.addDebtModalVisible,h=(c.record,!0);return["site_searchuser","site_admin"].indexOf(Z["b"].role_value)>=0&&(h=!1),P.a.createElement("div",null,P.a.createElement(d["a"],{bordered:!1},P.a.createElement("div",{className:U.a.tableList},P.a.createElement("div",{className:U.a.tableListForm},this.renderForm()),P.a.createElement("div",{className:U.a.tableListOperator},h&&P.a.createElement(v["a"],{icon:"plus",type:"primary",onClick:function(){return e.onAddDebtClick(!0)}},"\u6dfb\u52a0"),s.length>0&&h&&P.a.createElement("span",null,P.a.createElement(v["a"],{onClick:this.onSettleModal},"\u5f52\u96f6"))),P.a.createElement(q["a"],{selectedRows:s,loading:i,className:U.a.dataTable,scroll:{x:900,y:350},rowKey:"debt_id",data:{list:n,pagination:{total:r,pageSize:p,current:u,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,rowClassNameHandler:function(e,t){return 1===e.debt_status?U.a.payColor:""}})),this.tableFooter()),P.a.createElement(W,{modalVisible:m,addFormDataHandle:this.addFormDataHandle,onCancelHandler:this.onCancelDebtClick,selectedRows:s,debtTypes:o,onCustomerScroll:this.onGetDebtUserScroll,debtUserList:l}))}}]),t}(H["PureComponent"]),c=s))||c)||c);t["default"]=J},m8Tn:function(e,t,a){"use strict";a.r(t);var n=a("p0pE"),r=a.n(n),o=a("jehZ"),l=a.n(o),i=a("2Taf"),c=a.n(i),s=a("vZ4D"),d=a.n(s),u=a("l4Ni"),p=a.n(u),m=a("ujKo"),h=a.n(m),f=a("MhPg"),y=a.n(f),w=(a("B9cy"),a("Ol7k")),g=a("q1tI"),b=a.n(g),v=a("ZFw/"),x=a.n(v),S=a("Y+p1"),_=a.n(S),C=a("Wwog"),E=a("MuoO"),k=a("E6Dt"),L=a("TSYQ"),M=a.n(L),O=a("bALw"),D=a.n(O),V=a("lU33"),I=a("LLXN"),T=a("HZnN"),F=a("zwU1"),N=a.n(F),A=(a("Pwec"),a("CtXQ")),R=a("ggcP"),z=w["a"].Footer,H=function(){return b.a.createElement(z,{style:{padding:0,display:"none"}},b.a.createElement(R["a"],{links:[],copyright:b.a.createElement(g["Fragment"],null,"Copyright ",b.a.createElement(A["a"],{type:"copyright"})," 2019 \u8fdc\u8bda\u5b9d\u8def\u901a")}))},P=H,Y=(a("miYZ"),a("tsqr")),j=a("MFj2"),B=a("3a4m"),q=a.n(B),K=a("SQvw"),U=a.n(K),Z=a("wY1l"),G=a.n(Z),Q=a("fqkP"),X=a.n(Q),W=a("h3zL"),J=a.n(W),$=(a("lUTK"),a("BvKs")),ee=(a("+BJd"),a("mr32")),te=a("qIgq"),ae=a.n(te),ne=a("wd/R"),re=a.n(ne),oe=a("bt/X"),le=a.n(oe),ie=(a("Awhp"),a("KrTs")),ce=(a("T2oS"),a("W9HT")),se=(a("Znn+"),a("ZTPi")),de=a("i8i4"),ue=a.n(de),pe=a("+jAw"),me=(a("cWXX"),a("/ezw")),he=(a("Mwp2"),a("VXEj")),fe=(a("Telt"),a("Tckk")),ye=a("eHn4"),we=a.n(ye),ge=a("gWZ8"),be=a.n(ge),ve=a("BsfW"),xe=a.n(ve),Se=null;function _e(e){var t=e.data,a=void 0===t?[]:t,n=e.onClick,r=e.onClear,o=e.title,i=e.locale,c=e.emptyText,s=e.emptyImage,d=e.loading,u=e.onLoadMore,p=e.visible,m=e.loadedAll,h=void 0===m||m,f=e.scrollToLoad,y=void 0===f||f,w=e.showClear,g=void 0===w||w,v=e.skeletonCount,x=void 0===v?5:v,S=e.skeletonProps,_=void 0===S?{}:S;if(0===a.length)return b.a.createElement("div",{className:xe.a.notFound},s?b.a.createElement("img",{src:s,alt:"not found"}):null,b.a.createElement("div",null,c||i.emptyText));var C=Array.from({length:d?x:0}).map(function(){return{loading:d}}),E=h?b.a.createElement("div",{className:M()(xe.a.loadMore,xe.a.loadedAll)},b.a.createElement("span",null,i.loadedAll)):b.a.createElement("div",{className:xe.a.loadMore,onClick:u},b.a.createElement("span",null,i.loadMore)),k=function(e){if(y&&!d&&!h&&"function"===typeof u){var t=e.currentTarget;t.scrollHeight-t.scrollTop-t.clientHeight<=40&&(u(e),Se=t)}};if(!p&&Se)try{Se.scrollTo(null,0)}catch(e){Se=null}return b.a.createElement("div",null,b.a.createElement(he["a"],{className:xe.a.list,loadMore:E,onScroll:k},[].concat(be()(a),be()(C)).map(function(e,t){var a=M()(xe.a.item,we()({},xe.a.read,e.read)),r=e.avatar?"string"===typeof e.avatar?b.a.createElement(fe["a"],{className:xe.a.avatar,src:e.avatar}):b.a.createElement("span",{className:xe.a.iconElement},e.avatar):null;return b.a.createElement(he["a"].Item,{className:a,key:e.key||t,onClick:function(){return n(e)}},b.a.createElement(me["a"],l()({avatar:!0,title:!1,active:!0},_,{loading:e.loading}),b.a.createElement(he["a"].Item.Meta,{className:xe.a.meta,avatar:r,title:b.a.createElement("div",{className:xe.a.title},e.title,b.a.createElement("div",{className:xe.a.extra},e.extra)),description:b.a.createElement("div",null,b.a.createElement("div",{className:xe.a.description,title:e.description},e.description),b.a.createElement("div",{className:xe.a.datetime},e.datetime))})))})),g?b.a.createElement("div",{className:xe.a.clear,onClick:r},i.clear," ",o):null)}var Ce=a("btmg"),Ee=a.n(Ce),ke=se["a"].TabPane,Le=function(e){function t(){var e,a;c()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=p()(this,(e=h()(t)).call.apply(e,[this].concat(r))),a.state={visible:!1},a.onItemClick=function(e,t){var n=a.props.onItemClick,r=e.clickClose;n(e,t),r&&a.popover.click()},a.onClear=function(e){var t=a.props,n=t.onClear,r=t.clearClose;n(e),r&&a.popover.click()},a.onTabChange=function(e){var t=a.props.onTabChange;t(e)},a.onLoadMore=function(e,t){var n=a.props.onLoadMore;n(e,t)},a.handleVisibleChange=function(e){var t=a.props.onPopupVisibleChange;a.setState({visible:e}),t(e)},a}return y()(t,e),d()(t,[{key:"getNotificationBox",value:function(){var e=this,t=this.state.visible,a=this.props,n=a.children,r=a.loading,o=a.locale;if(!n)return null;var l=b.a.Children.map(n,function(a){var n=a.props,r=n.list,l=n.title,i=n.name,c=n.count,s=n.emptyText,d=n.emptyImage,u=n.showClear,p=n.loadedAll,m=n.scrollToLoad,h=n.skeletonCount,f=n.skeletonProps,y=n.loading,w=r&&r.length?r.length:0,g=c||0===c?c:w,v=g>0?"".concat(l," (").concat(g,")"):l;return b.a.createElement(ke,{tab:v,key:i},b.a.createElement(_e,{data:r,emptyImage:d,emptyText:s,loadedAll:p,loading:y,locale:o,onClear:function(){return e.onClear(i)},onClick:function(t){return e.onItemClick(t,a.props)},onLoadMore:function(t){return e.onLoadMore(a.props,t)},scrollToLoad:m,showClear:u,skeletonCount:h,skeletonProps:f,title:l,visible:t}))});return b.a.createElement(g["Fragment"],null,b.a.createElement(ce["a"],{spinning:r,delay:0},b.a.createElement(se["a"],{className:Ee.a.tabs,onChange:this.onTabChange},l)))}},{key:"render",value:function(){var e=this,t=this.props,a=t.className,n=t.count,r=t.popupVisible,o=t.bell,i=this.state.visible,c=M()(a,Ee.a.noticeButton),s=this.getNotificationBox(),d=o||b.a.createElement(A["a"],{type:"bell",className:Ee.a.icon}),u=b.a.createElement("span",{className:M()(c,{opened:i})},b.a.createElement(ie["a"],{count:n,style:{boxShadow:"none"},className:Ee.a.badge},d));if(!s)return u;var p={};return"popupVisible"in this.props&&(p.visible=r),b.a.createElement(pe["a"],l()({placement:"bottomRight",overlay:s,overlayClassName:Ee.a.popover,trigger:["click"],visible:i,onVisibleChange:this.handleVisibleChange},p,{ref:function(t){return e.popover=ue.a.findDOMNode(t)}}),u)}}]),t}(g["PureComponent"]);Le.Tab=ke,Le.defaultProps={onItemClick:function(){},onPopupVisibleChange:function(){},onTabChange:function(){},onClear:function(){},loading:!1,clearClose:!1,locale:{emptyText:"No notifications",clear:"Clear",loadedAll:"Loaded",loadMore:"Loading more"},emptyImage:"https://gw.alipayobjects.com/zos/rmsportal/wAhyIChODzsoKIOBHcBk.svg"};a("O3gP");var Me,Oe,De,Ve,Ie,Te,Fe,Ne,Ae=a("lrIw"),Re=(a("5NDa"),a("5rEg")),ze=a("Y/ft"),He=a.n(ze),Pe=(a("17x9"),a("UjoV")),Ye=a.n(Pe),je=a("G3lK"),Be=a.n(je),qe=(Me=Ye()(),Oe=X()(500,{leading:!0,trailing:!1}),Ie=Ve=function(e){function t(e){var a;return c()(this,t),a=p()(this,h()(t).call(this,e)),a.onKeyDown=function(e){if("Enter"===e.key){var t=a.props.onPressEnter,n=a.state.value;a.timeout=setTimeout(function(){t(n)},0)}},a.onChange=function(e){var t=a.props,n=t.onSearch,r=t.onChange;a.setState({value:e}),n&&n(e),r&&r(e)},a.enterSearchMode=function(){var e=a.props.onVisibleChange;e(!0),a.setState({searchMode:!0},function(){var e=a.state.searchMode;e&&a.input.focus()})},a.leaveSearchMode=function(){a.setState({searchMode:!1,value:""})},a.state={searchMode:e.defaultOpen,value:""},a}return y()(t,e),d()(t,null,[{key:"getDerivedStateFromProps",value:function(e){return"open"in e?{searchMode:e.open}:null}}]),d()(t,[{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"debouncePressEnter",value:function(){var e=this.props.onPressEnter,t=this.state.value;e(t)}},{key:"render",value:function(){var e=this,t=this.props,a=t.className,n=t.placeholder,r=(t.open,He()(t,["className","placeholder","open"])),o=this.state,i=o.searchMode,c=o.value;delete r.defaultOpen;var s=M()(Be.a.input,we()({},Be.a.show,i));return b.a.createElement("span",{className:M()(a,Be.a.headerSearch),onClick:this.enterSearchMode,onTransitionEnd:function(t){var a=t.propertyName;if("width"===a&&!i){var n=e.props.onVisibleChange;n(i)}}},b.a.createElement(A["a"],{type:"search",key:"Icon"}),b.a.createElement(Ae["a"],l()({key:"AutoComplete"},r,{className:s,value:c,onChange:this.onChange}),b.a.createElement(Re["a"],{ref:function(t){e.input=t},"aria-label":n,placeholder:n,onKeyDown:this.onKeyDown,onBlur:this.leaveSearchMode})))}}]),t}(g["PureComponent"]),Ve.defaultProps={defaultActiveFirstOption:!1,onPressEnter:function(){},onSearch:function(){},onChange:function(){},className:"",placeholder:"",dataSource:[],defaultOpen:!1,onVisibleChange:function(){}},De=Ie,U()(De.prototype,"debouncePressEnter",[Me,Oe],Object.getOwnPropertyDescriptor(De.prototype,"debouncePressEnter"),De.prototype),a("bfXr"),function(e){function t(){var e,a;c()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=p()(this,(e=h()(t)).call.apply(e,[this].concat(r))),a.getUnreadData=function(e){var t={};return Object.entries(e).forEach(function(e){var a=ae()(e,2),n=a[0],r=a[1];t[n]||(t[n]=0),Array.isArray(r)&&(t[n]=r.filter(function(e){return!e.read}).length)}),t},a.changeReadState=function(e){var t=e.id,n=a.props.dispatch;n({type:"global/changeNoticeReadState",payload:t})},a.fetchMoreNotices=function(e){var t=e.list,n=e.name,r=a.props,o=r.dispatch,l=r.notices,i=void 0===l?[]:l,c=i[i.length-1].id;o({type:"global/fetchMoreNotices",payload:{lastItemId:c,type:n,offset:t.length}})},a}return y()(t,e),d()(t,[{key:"getNoticeData",value:function(){var e=this.props.notices,t=void 0===e?[]:e;if(0===t.length)return{};var a=t.map(function(e){var t=r()({},e);if(t.datetime&&(t.datetime=re()(e.datetime).fromNow()),t.id&&(t.key=t.id),t.extra&&t.status){var a={todo:"",processing:"blue",urgent:"red",doing:"gold"}[t.status];t.extra=b.a.createElement(ee["a"],{color:a,style:{marginRight:0}},t.extra)}return t});return le()(a,"type")}},{key:"render",value:function(){var e=this.props,t=(e.currentUser,e.fetchingMoreNotices,e.fetchingNotices,e.loadedAllNotices,e.onNoticeVisibleChange,e.onMenuClick),a=(e.onNoticeClear,e.skeletonCount,e.theme),n=b.a.createElement($["a"],{className:J.a.menu,selectedKeys:[],onClick:t},b.a.createElement($["a"].Item,{key:"logout"},b.a.createElement(A["a"],{type:"logout"}),b.a.createElement(I["FormattedMessage"],{id:"menu.account.logout",defaultMessage:"\u9000\u51fa"}))),r=this.getNoticeData(),o=(this.getUnreadData(r),J.a.right);return"dark"===a&&(o="".concat(J.a.right,"  ").concat(J.a.dark)),b.a.createElement("div",{className:o},b.a.createElement(pe["a"],{overlay:n,placement:"bottomRight"},b.a.createElement("span",{className:J.a.rightMenu},b.a.createElement(A["a"],{type:"logout",title:Object(I["formatMessage"])({id:"navBar.lang"})}))))}}]),t}(g["PureComponent"])),Ke=(Te=X()(600),Ne=function(e){function t(){var e,a;c()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=p()(this,(e=h()(t)).call.apply(e,[this].concat(r))),a.toggle=function(){var e=a.props,t=e.collapsed,n=e.onCollapse;n(!t),a.triggerResizeEvent()},a}return y()(t,e),d()(t,[{key:"componentWillUnmount",value:function(){this.triggerResizeEvent.cancel()}},{key:"triggerResizeEvent",value:function(){var e=document.createEvent("HTMLEvents");e.initEvent("resize",!0,!1),window.dispatchEvent(e)}},{key:"render",value:function(){var e=this.props,t=e.collapsed,a=e.isMobile,n=e.logo,r=e.CacheSite,o=void 0===r?{}:r,l=e.CacheUser,i=void 0===l?{}:l;return b.a.createElement("div",{className:J.a.header},a&&b.a.createElement(G.a,{to:"/",className:J.a.logo,key:"logo"},b.a.createElement("img",{src:n,alt:"logo",width:"32"})),b.a.createElement("span",{className:J.a.trigger,onClick:this.toggle},b.a.createElement(A["a"],{type:t?"menu-unfold":"menu-fold"})),b.a.createElement("span",{className:J.a.navbar},o.site_name?"".concat(o.site_name,"\u2014\u2014"):"",i.user_name?i.user_name:""),b.a.createElement(qe,this.props))}}]),t}(g["PureComponent"]),Fe=Ne,U()(Fe.prototype,"triggerResizeEvent",[Te],Object.getOwnPropertyDescriptor(Fe.prototype,"triggerResizeEvent"),Fe.prototype),Fe),Ue=a("oFg3"),Ze=a("pMM0"),Ge=a("JwhZ"),Qe=a.n(Ge),Xe=function(e){function t(){var e,a;c()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=p()(this,(e=h()(t)).call.apply(e,[this].concat(r))),a.state={maxWidth:void 0},a}return y()(t,e),d()(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.theme,n=t.contentWidth,r=t.menuData,o=t.logo,i=this.state.maxWidth,c=Object(Ze["b"])(r);return b.a.createElement("div",{className:"".concat(Qe.a.head," ").concat("light"===a?Qe.a.light:"")},b.a.createElement("div",{ref:function(t){e.maim=t},className:"".concat(Qe.a.main," ").concat("Fixed"===n?Qe.a.wide:"")},b.a.createElement("div",{className:Qe.a.left},b.a.createElement("div",{className:Qe.a.logo,key:"logo",id:"logo"},b.a.createElement(G.a,{to:"/"},b.a.createElement("img",{src:o,alt:"logo"}),b.a.createElement("h1",null,"\u8fdc\u8bda\u5b9d\u8def\u901a"))),b.a.createElement("div",{style:{maxWidth:i}},b.a.createElement(Ue["default"],l()({},this.props,{flatMenuKeys:c,className:Qe.a.menu})))),b.a.createElement(qe,l()({},this.props,{className:Qe.a.rightMenu}))))}}],[{key:"getDerivedStateFromProps",value:function(e){return{maxWidth:("Fixed"===e.contentWidth?1200:window.innerWidth)-280-165-40}}}]),t}(g["PureComponent"]),We=a("IGtV"),Je=a.n(We),$e=w["a"].Header,et=function(e){function t(){var e,a;c()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=p()(this,(e=h()(t)).call.apply(e,[this].concat(r))),a.state={visible:!0},a.getHeadWidth=function(){var e=a.props,t=e.isMobile,n=e.collapsed,r=e.setting,o=r.fixedHeader,l=r.layout;return t||!o||"topmenu"===l?"100%":n?"calc(100% - 80px)":"calc(100% - 256px)"},a.handleNoticeClear=function(e){Y["a"].success("".concat(Object(I["formatMessage"])({id:"component.noticeIcon.cleared"})," ").concat(Object(I["formatMessage"])({id:"component.globalHeader.".concat(e)})));var t=a.props.dispatch;t({type:"global/clearNotices",payload:e})},a.handleMenuClick=function(e){var t=e.key,n=a.props.dispatch;"userCenter"!==t?"triggerError"!==t?"userinfo"!==t?"logout"===t&&n({type:"login/logout"}):q.a.push("/account/settings/base"):q.a.push("/exception/trigger"):q.a.push("/account/center")},a.handleNoticeVisibleChange=function(e){if(e){var t=a.props.dispatch;t({type:"global/fetchNotices"})}},a.handScroll=function(){var e=a.props.autoHideHeader,t=a.state.visible;if(e){var n=document.body.scrollTop+document.documentElement.scrollTop;a.ticking||(a.ticking=!0,requestAnimationFrame(function(){a.oldScrollTop>n?a.setState({visible:!0}):n>300&&t?a.setState({visible:!1}):n<300&&!t&&a.setState({visible:!0}),a.oldScrollTop=n,a.ticking=!1}))}},a}return y()(t,e),d()(t,[{key:"componentDidMount",value:function(){document.addEventListener("scroll",this.handScroll,{passive:!0})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("scroll",this.handScroll)}},{key:"render",value:function(){var e=this.props,t=e.isMobile,a=e.handleMenuCollapse,n=e.setting,r=n.navTheme,o=n.layout,i=n.fixedHeader,c=this.state.visible,s="topmenu"===o,d=this.getHeadWidth(),u=c?b.a.createElement($e,{style:{padding:0,width:d},className:i?Je.a.fixedHeader:""},s&&!t?b.a.createElement(Xe,l()({theme:r,mode:"horizontal",onCollapse:a,onNoticeClear:this.handleNoticeClear,onMenuClick:this.handleMenuClick,onNoticeVisibleChange:this.handleNoticeVisibleChange},this.props)):b.a.createElement(Ke,l()({onCollapse:a,onNoticeClear:this.handleNoticeClear,onMenuClick:this.handleMenuClick,onNoticeVisibleChange:this.handleNoticeVisibleChange},this.props))):null;return b.a.createElement(j["a"],{component:"",transitionName:"fade"},u)}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.autoHideHeader||t.visible?null:{visible:!0}}}]),t}(g["PureComponent"]),tt=Object(E["connect"])(function(e){var t=e.user,a=e.global,n=e.setting,r=e.loading;return{currentUser:t.currentUser,collapsed:a.collapsed,fetchingMoreNotices:r.effects["global/fetchMoreNotices"],fetchingNotices:r.effects["global/fetchNotices"],loadedAllNotices:a.loadedAllNotices,notices:a.notices,setting:n}})(et),at=a("R1Dz"),nt=a("Y5yc"),rt=a("xqX8"),ot=(a("bbsP"),a("/wGt")),lt=a("mR0u"),it=a.n(lt),ct=b.a.lazy(function(){return Promise.resolve().then(a.bind(null,"oFg3"))}),st=w["a"].Sider,dt=function(e){function t(e){var a;return c()(this,t),a=p()(this,h()(t).call(this,e)),a.isMainMenu=function(e){var t=a.props.menuData;return t.some(function(t){return!!e&&(t.key===e||t.path===e)})},a.handleOpenChange=function(e){var t=e.filter(function(e){return a.isMainMenu(e)}).length>1;a.setState({openKeys:t?[e.pop()]:be()(e)})},a.state={openKeys:Object(Ze["a"])(e)},a}return y()(t,e),d()(t,[{key:"render",value:function(){var e,t=this.props,a=t.logo,n=t.collapsed,r=t.onCollapse,o=t.fixSiderbar,i=t.theme,c=this.state.openKeys,s=n?{}:{openKeys:c},d=M()(it.a.sider,(e={},we()(e,it.a.fixSiderbar,o),we()(e,it.a.light,"light"===i),e));return b.a.createElement(st,{trigger:null,collapsible:!0,collapsed:n,breakpoint:"lg",onCollapse:r,width:256,theme:i,className:d},b.a.createElement("div",{className:it.a.logo,id:"logo"},b.a.createElement(G.a,{to:"/"},b.a.createElement("img",{src:a,alt:"logo"}),b.a.createElement("h1",null,"\u8fdc\u8bda\u5b9d\u8def\u901a"))),b.a.createElement(g["Suspense"],{fallback:b.a.createElement(rt["default"],null)},b.a.createElement(ct,l()({},this.props,{mode:"inline",handleOpenChange:this.handleOpenChange,onOpenChange:this.handleOpenChange,style:{padding:"16px 0",width:"100%"}},s))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=t.pathname;return e.location.pathname!==a?{pathname:e.location.pathname,openKeys:Object(Ze["a"])(e)}:null}}]),t}(g["PureComponent"]),ut=b.a.memo(function(e){var t=e.isMobile,a=e.menuData,n=e.collapsed,r=e.onCollapse,o=Object(Ze["b"])(a);return t?b.a.createElement(ot["a"],{visible:!n,placement:"left",onClose:function(){return r(!0)},style:{padding:0,height:"100vh"}},b.a.createElement(dt,l()({},e,{flatMenuKeys:o,collapsed:!t&&n}))):b.a.createElement(dt,l()({},e,{flatMenuKeys:o}))}),pt=ut,mt=a("T+dw"),ht=a("XS0u"),ft=a("W660"),yt=a.n(ft),wt=(b.a.lazy(function(){return Promise.all([a.e(0),a.e(10)]).then(a.bind(null,"PceP"))}),w["a"].Content),gt={"screen-xs":{maxWidth:575},"screen-sm":{minWidth:576,maxWidth:767},"screen-md":{minWidth:768,maxWidth:991},"screen-lg":{minWidth:992,maxWidth:1199},"screen-xl":{minWidth:1200,maxWidth:1599},"screen-xxl":{minWidth:1600}},bt=function(e){function t(e){var a;return c()(this,t),a=p()(this,h()(t).call(this,e)),a.matchParamsPath=function(e,t){var a=Object.keys(t).find(function(t){return D()(t).test(e)});return t[a]},a.getRouterAuthority=function(e,t){var a=["noAuthority"],n=function e(t,n){return n.forEach(function(n){return n.path&&D()(n.path).test(t)?a=n.authority:n.routes&&(a=e(t,n.routes)),n}),a};return n(e,t)},a.getPageTitle=function(e,t){var n=a.matchParamsPath(e,t);if(!n)return mt["title"];var r=mt["menu"].disableLocal?n.name:Object(I["formatMessage"])({id:n.locale||n.name,defaultMessage:n.name});return"".concat(r," - ").concat(mt["title"])},a.getLayoutStyle=function(){var e=a.props,t=e.fixSiderbar,n=e.isMobile,r=e.collapsed,o=e.layout;return t&&"topmenu"!==o&&!n?{paddingLeft:r?"80px":"256px"}:null},a.handleMenuCollapse=function(e){var t=a.props.dispatch;t({type:"global/changeLayoutCollapsed",payload:e})},a.renderSettingDrawer=function(){return null},a.getPageTitle=Object(C["a"])(a.getPageTitle),a.matchParamsPath=Object(C["a"])(a.matchParamsPath,_.a),a}return y()(t,e),d()(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.dispatch,a=e.route,n=a.routes,r=a.authority;t({type:"setting/getSetting"}),t({type:"menu/getMenuData",payload:{routes:n,authority:r}}),t({type:"comapny/getCompanyList",payload:{}})}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.collapsed,n=t.isMobile;!n||e.isMobile||a||this.handleMenuCollapse(!1)}},{key:"getContext",value:function(){var e=this.props,t=e.location,a=e.breadcrumbNameMap;return{location:t,breadcrumbNameMap:a}}},{key:"render",value:function(){var e=this,t=this.props,a=t.navTheme,n=t.layout,o=t.children,i=t.location.pathname,c=t.isMobile,s=t.menuData,d=t.breadcrumbNameMap,u=t.route.routes,p=t.fixedHeader,m="topmenu"===n,h=this.getRouterAuthority(i,u),f=p?{}:{paddingTop:0},y=b.a.createElement(w["a"],null,m&&!c?null:b.a.createElement(pt,l()({logo:N.a,theme:a,onCollapse:this.handleMenuCollapse,menuData:s,isMobile:c},this.props)),b.a.createElement(w["a"],{style:r()({},this.getLayoutStyle(),{minHeight:"100vh"})},b.a.createElement(tt,l()({menuData:s,handleMenuCollapse:this.handleMenuCollapse,logo:N.a,isMobile:c,CacheSite:ht["c"],CacheUser:ht["d"]},this.props)),b.a.createElement(wt,{className:yt.a.content,style:f},b.a.createElement(T["a"],{authority:h,noMatch:b.a.createElement(nt["default"],null)},o)),b.a.createElement(P,null)));return b.a.createElement(b.a.Fragment,null,b.a.createElement(x.a,{title:this.getPageTitle(i,d)},b.a.createElement(k["ContainerQuery"],{query:gt},function(t){return b.a.createElement(at["a"].Provider,{value:e.getContext()},b.a.createElement("div",{className:M()(t)},y))})),b.a.createElement(g["Suspense"],{fallback:b.a.createElement(rt["default"],null)},this.renderSettingDrawer()))}}]),t}(b.a.PureComponent);t["default"]=Object(E["connect"])(function(e){var t=e.global,a=e.setting,n=e.company,o=e.menu;return r()({collapsed:t.collapsed,layout:a.layout,menuData:o.menuData,breadcrumbNameMap:o.breadcrumbNameMap},a,{branchCompanyList:n.branchCompanyList})})(function(e){return b.a.createElement(V["a"],{query:"(max-width: 599px)"},function(t){return b.a.createElement(bt,l()({},e,{isMobile:t}))})})},mR0u:function(e,t,a){e.exports={logo:"antd-pro-components-sider-menu-index-logo",sider:"antd-pro-components-sider-menu-index-sider",fixSiderbar:"antd-pro-components-sider-menu-index-fixSiderbar",light:"antd-pro-components-sider-menu-index-light",icon:"antd-pro-components-sider-menu-index-icon"}},mwKL:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d,u,p,m=a("bx4M"),h=(a("miYZ"),a("tsqr")),f=a("p0pE"),y=a.n(f),w=a("d6i3"),g=a.n(w),b=a("1l/V"),v=a.n(b),x=(a("+BJd"),a("mr32")),S=(a("2qtc"),a("kLXV")),_=(a("14J3"),a("BMrR")),C=(a("jCWc"),a("kPKH")),E=a("jehZ"),k=a.n(E),L=(a("5NDa"),a("5rEg")),M=(a("+L6B"),a("2/Rp")),O=(a("O3gP"),a("lrIw")),D=a("2Taf"),V=a.n(D),I=a("vZ4D"),T=a.n(I),F=a("l4Ni"),N=a.n(F),A=a("ujKo"),R=a.n(A),z=a("MhPg"),H=a.n(z),P=(a("OaEy"),a("2fM7")),Y=(a("y8nQ"),a("Vl3Y")),j=(a("iQDF"),a("+eQT")),B=a("q1tI"),q=a.n(B),K=a("MuoO"),U=a("wd/R"),Z=a.n(U),G=a("B797"),Q=a("CkN6"),X=a("mzDP"),W=a.n(X),J=(a("S+eF"),a("XS0u")),$=j["a"].RangePicker,ee=Y["a"].Item,te=P["a"].Option,ae=(n=Y["a"].create(),n((o=function(e){function t(e){var a;return V()(this,t),a=N()(this,R()(t).call(this,e)),a.onAbnormalSelect=function(e,t){console.log("####",t.props.abnormal_type_id),a.setState({abnormal_type_id:t.props.abnormal_type_id,abnormal_type:t.props.text}),console.log(e,t),console.log(a.state)},a.onAddHandler=function(){var e=a.props,t=e.addFormDataHandle,n=e.form;n.validateFields(function(e,a){console.log(a),e||t({transfer_money:a.transfer_money,transfer_type:0,transfer_user:a.transfer_user,remark:a.remark})})},a.renderCustomerOption=function(e){var t=O["a"].Option;return q.a.createElement(t,{key:e.incometype_id,incometype_id:e.incometype_id,text:e.incometype},e.incometype)},a.state={abnormal_type_id:"",abnormal_type:""},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return H()(t,e),T()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelHandler,n=(e.selectedRows,e.form);e.incomeTypes;return q.a.createElement(S["a"],{destroyOnClose:!0,title:"\u6dfb\u52a0\u6253\u6b3e",visible:t,onCancel:function(){return a()},footer:[q.a.createElement(M["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),q.a.createElement(M["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:W.a.modalForm},q.a.createElement(Y["a"],null,q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],null,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u6253\u6b3e\u91d1\u989d"}),n.getFieldDecorator("transfer_money",{initialValue:"",rules:[{required:!0,message:"\u8bf7\u586b\u5199\u6253\u6b3e\u91d1\u989d"}]})(q.a.createElement(L["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],null,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u6253\u6b3e\u4eba"}),n.getFieldDecorator("transfer_user",{initialValue:""})(q.a.createElement(L["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],null,q.a.createElement(ee,{labelCol:{span:3,offset:2},label:"\u5907\u6ce8"},n.getFieldDecorator("remark",{initialValue:""})(q.a.createElement(L["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}})))))))}}]),t}(B["PureComponent"]),r=o))||r),ne=(l=Y["a"].create(),l((c=function(e){function t(e){var a;return V()(this,t),a=N()(this,R()(t).call(this,e)),a.okHandle=function(){var e=a.props,t=e.form,n=e.record,r=e.onUpdateOrder;t.validateFields(function(e,a){e||(t.resetFields(),r(n,a))})},a.formItemLayout={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},a.formItemSmallLayout={labelCol:{xs:{span:25},sm:{span:9}},wrapperCol:{xs:{span:23},sm:{span:15}}},a.colLayout={md:8,sm:24},a.colSmallLayout={md:4,sm:20},a.col2Layout={md:10,sm:26},a.colLargeLayout={md:16,sm:32},a.formItemMiniLayout={labelCol:{xs:{span:22},sm:{span:6}},wrapperCol:{xs:{span:26},sm:{span:18}}},a.formLayout={labelCol:{span:7},wrapperCol:{span:13}},a}return H()(t,e),T()(t,[{key:"render",value:function(){var e=this.props,t=e.record,a=e.modalVisible,n=e.onCancelModal,r=e.form;return q.a.createElement(S["a"],{destroyOnClose:!0,title:"\u7f16\u8f91\u6258\u8fd0\u5355",visible:a,onCancel:function(){return n()},footer:[q.a.createElement(M["a"],{key:"btn-cancel",onClick:function(){return n()}},"\u53d6 \u6d88"),q.a.createElement(M["a"],{key:"btn-print",onClick:this.onOrderPrint},"\u6253 \u5370"),q.a.createElement(M["a"],{key:"btn-save",type:"primary",onClick:this.okHandle},"\u4fdd \u5b58")],width:800,className:W.a.modalForm},q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u5206\u516c\u53f8"}),t.company_name)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u7ad9\u70b9"}),t.site_name))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u6536\u8d27\u4eba\u7535\u8bdd"}),t.getcustomer_mobile)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u6536\u8d27\u4eba\u59d3\u540d"}),t.getcustomer_name)),q.a.createElement(C["a"],null,1==t.customer_type?q.a.createElement(x["a"],{color:"orange",style:{marginTop:10}},"VIP"):"")),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u53d1\u8d27\u4eba\u7535\u8bdd"}),t.sendcustomer_mobile)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u53d1\u8d27\u4eba\u59d3\u540d"}),t.sendcustomer_name))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.colLayout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u8fd0\u8d39"}),t.trans_amount)),q.a.createElement(C["a"],this.colSmallLayout,q.a.createElement(ee,{label:""},1==t.trans_type?"\u73b0\u4ed8":"\u56de\u4ed8")),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u6298\u540e\u8fd0\u8d39"}),t.trans_discount))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.colLayout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u8d27\u6b3e"}),t.order_amount)),q.a.createElement(C["a"],this.colLayout,q.a.createElement(ee,{label:""},t.bank_account))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4fdd\u4ef7\u91d1\u989d"}),t.insurance_amount)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4fdd\u4ef7\u8d39"}),t.insurance_fee))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u9001\u8d27\u8d39"}),t.deliver_amount)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u57ab\u4ed8\u91d1\u989d"}),t.order_advancepay_amount))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.colLargeLayout,q.a.createElement(ee,k()({},this.formItemMiniLayout,{label:"\u8d27\u7269\u540d\u79f0"}),t.order_name)),q.a.createElement(C["a"],this.colSmallLayout,q.a.createElement(ee,k()({},this.formItemLayout,{label:""}),t.order_num))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u8f6c\u8fdb/\u8f6c\u51fa"}),1==t.transfer_type?"\u8f6c\u51fa":"\u8f6c\u5165")),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u8d39"}),t.transfer_amount))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u5730\u5740"}),t.transfer_address)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u7269\u6d41"}),t.transfer_company_name))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u5355\u53f7"}),t.transfer_order_code)),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u7535\u8bdd"}),t.transfer_company_mobile))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u5b9e\u6536\u8d27\u6b3e"}),r.getFieldDecorator("order_real",{initialValue:t.order_real})(q.a.createElement(L["a"],{placeholder:"\u8bf7\u8f93\u5165"})))),q.a.createElement(C["a"],this.col2Layout,q.a.createElement(ee,k()({},this.formItemLayout,{label:"\u5b9e\u6536\u8fd0\u8d39"}),r.getFieldDecorator("trans_real",{initialValue:t.trans_real})(q.a.createElement(L["a"],{placeholder:"\u8bf7\u8f93\u5165"}))))),q.a.createElement(_["a"],{gutter:{md:8,lg:24,xl:48}},q.a.createElement(C["a"],this.colLargeLayout,q.a.createElement(ee,k()({},this.formItemMiniLayout,{label:"\u5907\u6ce8"}),r.getFieldDecorator("remark",{initialValue:t.remark})(q.a.createElement(L["a"],{placeholder:"\u8bf7\u8f93\u5165"}))))))}}]),t}(B["PureComponent"]),i=c))||i),re=(s=Object(K["connect"])(function(e){var t=e.customer,a=e.company,n=e.transfer,r=e.site,o=e.car,l=e.receiver,i=e.loading;return{customer:t,company:a,transfer:n,site:r,car:o,receiver:l,loading:i.models.rule}}),d=Y["a"].create(),s(u=d((p=function(e){function t(){var e,a;V()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=N()(this,(e=R()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},current:1,pageSize:20,record:{},currentSite:{},orderModalVisible:!1,settleModalVisible:!1,cancelConfirmTransferModalVisible:!1,delTransferModalVisible:!1,addIncomeModalVisible:!1,signModalVisible:!1,cancelSignModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1},a.columns=[{title:"\u6253\u6b3e\u65e5\u671f",dataIndex:"transfer_date",render:function(e){return q.a.createElement("span",null,e&&Z()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"170px"},{title:"\u6253\u6b3e\u91d1\u989d",dataIndex:"transfer_money",width:"80px"},{title:"\u6253\u6b3e\u4eba",dataIndex:"transfer_user",width:"80px"},{title:"\u786e\u8ba4\u4eba",dataIndex:"confirm_operator_name",width:"80px"},{title:"\u786e\u8ba4\u65e5\u671f",dataIndex:"confirm_date",render:function(e){return q.a.createElement("span",null,e&&Z()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"170px"},{title:"\u7ad9\u70b9",dataIndex:"site_name",width:"80px"},{title:"\u6253\u6b3e\u516c\u53f8",dataIndex:"company_name",width:"80px"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchIncomeTypeList=function(){var e=v()(g.a.mark(function e(t){var n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=t.companyId,r=t.siteId,o=a.props.dispatch,o({type:"income/getIncomeTypesAction",payload:{company_id:n,site_id:r}});case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchCompanySiteList=function(){var e=v()(g.a.mark(function e(t){var n;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchGetCustomerList=function(){var e=v()(g.a.mark(function e(t){var n;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.onSiteSelect=function(){var e=v()(g.a.mark(function e(t,n){var r,o,l;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.site.siteList,o=void 0===r?[]:r,l=o.filter(function(e){if(e.site_id==t)return e}),l.length>0&&a.setState({currentSite:l[0]});case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){n.transfer_date&&n.transfer_date.length>0&&(n.transfer_date=n.transfer_date.map(function(e){return"".concat(e.valueOf())})),n.company_id=J["a"].company_id;var o=Object.assign({filter:n},e);r({type:"transfer/getTransferAction",payload:y()({pageNo:t||i,pageSize:c},o)}),r({type:"transfer/getTransferStatisticAction",payload:y()({},o)})}})},a.handleStandardTableChange=function(){var e=v()(g.a.mark(function e(t,n,r){var o,l,i;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(o=a.state.pageSize,l={},i=1,r.field&&(l={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==o){e.next=10;break}return i=1,e.next=8,a.setState({pageSize:t.pageSize});case 8:e.next=11;break;case 10:t&&t.current&&(i=t.current);case 11:return e.next=13,a.setState({current:i});case 13:a.getOrderList(l,i);case 14:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.addFormDataHandle=function(){var e=v()(g.a.mark(function e(t){var n,r,o,l;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.currentSite,o=void 0===r?{}:r,e.next=4,n({type:"transfer/addTransferAction",payload:y()({},t,{company_id:J["a"].company_id,company_name:J["a"].company_name,site_id:o.site_id,site_name:o.site_name})});case 4:l=e.sent,0==l.code?(h["a"].success("\u6dfb\u52a0\u6210\u529f\uff01"),a.handleSearch(),a.onCancelIncomeClick()):h["a"].error(l.msg);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onAddIncomeClick=v()(g.a.mark(function e(){var t,n;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.currentSite,n=void 0===t?{}:t,1!=J["a"].company_id||n.site_id){e.next=4;break}return S["a"].info({content:"\u8bf7\u5148\u9009\u62e9\u7ad9\u70b9"}),e.abrupt("return");case 4:a.setState({addIncomeModalVisible:!0});case 5:case"end":return e.stop()}},e)})),a.onCancelIncomeClick=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addIncomeModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onConfirmTransfer=v()(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.selectedRows,n=t.filter(function(e){return 1==e.transfer_type}),!(n.length>0)){e.next=5;break}return S["a"].info({content:"\u5df2\u7ecf\u786e\u8ba4\u7684\u6253\u6b3e\u4e0d\u80fd\u91cd\u590d\u786e\u8ba4\uff01"}),e.abrupt("return");case 5:r=Object(G["a"])(t),a.setState({accountStatistic:r,settleModalVisible:!0});case 7:case"end":return e.stop()}},e)})),a.onSettleCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({settleModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettleOk=v()(g.a.mark(function e(){var t,n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.transfer_id}),e.next=5,t({type:"transfer/confirmTransferAction",payload:{transfer_id:r}});case 5:o=e.sent,0==o.code?(h["a"].success("\u786e\u8ba4\u6253\u6b3e\u6210\u529f\uff01"),a.onSettleCancel()):h["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onCancelConfirmTransfer=v()(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.selectedRows,n=t.filter(function(e){return 0==e.transfer_type}),!(n.length>0)){e.next=5;break}return S["a"].info({content:"\u672a\u786e\u8ba4\u7684\u6253\u6b3e\u4e0d\u80fd\u53d6\u6d88\u786e\u8ba4\uff01"}),e.abrupt("return");case 5:r=Object(G["a"])(t),a.setState({accountStatistic:r,cancelConfirmTransferModalVisible:!0});case 7:case"end":return e.stop()}},e)})),a.onCancelConfirmTransferCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelConfirmTransferModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelConfirmTransferOk=v()(g.a.mark(function e(){var t,n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.transfer_id}),e.next=5,t({type:"transfer/cancelConfirmTransferAction",payload:{transfer_id:r}});case 5:o=e.sent,0==o.code?(h["a"].success("\u53d6\u6d88\u786e\u8ba4\u6253\u6b3e\u6210\u529f\uff01"),a.onCancelConfirmTransferCancel()):h["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onDelTransfer=v()(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.selectedRows,n=t.filter(function(e){return 1==e.transfer_type}),!(n.length>0)){e.next=5;break}return S["a"].info({content:"\u5df2\u7ecf\u786e\u8ba4\u7684\u6253\u6b3e\u4e0d\u80fd\u5220\u9664\uff01"}),e.abrupt("return");case 5:r=Object(G["a"])(t),a.setState({accountStatistic:r,delTransferModalVisible:!0});case 7:case"end":return e.stop()}},e)})),a.onDelConfirmTransferCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({delTransferModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDelConfirmTransferOk=v()(g.a.mark(function e(){var t,n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.transfer_id}),e.next=5,t({type:"transfer/delTransferAction",payload:{transfer_id:r}});case 5:o=e.sent,0==o.code?(h["a"].success("\u5220\u9664\u786e\u8ba4\u6253\u6b3e\u6210\u529f\uff01"),a.onDelConfirmTransferCancel()):h["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onCancelSign=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelSignModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onCancelSignCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelSignModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelSignOk=v()(g.a.mark(function e(){var t,n,r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"settle/cancelSignAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(h["a"].success("\u53d6\u6d88\u7b7e\u5b57\u6210\u529f\uff01"),a.handleSearch(),a.onCancelSignCancel()):h["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onPrint=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=v()(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"settle/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(h["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):h["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=v()(g.a.mark(function e(){var t,n,r;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"settle/downloadAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(h["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):h["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onEntrunkModalShow=function(){a.setState({orderModalVisible:!0})},a.onEntrunkModalCancel=function(){a.setState({orderModalVisible:!1})},a.onUpdateOrder=function(){var e=v()(g.a.mark(function e(t,n){var r,o;return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.props.dispatch,e.next=3,r({type:"order/updateOrderAction",payload:{orderIds:[t.order_id],order:{trans_real:n.trans_real,order_real:n.order_real}}});case 3:o=e.sent,0==o.code?(h["a"].success("\u4fee\u6539\u6210\u529f\uff01"),a.onEntrunkModalCancel()):h["a"].error(o.msg);case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onRowClick=function(e,t,a){},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onEntrunkModalShow()},a.tableFooter=function(){var e=a.props.transfer,t=e.total,n=e.totalTransferAmount,r=e.totalTransferConfirmAmount,o=e.totalTransferUnConfirmAmount,l=e.totalShouldTransfer;return q.a.createElement("div",{className:W.a.tableFooter},q.a.createElement("span",null,"\u6253\u6b3e\u603b\u989d\uff1a",n||0),q.a.createElement("span",{className:W.a.footerSplit},"\u672a\u786e\u8ba4\u6253\u6b3e\u603b\u989d\uff1a",o||0),q.a.createElement("span",{className:W.a.footerSplit},"\u5df2\u786e\u8ba4\u6253\u6b3e\u603b\u989d\uff1a",r||0),q.a.createElement("span",{className:W.a.footerSplit},"\u5e94\u6253\u6b3e\u603b\u989d\uff1a",l||0),q.a.createElement("span",{className:W.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return H()(t,e),T()(t,[{key:"componentDidMount",value:function(){var e=v()(g.a.mark(function e(){return g.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.props.dispatch,this.fetchCompanySiteList(J["a"].company_id),this.setState({currentSite:J["c"]}),this.handleSearch();case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site.siteList,n=void 0===a?[]:a,r=e.company.branchCompanyList,o=void 0===r?[]:r,l={};return o.length>0&&(l.initialValue=o[0].company_id||""),q.a.createElement(Y["a"],{onSubmit:this.handleSearch,layout:"inline"},q.a.createElement(ee,{label:"\u7ad9\u70b9"},t("site_id",{initialValue:J["c"].site_id})(q.a.createElement(P["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},onSelect:this.onSiteSelect,allowClear:"site_pay"==J["b"].role_value},("site_pay"==J["b"].role_value?n:[J["c"]]).map(function(e){return q.a.createElement(te,{key:e.site_id,value:e.site_id},e.site_name)})))),q.a.createElement(ee,{label:"\u786e\u8ba4\u6253\u6b3e"},t("transfer_type",{initialValue:"0"})(q.a.createElement(P["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},allowClear:!0},q.a.createElement(te,{value:"1"},"\u5df2\u786e\u8ba4\u6253\u6b3e"),q.a.createElement(te,{value:"0"},"\u672a\u786e\u8ba4\u6253\u6b3e")))),q.a.createElement(ee,{label:"\u6253\u6b3e\u65e5\u671f"},t("transfer_date",{})(q.a.createElement($,{style:{width:"250px"}}))),q.a.createElement(ee,null,q.a.createElement(M["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.transfer,n=a.transferList,r=a.total,o=t.loading,l=this.state,i=l.selectedRows,c=(l.accountStatistic,l.current),s=l.pageSize,d=l.orderModalVisible,u=l.settleModalVisible,p=l.cancelConfirmTransferModalVisible,h=l.delTransferModalVisible,f=l.addIncomeModalVisible,y=l.signModalVisible,w=l.cancelSignModalVisible,g=l.downloadModalVisible,b=l.printModalVisible,v=l.record,x=!1;["site_pay"].indexOf(J["b"].role_value)>=0&&(x=!0);var _=!0;return["site_searchuser","site_pay"].indexOf(J["b"].role_value)>=0&&(_=!1),q.a.createElement("div",null,q.a.createElement(m["a"],{bordered:!1},q.a.createElement("div",{className:W.a.tableList},q.a.createElement("div",{className:W.a.tableListForm},this.renderForm()),q.a.createElement("div",{className:W.a.tableListOperator},_&&q.a.createElement(M["a"],{icon:"plus",type:"primary",onClick:function(){return e.onAddIncomeClick(!0)}},"\u6dfb\u52a0"),i.length>0&&x&&q.a.createElement("div",null,q.a.createElement(M["a"],{onClick:this.onConfirmTransfer},"\u6253\u6b3e\u786e\u8ba4"),q.a.createElement(M["a"],{onClick:this.onCancelConfirmTransfer},"\u53d6\u6d88\u786e\u8ba4")),i.length>0&&_&&q.a.createElement(M["a"],{onClick:this.onDelTransfer},"\u5220\u9664\u6253\u6b3e")),q.a.createElement(Q["a"],{selectedRows:i,loading:o,className:W.a.dataTable,scroll:{x:900,y:350},rowKey:"transfer_id",data:{list:n,pagination:{total:r,pageSize:s,current:c,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,rowClassNameHandler:function(e,t){if(1===e.transfer_type)return W.a.payColor}})),this.tableFooter()),q.a.createElement(ne,{modalVisible:d,record:v,onCancelModal:this.onEntrunkModalCancel,onUpdateOrder:this.onUpdateOrder}),q.a.createElement(ae,{modalVisible:f,addFormDataHandle:this.addFormDataHandle,onCancelHandler:this.onCancelIncomeClick,selectedRows:i}),q.a.createElement(S["a"],{title:"\u786e\u8ba4\u6253\u6b3e",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:u,onOk:this.onSettleOk,onCancel:this.onSettleCancel},q.a.createElement("p",null,"\u60a8\u786e\u5b9a\u8981\u5bf9".concat(i.length,"\u6761\u8bb0\u5f55\u786e\u8ba4\u6253\u6b3e\u4e48\uff1f "))),q.a.createElement(S["a"],{title:"\u53d6\u6d88\u786e\u8ba4\u6253\u6b3e",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:p,onOk:this.onCancelConfirmTransferOk,onCancel:this.onCancelConfirmTransferCancel},q.a.createElement("p",null,"\u60a8\u786e\u5b9a\u8981\u5bf9".concat(i.length,"\u6761\u8bb0\u5f55\u53d6\u6d88\u786e\u8ba4\u6253\u6b3e\u4e48\uff1f "))),q.a.createElement(S["a"],{title:"\u5220\u9664\u786e\u8ba4\u6253\u6b3e",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:h,onOk:this.onDelConfirmTransferOk,onCancel:this.onDelConfirmTransferCancel},q.a.createElement("p",null,"\u60a8\u786e\u5b9a\u8981\u5220\u9664".concat(i.length,"\u6761\u786e\u8ba4\u6253\u6b3e\u8bb0\u5f55\u4e48\uff1f "))),q.a.createElement(S["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:y,onOk:this.onSignOk,onCancel:this.onSignCancel},q.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7b7e\u5b57\u4e48\uff1f")),q.a.createElement(S["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:w,onOk:this.onCancelSignOk,onCancel:this.onCancelSignCancel},q.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u7b7e\u5b57\u4e48\uff1f")),q.a.createElement(S["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:b,onOk:this.onPrintOk,onCancel:this.onPrintCancel},q.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),q.a.createElement(S["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:g,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},q.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(B["PureComponent"]),u=p))||u)||u);t["default"]=re},mzDP:function(e,t,a){e.exports={"antd-pro-components-global-header-index-header":"antd-pro-pages-transfer-transfer-antd-pro-components-global-header-index-header",tableList:"antd-pro-pages-transfer-transfer-tableList",tableListOperator:"antd-pro-pages-transfer-transfer-tableListOperator",tableFooter:"antd-pro-pages-transfer-transfer-tableFooter",footerSplit:"antd-pro-pages-transfer-transfer-footerSplit",signColor:"antd-pro-pages-transfer-transfer-signColor",settleColor:"antd-pro-pages-transfer-transfer-settleColor",payColor:"antd-pro-pages-transfer-transfer-payColor",selectedColor:"antd-pro-pages-transfer-transfer-selectedColor",tableDetail:"antd-pro-pages-transfer-transfer-tableDetail",modalForm:"antd-pro-pages-transfer-transfer-modalForm",formItemFloat:"antd-pro-pages-transfer-transfer-formItemFloat",tableListForm:"antd-pro-pages-transfer-transfer-tableListForm",submitButtons:"antd-pro-pages-transfer-transfer-submitButtons",dataTable:"antd-pro-pages-transfer-transfer-dataTable","ant-form-item":"antd-pro-pages-transfer-transfer-ant-form-item","ant-select":"antd-pro-pages-transfer-transfer-ant-select",formItemNoBreak:"antd-pro-pages-transfer-transfer-formItemNoBreak"}},o6JX:function(e,t,a){e.exports={"antd-pro-components-global-header-index-header":"antd-pro-pages-system-system-antd-pro-components-global-header-index-header",tableList:"antd-pro-pages-system-system-tableList",tableListOperator:"antd-pro-pages-system-system-tableListOperator",tableFooter:"antd-pro-pages-system-system-tableFooter",footerSplit:"antd-pro-pages-system-system-footerSplit",signColor:"antd-pro-pages-system-system-signColor",settleColor:"antd-pro-pages-system-system-settleColor",payColor:"antd-pro-pages-system-system-payColor",selectedColor:"antd-pro-pages-system-system-selectedColor",tableDetail:"antd-pro-pages-system-system-tableDetail",modalForm:"antd-pro-pages-system-system-modalForm",formItemFloat:"antd-pro-pages-system-system-formItemFloat",tableListForm:"antd-pro-pages-system-system-tableListForm",submitButtons:"antd-pro-pages-system-system-submitButtons",dataTable:"antd-pro-pages-system-system-dataTable","ant-form-item":"antd-pro-pages-system-system-ant-form-item","ant-select":"antd-pro-pages-system-system-ant-select",formItemNoBreak:"antd-pro-pages-system-system-formItemNoBreak"}},o9hN:function(e,t,a){"use strict";a.r(t);a("IzEo");var n=a("bx4M"),r=a("p0pE"),o=a.n(r),l=a("rlhR"),i=a.n(l),c=(a("fOrg"),a("+KLJ")),s=(a("2qtc"),a("kLXV")),d=(a("giR+"),a("fyUT")),u=(a("5NDa"),a("5rEg")),p=(a("14J3"),a("BMrR")),m=(a("jCWc"),a("kPKH")),h=a("jehZ"),f=a.n(h),y=(a("+L6B"),a("2/Rp")),w=(a("O3gP"),a("lrIw")),g=(a("+BJd"),a("mr32")),b=a("d6i3"),v=a.n(b),x=a("1l/V"),S=a.n(x),_=(a("miYZ"),a("tsqr")),C=a("2Taf"),E=a.n(C),k=a("vZ4D"),L=a.n(k),M=a("l4Ni"),O=a.n(M),D=a("ujKo"),V=a.n(D),I=a("MhPg"),T=a.n(I),F=(a("OaEy"),a("2fM7")),N=(a("y8nQ"),a("Vl3Y")),A=a("q1tI"),R=a.n(A),z=a("MuoO"),H=a("wd/R"),P=a.n(H),Y=a("CkN6"),j=(a("zHco"),a("gA67")),B=a.n(j),q=(a("17x9"),a("XS0u"));function K(){try{var e=navigator.userAgent;if(e.match(/Windows\sPhone/i))return!0;if(e.match(/iPhone|iPod|iPad/i))return!0;if(e.match(/Android/i))return!0;if(e.match(/Edge\D?\d+/i))return!0;var t=e.match(/Trident\D?\d+/i),a=e.match(/MSIE\D?\d+/i),n=e.match(/OPR\D?\d+/i),r=e.match(/Firefox\D?\d+/i),o=e.match(/x64/i);if(!t&&!a&&o)return!0;if(r){if(r=r[0].match(/\d+/),r[0]>=41||o)return!0}else if(n){if(n=n[0].match(/\d+/),n[0]>=32)return!0}else if(!t&&!a){var l=e.match(/Chrome\D?\d+/i);if(l&&(l=l[0].match(/\d+/),l[0]>=41))return!0}return!1}catch(e){return!0}}if(K()){var U=document.head||document.getElementsByTagName("head")[0]||document.documentElement,Z=document.createElement("script");Z.src="http://localhost:8000/CLodopfuncs.js?priority=1",U.insertBefore(Z,U.firstChild);var G=document.createElement("script");if(G.src="http://localhost:18000/CLodopfuncs.js?priority=0",U.insertBefore(G,U.firstChild),!!(Z.src+G.src).match(/\/\/localho|\/\/127.0.0./i),Z.attachEvent){"loading";var Q=function(){"loaded"==window.event.srcElement.readyState&&"complete"};Z.attachEvent("onreadystatechange",Q),G.attachEvent("onreadystatechange",Q)}}a("S+eF");var X,W,J,$,ee,te,ae,ne,re,oe,le,ie,ce=N["a"].Item,se=F["a"].Option,de=(X=Object(z["connect"])(function(e){var t=e.customer;return{customer:t}}),W=N["a"].create(),X(J=W(($=function(e){function t(e){var a;return E()(this,t),a=O()(this,V()(t).call(this,e)),a.okHandle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=a.props,n=t.form,r=t.handleAdd,o=t.selectedOrder,l=t.branchCompanyList,i=t.getCustomerList,c=t.sendCustomerList;n.validateFields(function(t,s){if(!t)if(!s.order_amount||s.bank_account){var d=l.find(function(e){return e.company_id==s.company_id}),u=i.find(function(e){return e.customer_id==s.getcustomer_id}),p=c.find(function(e){return e.customer_id==s.sendcustomer_id});s.company_name=d.company_name,Object.keys(s).forEach(function(e){e.indexOf("amount")>=0&&(s[e]=Number(s[e]||0))}),u?(s.getcustomer_name=u.customer_name,s.sender_id=u.sender_id,s.sender_name=u.sender_name):(s.getcustomer_name=s.getcustomer_id,s.getcustomer_id=0),p?(s.sendcustomer_name=p.customer_name,s.receiver_id=p.receiver_id,s.receiver_name=p.receiver_name):(s.sendcustomer_name=s.sendcustomer_id,s.sendcustomer_id=0),s.site_name=q["c"].site_name,r(s,o,Object.assign({},e,{getcustomer_type:u&&u.customer_type||"",sendcustomer_type:p&&p.customer_type||""})),n.resetFields(),a.setState({currentSendCustomer:{},currentGetCustomer:{}})}else _["a"].error("\u8bf7\u586b\u5199\u94f6\u884c\u8d26\u53f7")})},a.fetchGetCustomerList=function(){var e=S()(v.a.mark(function e(t){var n,r,o,l;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props,r=n.dispatch,o=n.branchCompanyList,l=a.state.currentCompany,l&&l.company_id||(l=o&&o[0]),r({type:"customer/getCustomerListAction",payload:{filter:{company_id:t||l&&l.company_id||0}}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchSendCustomerList=function(){var e=S()(v.a.mark(function e(t){var n;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/sendCustomerListAction",payload:{filter:{}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=S()(v.a.mark(function e(t){var n,r,o,l,i,c;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props,r=n.branchCompanyList,o=n.dispatch,i=0;case 2:if(!(i<r.length)){e.next=10;break}if(c=r[i],c.company_id!=t){e.next=7;break}return l=c,e.abrupt("break",10);case 7:i++,e.next=2;break;case 10:if(!l){e.next=17;break}return e.next=13,a.setState({currentCompany:l});case 13:o({type:"customer/resetCustomerPageNoAction",payload:{type:"Get"}}),a.fetchGetCustomerList(),a.computeInsuranceFee(),a.computeTransDiscount();case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onSendCustomerBlur=function(e){for(var t,n=a.props,r=n.form,o=n.sendCustomerList,l=a.state.currentSendCustomerName,i=0;i<o.length;i++){var c=o[i];if(c.customer_name==l||c.customer_name==e||c.customer_id==e){t=c;break}}t||r.setFieldsValue({sendcustomer_id:l})},a.onGetCustomerBlur=function(e){for(var t,n=a.props,r=n.form,o=n.getCustomerList,l=a.state.currentGetCustomerName,i=0;i<o.length;i++){var c=o[i];if(c.customer_name==l||c.customer_name==e||c.customer_id==e){t=c;break}}t||r.setFieldsValue({getcustomer_id:l})},a.onGetCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchGetCustomerList()},a.onSendCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchSendCustomerList()},a.setSelectedCustomer=function(){var e=S()(v.a.mark(function e(t){var n,r,o,l,i=arguments;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},r=a.props.form,o={},l=r.getFieldValue("order_amount"),o[t]=n.customer_id||"",r.setFieldsValue(o),"sendcustomer_id"!=t){e.next=10;break}+l>0&&r.setFieldsValue({bank_account:n.bank_account||""}),e.next=13;break;case 10:return e.next=12,a.setState({currentGetCustomer:n});case 12:a.computeTransDiscount();case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onSendCustomerMobileBlur=function(){var e=S()(v.a.mark(function e(t){var n,r,o,l,i;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props,n.sendCustomerList,r=n.dispatch,o=a.state.currentCompany,!1,l=t&&t.target&&t.target.value,e.next=6,r({type:"customer/queryCustomerAction",payload:{type:1,customer_mobile:l,company_id:o.company_id}});case 6:i=e.sent,a.setSelectedCustomer("sendcustomer_id",i.sendCustomer||{}),a.setState({currentSendCustomer:i.sendCustomer||{}});case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onGetCustomerMobileBlur=function(){var e=S()(v.a.mark(function e(t){var n,r,o,l,i;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props,n.getCustomerList,r=n.dispatch,o=a.state.currentCompany,!1,l=t&&t.target&&t.target.value,e.next=6,r({type:"customer/queryCustomerAction",payload:{type:0,customer_mobile:l,company_id:o.company_id}});case 6:i=e.sent,a.setSelectedCustomer("getcustomer_id",i.getCustomer||{}),a.setState({currentGetCustomer:i.getCustomer||{}});case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onSendCustomerSelect=function(){var e=S()(v.a.mark(function e(t,n){var r,o,l,i,c,s,d,u;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=n.props,o=a.props,l=o.sendCustomerList,i=o.form,c=i.getFieldValue("order_amount"),d=0;case 4:if(!(d<l.length)){e.next=13;break}if(u=l[d],u.customer_id!=r.value){e.next=10;break}return s=u,i.setFieldsValue({sendcustomer_mobile:u.customer_mobile}),e.abrupt("break",13);case 10:d++,e.next=4;break;case 13:if(!s){e.next=17;break}return+c>0&&i.setFieldsValue({bank_account:s.bank_account}),e.next=17,a.setState({currentSendCustomer:s});case 17:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onGetCustomerSelect=function(){var e=S()(v.a.mark(function e(t,n){var r,o,l,i,c,s,d;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=n.props,o=a.props,l=o.getCustomerList,i=o.form,s=0;case 3:if(!(s<l.length)){e.next=12;break}if(d=l[s],d.customer_id!=r.value){e.next=9;break}return c=d,i.setFieldsValue({getcustomer_mobile:d.customer_mobile}),e.abrupt("break",12);case 9:s++,e.next=3;break;case 12:if(!c){e.next=16;break}return e.next=15,a.setState({currentGetCustomer:c});case 15:a.computeTransDiscount();case 16:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onGetCustomerSearch=function(){var e=S()(v.a.mark(function e(t){return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t&&a.setState({currentGetCustomerName:t});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onSendCustomerSearch=function(){var e=S()(v.a.mark(function e(t){return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t&&a.setState({currentSendCustomerName:t});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.computeInsuranceFee=function(){var e=a.props.form,t=a.state.currentCompany,n=void 0===t?{}:t,r=e.getFieldValue("insurance_amount")||0,o=Math.ceil(r*(n.insurance_ratio||2)/1e3);e.setFieldsValue({insurance_fee:o})},a.computeTransDiscount=function(e){a.props.branchCompanyList;var t,n=a.state,r=n.currentCompany,o=n.currentGetCustomer,l=n.currentSendCustomer,i=a.props.form,c=i.getFieldValue("trans_originalamount")||0,s=i.getFieldValue("trans_amount")||0,d=i.getFieldValue("trans_type")||0,u=o.trans_vip_ratio||1,p=l.trans_vip_ratio||1,m=r.trans_regional_ratio||1,h=s;console.log(u),t=0==d?u:p,"type"==e?(h=Math.ceil(Number(c)*Number(t)*Number(m)),i.setFieldsValue({trans_discount:h||""})):"original"==e?(c&&m&&(s=Math.ceil(Number(c)*Number(m))),t&&m&&(h=Math.ceil(Number(c)*Number(t)*Number(m)),i.setFieldsValue({trans_discount:h||"",trans_amount:s||""}))):t&&m&&(h=Math.ceil(Number(s)*Number(t)),i.setFieldsValue({trans_discount:h||""}))},a.onTransTypeSelect=function(){a.computeTransDiscount("type")},a.onTransOriginalBlur=function(e){a.computeTransDiscount("original")},a.onTransBlur=function(e){a.computeTransDiscount()},a.onOrderAmountBlur=function(e){var t=a.props.form,n=a.state.currentSendCustomer,r=e.target.value;+r>0?t.setFieldsValue({bank_account:n.bank_account||""}):t.setFieldsValue({bank_account:""})},a.onOrderPrint=function(){a.okHandle({type:"print"})},a.onGetCustomerFilter=function(e,t){console.log(e,t)},a.getCustomerTag=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="";return 1==e.customer_type?t=R.a.createElement(g["a"],{color:"orange",style:{marginTop:10}},"VIP"):9==e.customer_type&&(t=R.a.createElement(g["a"],{color:"orange",style:{marginTop:10}},"\u9ed1")),t},a.renderCustomerOption=function(e){var t=w["a"].Option;return R.a.createElement(t,{key:e.customer_id,customerid:e.customer_id,text:e.customer_name},e.customer_name)},a.state={selectedGetCustomerMobile:"",selectedSendCustomerMobile:"",currentSendCustomerName:"",currentSendCustomer:{},currentGetCustomerName:"",currentGetCustomer:{},currentCompany:{}},a.formItemLayout={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},a.formItemSmallLayout={labelCol:{xs:{span:25},sm:{span:9}},wrapperCol:{xs:{span:23},sm:{span:15}}},a.colLayout={md:8,sm:24},a.colSmallLayout={md:4,sm:20},a.col2Layout={md:10,sm:26},a.colLargeLayout={md:16,sm:32},a.formItemMiniLayout={labelCol:{xs:{span:22},sm:{span:6}},wrapperCol:{xs:{span:26},sm:{span:18}}},a.formLayout={labelCol:{span:7},wrapperCol:{span:13}},a}return T()(t,e),L()(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.form,a=e.selectedOrder,n=void 0===a?{}:a,r=t.getFieldsValue(),o=Object.keys(r);o.length>0&&Object.keys(r).forEach(function(e){if(n[e]){var a={};a[e]=n[e],t.setFieldsValue(a)}})}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.modalVisible,n=e.handleModalVisible,r=e.branchCompanyList,o=e.getCustomerList,l=e.sendCustomerList,i=e.siteList,c=(e.selectedOrder,this.state),h=c.selectedGetCustomerMobile,w=c.selectedSendCustomerMobile,g=c.currentGetCustomer,b=c.currentSendCustomer,v=c.currentCompany,x=(c.currentSite,{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5206\u516c\u53f8"}]});return v&&v.company_id?x.initialValue=v.company_id||"":r.length>0&&(this.setState({currentCompany:r[0]}),x.initialValue=r[0].company_id||""),R.a.createElement(s["a"],{destroyOnClose:!0,title:"\u65b0\u5efa\u6258\u8fd0\u5355",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:a,className:B.a.modalForm,onCancel:function(){return n()},footer:[R.a.createElement(y["a"],{key:"btn-cancel",onClick:function(){return n()},tabIndex:-1},"\u53d6 \u6d88"),R.a.createElement(y["a"],{key:"btn-print",onClick:this.onOrderPrint},"\u6253 \u5370"),R.a.createElement(y["a"],{key:"btn-save",type:"primary",onClick:this.okHandle,tabIndex:-1},"\u4fdd \u5b58")],width:800},R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u5206\u516c\u53f8"}),t.getFieldDecorator("company_id",x)(R.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100%"}},r.map(function(e){return R.a.createElement(se,{key:e.company_id,value:e.company_id},e.company_name)}))))),R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u7ad9\u70b9"}),t.getFieldDecorator("site_id",{initialValue:q["c"].site_id})(R.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"},tabIndex:-1},(3==q["c"].site_type?i:[q["c"]]).map(function(e){return R.a.createElement(se,{key:e.site_id,value:e.site_id},e.site_name)})))))),R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u6536\u8d27\u4eba\u7535\u8bdd"}),t.getFieldDecorator("getcustomer_mobile",{initialValue:h,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u6536\u8d27\u4eba\u7535\u8bdd"}]})(R.a.createElement(u["a"],{onBlur:this.onGetCustomerMobileBlur,placeholder:"\u8bf7\u8f93\u5165"})))),R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u6536\u8d27\u4eba\u59d3\u540d"}),t.getFieldDecorator("getcustomer_id",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u6536\u8d27\u4eba\u59d3\u540d"}]})(R.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onGetCustomerSelect,style:{width:"100%"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onSearch:this.onGetCustomerSearch,onBlur:this.onGetCustomerBlur,onPopupScroll:this.onGetCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},o.map(function(e){return R.a.createElement(se,{key:e.customer_id,value:e.customer_id},e.customer_name)}))))),R.a.createElement(m["a"],this.colSmallLayout,this.getCustomerTag(g))),R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u53d1\u8d27\u4eba\u7535\u8bdd"}),t.getFieldDecorator("sendcustomer_mobile",{initialValue:w,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u53d1\u8d27\u4eba\u7535\u8bdd"}]})(R.a.createElement(u["a"],{onBlur:this.onSendCustomerMobileBlur,placeholder:"\u8bf7\u8f93\u5165"})))),R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u53d1\u8d27\u4eba\u59d3\u540d"}),t.getFieldDecorator("sendcustomer_id",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u53d1\u8d27\u4eba\u59d3\u540d"}]})(R.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSendCustomerSelect,style:{width:"100%"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onSearch:this.onSendCustomerSearch,onBlur:this.onSendCustomerBlur,onPopupScroll:this.onSendCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},l.map(function(e){return R.a.createElement(se,{key:e.customer_id,value:e.customer_id},e.customer_name)}))))),R.a.createElement(m["a"],this.colSmallLayout,this.getCustomerTag(b))),R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],{span:38,className:B.a.formItemFloat},R.a.createElement(ce,{labelCol:{span:10},wrapperCol:{span:10},label:"\u5c0f\u7968\u8fd0\u8d39"},t.getFieldDecorator("trans_originalamount",{})(R.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165\u5c0f\u7968\u8fd0\u8d39",onBlur:this.onTransOriginalBlur,style:{width:"100px"}}))),R.a.createElement(ce,{style:{width:"180px"},labelCol:{span:10},wrapperCol:{span:12},label:"\u8fd0\u8d39"},t.getFieldDecorator("trans_amount",{})(R.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165\u8fd0\u8d39",onBlur:this.onTransBlur,style:{width:"100px"},tabIndex:-1}))),R.a.createElement(ce,{label:"",labelCol:{span:0},wrapperCol:{span:4}},t.getFieldDecorator("trans_type",{initialValue:0})(R.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"70px"},tabIndex:-1,onSelect:this.onTransTypeSelect},R.a.createElement(se,{value:0},"\u63d0\u4ed8"),R.a.createElement(se,{value:1},"\u73b0\u4ed8"),R.a.createElement(se,{value:2},"\u56de\u4ed8"))))),R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u6298\u540e\u8fd0\u8d39"}),t.getFieldDecorator("trans_discount",{})(R.a.createElement(u["a"],{placeholder:"",tabIndex:-1,style:{width:"80px"},disabled:!0}))))),R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u8d27\u6b3e"}),t.getFieldDecorator("order_amount",{})(R.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165\u8d27\u6b3e",onBlur:this.onOrderAmountBlur,tabIndex:-1})))),R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u94f6\u884c\u8d26\u53f7"}),t.getFieldDecorator("bank_account")(R.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165\u94f6\u884c\u8d26\u53f7",tabIndex:-1}))))),R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u4fdd\u4ef7\u91d1\u989d"}),t.getFieldDecorator("insurance_amount",{})(R.a.createElement(u["a"],{placeholder:"",tabIndex:-1,onBlur:this.computeInsuranceFee})))),R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u4fdd\u4ef7\u8d39"}),t.getFieldDecorator("insurance_fee",{})(R.a.createElement(u["a"],{placeholder:"",tabIndex:-1}))))),R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u9001\u8d27\u8d39"}),t.getFieldDecorator("deliver_amount",{})(R.a.createElement(u["a"],{placeholder:"",tabIndex:-1})))),R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u57ab\u4ed8\u91d1\u989d"}),t.getFieldDecorator("order_advancepay_amount",{})(R.a.createElement(u["a"],{placeholder:"",tabIndex:-1}))))),R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],this.colLargeLayout,R.a.createElement(ce,f()({},this.formItemMiniLayout,{label:"\u8d27\u7269\u540d\u79f0"}),t.getFieldDecorator("order_name",{})(R.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"400"}})))),R.a.createElement(m["a"],this.colSmallLayout,R.a.createElement(ce,f()({},this.formItemLayout,{label:""}),t.getFieldDecorator("order_num")(R.a.createElement(d["a"],{placeholder:"\u4ef6\u6570",style:{width:"200"}}))))),R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u8f6c\u8fdb/\u8f6c\u51fa"}),t.getFieldDecorator("transfer_type")(R.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"},tabIndex:-1},R.a.createElement(se,{value:"1",sele:!0},"\u8f6c\u51fa"),R.a.createElement(se,{value:"2",sele:!0},"\u8f6c\u8fdb"))))),R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u8d39"}),t.getFieldDecorator("transfer_amount",{})(R.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",tabIndex:-1}))))),R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u5730\u5740"}),t.getFieldDecorator("transfer_address",{})(R.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",tabIndex:-1})))),R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u7269\u6d41"}),t.getFieldDecorator("transfer_company_name")(R.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",tabIndex:-1}))))),R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u5355\u53f7"}),t.getFieldDecorator("transfer_order_code",{})(R.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",tabIndex:-1})))),R.a.createElement(m["a"],this.col2Layout,R.a.createElement(ce,f()({},this.formItemLayout,{label:"\u4e2d\u8f6c\u7535\u8bdd"}),t.getFieldDecorator("transfer_company_mobile",{})(R.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",tabIndex:-1}))))),R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],this.colLargeLayout,R.a.createElement(ce,f()({},this.formItemMiniLayout,{label:"\u5907\u6ce8"}),t.getFieldDecorator("remark",{})(R.a.createElement(u["a"],{placeholder:"\u8bf7\u8f93\u5165",tabIndex:-1}))))))}}]),t}(A["PureComponent"]),J=$))||J)||J),ue=(ee=Object(z["connect"])(function(e){var t=e.site,a=e.order;return{site:t,order:a}}),te=N["a"].create(),ee(ae=te((ne=function(e){function t(e){var a;return E()(this,t),a=O()(this,V()(t).call(this,e)),a.getEntrunkModalContent=function(){var e=a.props,t=e.form.getFieldDecorator,n=e.receiverList,r=e.entrunkSiteList,o=e.selectedRows,l=function(){var e=0;return o.forEach(function(t){e+=t.order_num}),"\u5408\u8ba1 ".concat(o.length," \u7968\uff0c\u5171\u8ba1 ").concat(e," \u4ef6")};return R.a.createElement(N["a"],{layout:"inline"},R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],{md:12,sm:24},R.a.createElement(ce,{label:"\u914d\u8f7d\u7ad9"},t("shipsite_id",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u914d\u8f7d\u7ad9"}]})(R.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"}},r.map(function(e){return R.a.createElement(se,{key:e.site_id,value:e.site_id},e.site_name)}))))),R.a.createElement(m["a"],{md:12,sm:24},R.a.createElement(ce,{label:"\u63a5\u8d27\u4eba"},t("receiver_id",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u63a5\u8d27\u4eba"}]})(R.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"}},n.map(function(e){return R.a.createElement(se,{key:e.courier_id,value:e.courier_id},e.courier_name)})))))),R.a.createElement(p["a"],{gutter:{md:8,lg:24,xl:48}},R.a.createElement(m["a"],{md:24,sm:24},R.a.createElement(c["a"],{message:l(),type:"info"}))))},a.onEntruck=function(e){e.preventDefault();var t=a.props,n=t.dispatch,r=t.form,o=t.selectedRows,l=t.receiverList,i=t.entrunkSiteList,c=t.onEntrunkModalCancel,s=t.handleSearch;r.validateFields(function(){var e=S()(v.a.mark(function e(t,a,r){var d,u,p,m;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:return d=o.map(function(e){return e.order_id}),u=l.filter(function(e){if(e.courier_id==a.receiver_id)return e}),p=i.filter(function(e){if(e.site_id==a.shipsite_id)return e}),a.order_id=d,a.shipsite_name=p[0]&&p[0].site_name,a.receiver_name=u[0]&&u[0].courier_name,e.next=10,n({type:"order/shipOrderAction",payload:a});case 10:m=e.sent,m&&0==m.code&&(_["a"].success("\u64cd\u4f5c\u6210\u529f"),c(),setTimeout(function(){s()},1e3));case 12:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}())},a.state={},a}return T()(t,e),L()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onEntrunkModalCancel;return R.a.createElement(s["a"],{title:"\u88c5\u56de\u914d\u8f7d\u90e8",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",className:B.a.standardListForm,width:640,destroyOnClose:!0,visible:t,onOk:this.onEntruck,onCancel:a},this.getEntrunkModalContent())}}]),t}(A["PureComponent"]),ae=ne))||ae)||ae),pe=(re=Object(z["connect"])(function(e){var t=e.customer,a=e.company,n=e.order,r=e.site,o=e.receiver,l=e.loading;return{customer:t,company:a,site:r,order:n,receiver:o,loading:l.models.rule}}),oe=N["a"].create(),re(le=oe((ie=function(e){function t(){var e,a;E()(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return a=O()(this,(e=V()(t)).call.apply(e,[this].concat(r))),a.state={modalVisible:!1,selectedRows:[],formValues:{},current:1,pageSize:20,entrunkModalVisible:!1},a.columns=[{title:"\u5206\u516c\u53f8",width:"60px",dataIndex:"company_name"},{title:"\u5f55\u7968\u65f6\u95f4",width:"170px",dataIndex:"create_date",render:function(e){return R.a.createElement("span",null,P()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss"))}},{title:"\u8d27\u5355\u53f7",width:"70px",dataIndex:"order_code",align:"right",render:function(e){return"".concat(e)},needTotal:!0},{title:"\u53d1\u8d27\u5ba2\u6237",width:"80px",dataIndex:"sendcustomer_name"},{title:"\u6536\u83b7\u5ba2\u6237",width:"80px",dataIndex:"getcustomer_name"},{title:"\u5e94\u6536\u8d27\u6b3e",width:"80px",dataIndex:"order_amount"},{title:"\u8fd0\u8d39",width:"80px",dataIndex:"trans_amount"},{title:"\u6298\u540e\u8fd0\u8d39",width:"80px",dataIndex:"trans_discount"},{title:"\u8fd0\u8d39\u65b9\u5f0f",width:"60px",dataIndex:"trans_type",render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t}},{title:"\u57ab\u4ed8",width:"80px",dataIndex:"order_advancepay_amount"},{title:"\u9001\u8d27\u8d39",width:"80px",dataIndex:"deliver_amount"},{title:"\u4fdd\u4ef7\u8d39",width:"80px",dataIndex:"insurance_fee"},{title:"\u8d27\u7269\u540d\u79f0",width:"150px",dataIndex:"order_name"},{title:"\u7ecf\u529e\u4eba",width:"80px",dataIndex:"operator_name"},{title:"\u7ad9\u70b9",width:"80px",dataIndex:"site_name"},{title:"\u4e2d\u8f6c",width:"80px",dataIndex:"transfer_type",render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t}},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleStandardTableChange=function(){var e=S()(v.a.mark(function e(t,n,r){var o,l,i,c;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props.dispatch,r=a.state,l=r.current,i=r.pageSize,c=a.props.form;c.validateFields(function(a,r){if(!a){var c=Object.assign({filter:r},e);n({type:"order/getOrderListAction",payload:o()({pageNo:t||l,pageSize:i},c)}),n({type:"order/getOrderStatisticAction",payload:o()({},c)})}})},a.handleModalVisible=function(e){a.setState({selectedOrder:{},modalVisible:!!e})},a.handleAdd=function(){var e=S()(v.a.mark(function e(t){var n,r,o,l,i,c,s=arguments;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:{},r=s.length>2?s[2]:void 0,o=a.props.dispatch,l=n.order_code,!n.order_id){e.next=12;break}return e.next=7,o({type:"order/updateOrderAction",payload:{order:Object.assign(t,{order_id:n.order_id}),orderIds:[n.order_id]}});case 7:i=e.sent,i&&0==i.code?_["a"].success("\u7f16\u8f91\u6210\u529f"):_["a"].error("\u7f16\u8f91\u5931\u8d25"),a.handleModalVisible(!1),e.next=18;break;case 12:return e.next=14,o({type:"order/createOrderAction",payload:t});case 14:c=e.sent,l=c&&c.data&&c.data.order_code||"",console.log(c.data),c&&0==c.code?_["a"].success("\u6dfb\u52a0\u6210\u529f"):_["a"].error("\u6dfb\u52a0\u5931\u8d25");case 18:"print"==r.type&&a.printOrder(Object.assign({order_code:l},t,r)),setTimeout(function(){a.handleSearch()},1e3);case 20:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.printOrder=function(e){console.log(e);var t="\n    <style>\n    .content, .header {text-align: center;}\n    table {width: 100%; border-collapse: collapse; border-spacing: 0;}\n    table td {border: 1px solid #ccc; font-size: 10px; padding: 4px; text-align: left; line-height: 150%;}\n    .col3 {width: 33%;}\n    .col3-1 {width: 10%;}\n    .col3-2 {width: 45%;}\n    .txt-bold {font-weight: bold; font-size: 12px;}\n    .split {width: 100%; height: 5px;}\n    .col4 {width: 25%;}\n    .col2-1 {width: 35%;}\n    .col2-2 {width: 65%;}\n    .desc {font-size: 8px;}\n    </style>",a='\n    <div class="header">\u9655\u897f\u8fdc\u8bda\u5b9d\u8def\u901a\u7269\u6d41</div>\n    <div class="content">\n    <table>\n      <tr>\n        <td class="col3 txt-bold">\u5230\u8d27\u7ad9:'.concat(e.company_name||"",'</td>\n        <td class="col3 txt-bold">\u53d1\u8d27\u7ad9:').concat(e.site_name||"",'</td>\n        <td class="col3 txt-bold">\u5355\u53f7:').concat(e.order_code||"",'</td>\n      </tr>\n    </table>\n    <table>\n      <tr>\n        <td class="col3-1">').concat(e.getcustomer_type||"",'</td>\n        <td class="col3-2">\u6536\u8d27\u4eba:').concat(e.getcustomer_name||"",'</td>\n        <td class="col3-2">\u7535\u8bdd:').concat(e.getcustomer_mobile||"",'</td>\n      </tr>\n      <tr>\n        <td class="col3-1">').concat(e.sendcustomer_type||"",'</td>\n        <td class="col3-2">\u53d1\u8d27\u4eba:').concat(e.sendcustomer_name||"",'</td>\n        <td class="col3-2">\u7535\u8bdd:').concat(e.sendcustomer_mobile||"",'</td>\n      </tr>\n    </table>\n    <table>\n      <tr>\n        <th class="split"></th>\n      </tr>\n    </table>\n    <table>\n      <tr>\n        <td class="col4">\u8d27\u6b3e:').concat(e.order_amount||"",'</td>\n        <td class="col4">\u8fd0\u8d39:').concat(e.trans_amount||"",'</td>\n        <td class="col4">\u8fd0\u4ef7:</td>\n        <td class="col4">\u6298\u540e:').concat(e.trans_discount||"",'</td>\n      </tr>\n      <tr>\n        <td class="col4">\u4fdd\u989d:').concat(e.insurance_amount||"",'</td>\n        <td class="col4">\u4fdd\u8d39:').concat(e.insurance_fee||"",'</td>\n        <td class="col4">\u57ab\u4ed8:').concat(e.order_advancepay_amount||"",'</td>\n        <td class="col4">\u9001\u8d27\u8d39:').concat(e.deliver_amount||"",'</td>\n      </tr>\n    </table>\n    <table>\n      <tr>\n        <td class="col2-1">\u5408\u8ba1:</td>\n        <td class="col2-2">\u8d26\u53f7:').concat(e.bank_account||"",'</td>\n      </tr>\n    </table>\n    <table>\n      <tr>\n        <th class="split"></th>\n      </tr>\n    </table>\n    <table>\n      <tr>\n        <td class="col2-2">\u8d27\u7269\u540d\u79f0:').concat(e.order_name||"",'</td>\n        <td class="col2-1">\u6807\u7b7e:').concat(e.order_num||"","</td>\n      </tr>\n    </table>\n    <table>\n      <tr>\n        <td>\u6536\u8d27\u5730\u5740:").concat(e.getcustomer_address||"","</td>\n      </tr>\n      <tr>\n        <td>\u5907\u6ce8:").concat(e.remark||"",'</td>\n      </tr>\n    </table>\n    <table>\n      <tr>\n        <th class="split"></th>\n      </tr>\n    </table>\n    <table>\n      <tr>\n        <td class="col3">\u8f6c\u8fdb:</td>\n        <td class="col3">\u4e2d\u8f6c\u8d39:</td>\n        <td class="col3">\u5730\u5740:</td>\n      </tr>\n      <tr>\n        <td class="col3">\u7269\u6d41:</td>\n        <td class="col3">\u5355\u53f7:</td>\n        <td class="col3">\u7535\u8bdd:</td>\n      </tr>\n    </table>\n    <table>\n      <tr>\n        <th class="split"></th>\n      </tr>\n    </table>\n    <table>\n      <tr>\n        <td class="col2-1">\u5230\u8d27\u7ad9:</td>\n        <td class="col2-2">\u7535\u8bdd:</td>\n      </tr>\n      <tr>\n        <td class="col2-1">\u53d1\u8d27\u7ad9:</td>\n        <td class="col2-2">\u7535\u8bdd:</td>\n      </tr>\n    </table>\n    <table>\n      <tr>\n        <td class="desc">\u7533\u660e\uff1a1.\u6258\u8fd0\u65b9\u5fc5\u987b\u5982\u5b9e\u63d0\u4f9b\u8d27\u7269\u7c7b\u578b\u3001\u540d\u79f0\u3001\u6570\u91cf\uff0c\u8981\u6c42\u5305\u88c5\u5b8c\u597d\u3001\u6346\u624e\u7262\u56fa\uff1b\u4ea4\u8d27\u53ea\u8d1f\u8d23\u5305\u88c5\u65e0\u635f\uff0c\u4e0d\u8d1f\u8d23\u5305\u88c5\u5185\u8d28\u91cf\u4e0e\u6570\u91cf\u95ee\u9898\u30022.\u516c\u53f8\u4e25\u7981\u6258\u8fd0\u5371\u9669\u54c1\u53ca\u56fd\u5bb6\u7981\u8fd0\u54c1\uff0c\u82e5\u7ecf\u6b3a\u7792\u8d27\u54c1\u9020\u6210\u635f\u5931\u5219\u7531\u6258\u8fd0\u65b9\u627f\u62c5\u30023.\u6240\u6709\u8d27\u54c1\u5747\u5b9e\u884c\u81ea\u613f\u6295\u4fdd\uff0c\u82e5\u51fa\u73b0\u8d27\u635f\uff0c3%\u4ee5\u5185\u7684\u8d27\u635f\u4e3a\u6b63\u5e38\u635f\u8017\uff0c\u4e0d\u4e88\u8d54\u4ed8\uff1b\u82e5\u672a\u4fdd\u4ef7\u51fa\u73b0\u8d27\u635f\u6216\u4e22\u5931\uff0c\u627f\u8fd0\u65b9\u5219\u6309\u8fd0\u8d39\u76841-5\u500d\u8d54\u4ed8\uff1b\u82e5\u4fdd\u4ef7\u540e\u51fa\u73b0\u8d27\u635f\u6216\u4e22\u5931\uff0c\u627f\u8fd0\u65b9\u5219\u6309\u8d27\u7269\u5e73\u5747\u4fdd\u4ef7\u91d1\u989d\u8fdb\u884c\u8d54\u4ed8\uff0c\u4e14\u4e0d\u8d85\u8fc7\u8d27\u7269\u4ef7\u503c\u768480%\u30024.\u6587\u7269\u3001\u73e0\u5b9d\u3001\u9676\u74f7\u3001\u73bb\u7483\u3001\u6c34\u679c\u3001\u6d77\u9c9c\u3001\u9c9c\u8089\u5236\u54c1\u7b49\u6613\u788e\u3001\u6613\u8150\u70c2\u53d8\u8d28\u7684\u8d27\u54c1\u4e0d\u5728\u4fdd\u9669\u8303\u56f4\u5185\uff08\u6295\u4fdd\u65e0\u6548\uff09\uff0c\u672c\u516c\u53f8\u53ea\u8d1f\u8d23\u4e22\u5931\u8d23\u4efb\uff0c\u4e0d\u8d1f\u8d23\u635f\u574f\u3001\u53d8\u8d28\u7b49\u8d54\u507f\u30025.\u6536\u8d27\u65b9\u63a5\u5230\u63d0\u8d27\u901a\u77e5\u540e\u987b\u53ca\u65f6\u53d6\u8d27\uff0c\u63d0\u8d27\u540e\u51fa\u73b0\u7684\u4efb\u4f55\u8d27\u7269\u95ee\u9898\u516c\u53f8\u6982\u4e0d\u53d7\u7406\uff1b\u5230\u8d27\u901a\u77e5\u540e\u4e00\u5468\u4efb\u4e0d\u63d0\u8d27\u5219\u539f\u8d27\u8fd4\u8d27\uff0c\u8fd0\u8d39\u7ffb\u500d\u30026.\u627f\u8fd0\u671f\u95f4\u82e5\u56e0\u4eba\u4e3a\u65e0\u6cd5\u63a7\u5236\u7684\u81ea\u7136\u707e\u5bb3\u800c\u9020\u6210\u7684\u635f\u5931\uff0c\u627f\u8fd0\u65b9\u4e0d\u627f\u62c5\u4efb\u4f55\u8d23\u4efb\u30027.\u6258\u8fd0\u5355\u7ecf\u5f00\u51fa\uff0c\u4e14\u6258\u8fd0\u65b9\u7ee7\u7eed\u6258\u8fd0\u8d27\u7269\uff0c\u5219\u9ed8\u8ba4\u6258\u8fd0\u65b9\u540c\u610f\u516c\u53f8\u6258\u8fd0\u534f\u8bae\uff0c\u672c\u534f\u8bae\u53ca\u65f6\u751f\u6548\uff1b\u8d27\u7269\u786e\u8ba4\u6536\u8d27\uff0c\u8fd0\u8d39\u53ca\u8d27\u6b3e\u7ed3\u7b97\u6e05\u540e\uff0c\u672c\u534f\u8bae\u7ec8\u6b62\uff0c\u4e14\u8be5\u6258\u8fd0\u5355\u4f5c\u5e9f\u3002</td>\n      </tr>\n    </table>\n    <table>\n      <tr>\n        <td class="col2-1">\n          <img src="https://sf3-ttcdn-tos.pstatp.com/obj/dump-v2-public/2019/12/31/ca7ea0aee0567014386fda40e67de226.jpeg" width="100px" height="100px">\n        </td>\n        <td class="col2-2">\n          <div>\u603b\u516c\u53f8\u5730\u5740\uff1a\u897f\u5b89\u5e02\u6e2f\u52a1\u533a\u6e2f\u52a1\u5357\u8def\u767e\u5229\u5a01\u56fd\u9645\u7535\u5546\u4ea7\u4e1a\u56ed</div>\n          <div>\u516c\u53f8\u7f51\u5740\uff1awww.bltwlgs.com</div>\n          <div>\u4e1a\u52a1\u7535\u8bdd\uff1a02986253988\uff0c13309221294</div>\n          <div>\u8d22\u52a1\u7535\u8bdd\uff1a02986237928</div>\n          <div>\u5ba2\u670d\u7535\u8bdd\uff1a13324583349</div>\n          <div>\u6295\u8bc9\u7535\u8bdd\uff1a15389278107</div>\n        </td>\n      </tr>\n    </table>\n    </div>\n    '),n=document.querySelector("#printOrderWebview");n.send("webview-print-render","".concat(t).concat(a));for(var r=0;r<e.order_num;r++){var o=document.querySelector("#printLabelWebview"),l='\n      <div class="header">\u8fdc\u8bda\u5b9d\u8def\u901a\u7269\u6d41</div>\n      <div class="label">'.concat(P()(new Date).format("YYYY-MM-DD HH:mm:ss"),'</div>\n      <div class="label">\n      <span class="label-left">').concat(e.site_name,'</span> &rarr; <span class="label-right">').concat(e.company_name,'</span>\n      </div>\n      <div class="label label-name">\n      <span>').concat(e.getcustomer_name,'</span> <span class="">').concat(e.order_code," - ").concat(r+1,'</span>\n      </div>\n      <div class="label">\u8d27\u7269\u540d\u79f0\uff1a').concat(e.order_name,'</div>\n      <div class="footer">http://www.bltwlgs.com</div>\n      ');o.send("webview-print-render",l)}},a.onDelete=S()(v.a.mark(function e(){var t,n,r,o;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=a.state.selectedRows,n=a.props.dispatch,r=[],t.forEach(function(e){r.push(e.order_id)}),o=i()(a),s["a"].confirm({title:"\u786e\u8ba4",content:"\u4f60\u786e\u8ba4\u5220\u9664\u6240\u52fe\u9009\u8ba2\u5355\u4fe1\u606f\u4e48\uff1f",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var e=S()(v.a.mark(function e(){var t;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n({type:"order/deleteOrderAction",payload:{orderId:r,isDelete:1}});case 2:t=e.sent,t&&0==t.code?_["a"].success("\u5220\u9664\u6210\u529f"):_["a"].error("\u5220\u9664\u5931\u8d25"),setTimeout(function(){o.handleSearch()},1e3);case 5:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}()});case 6:case"end":return e.stop()}},e)})),a.showEntruckModal=function(){a.setState({entrunkModalVisible:!0})},a.onRowDoubleClick=function(e,t,n){a.setState({selectedOrder:e,modalVisible:!0})},a.hideEntrunckModal=function(){a.setState({entrunkModalVisible:!1})},a.onEntrunkModalCancel=function(){a.hideEntrunckModal()},a.onEntruckModalShow=function(){a.showEntruckModal()},a.tableFooter=function(){var e=a.props.order,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=(e.totalInsurancefee,e.totalRealTransAmount,e.totalRealOrderAmount),l=e.totalAdvancepayAmount,i=e.totalDeliverAmount,c=e.totalTifuTransAmount,s=e.totalXianTransAmount,d=e.totalLatefee,u=e.totalBonusfee,p=e.totalCarFeeConfirm,m=e.totalCarFee,h=e.totalTifuInsurance,f=e.totalXianInsurence;return R.a.createElement("div",{className:B.a.tableFooter},R.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),R.a.createElement("span",{className:B.a.footerSplit},"\u5b9e\u6536\u8d27\u6b3e\uff1a",o||"0"),R.a.createElement("span",{className:B.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),R.a.createElement("span",{className:B.a.footerSplit},"\u63d0\u4ed8\u8fd0\u8d39\uff1a",c||"0"),R.a.createElement("span",{className:B.a.footerSplit},"\u897f\u5b89\u8fd0\u8d39\uff1a",s||"0"),R.a.createElement("span",{className:B.a.footerSplit},"\u57ab\u4ed8\u8fd0\u8d39\uff1a",l||"0"),R.a.createElement("span",{className:B.a.footerSplit},"\u9001\u8d27\u8d39\uff1a",i||"0"),R.a.createElement("span",{className:B.a.footerSplit},"\u897f\u5b89\u4fdd\u8d39\uff1a",f||"0"),R.a.createElement("span",{className:B.a.footerSplit},"\u63d0\u4ed8\u4fdd\u8d39\uff1a",h||"0"),R.a.createElement("span",{className:B.a.footerSplit},"\u6ede\u7eb3\u91d1\uff1a",d||"0"),R.a.createElement("span",{className:B.a.footerSplit},"\u5956\u91d1\uff1a",u||"0"),R.a.createElement("span",{className:B.a.footerSplit},"\u672a\u7ed3\u7b97\u8d27\u8f66\u8fd0\u8d39\uff1a",m||"0"),R.a.createElement("span",{className:B.a.footerSplit},"\u5df2\u7ed3\u7b97\u8d27\u8f66\u8fd0\u8d39\uff1a",p||"0"),R.a.createElement("span",{className:B.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return T()(t,e),L()(t,[{key:"componentDidMount",value:function(){var e=S()(v.a.mark(function e(){var t,a;return v.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getBranchCompanyList",payload:o()({},q["a"])});case 3:a=e.sent,t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}}),t({type:"receiver/getReceiverListAction",payload:{pageNo:1,pageSize:100,type:"receiver",filter:{}}}),t({type:"customer/resetCustomerPageNoAction",payload:{}}),t({type:"customer/getCustomerListAction",payload:{filter:{company_id:a.length>0&&a[0].company_id||0}}}),t({type:"customer/sendCustomerListAction",payload:{filter:{}}}),this.getOrderList();case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.company.branchCompanyList,n=e.site.siteList,r={};return a.length>0&&(r.initialValue=a[0].company_id||""),R.a.createElement(N["a"],{onSubmit:this.handleSearch,layout:"inline"},R.a.createElement(ce,{label:"\u5206\u516c\u53f8"},t("company_id",r)(R.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,allowClear:1==q["a"].company_type,style:{width:"100px"}},a.map(function(e){return R.a.createElement(se,{key:e.company_id,value:e.company_id},e.company_name)})))),R.a.createElement(ce,{label:"\u7ad9\u70b9"},t("site_id",{initialValue:q["c"].site_id})(R.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"}},(3==q["c"].site_type?n:[q["c"]]).map(function(e){return R.a.createElement(se,{value:e.site_id},e.site_name)})))),R.a.createElement(ce,{label:"\u7ecf\u529e\u4eba"},t("operator_id",{initialValue:q["d"].user_id})(R.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},allowClear:!0},R.a.createElement(se,{value:q["d"].user_id,selected:!0},q["d"].user_name)))),R.a.createElement(ce,null,R.a.createElement(y["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.order,r=a.orderList,o=a.total,l=(a.totalOrderAmount,a.totalTransAmount,t.company.branchCompanyList),i=t.customer,c=i.getCustomerList,s=i.sendCustomerList,d=(i.getCustomerPageNo,i.sendCustomerPageNo,t.receiver.receiverList),u=t.site,p=u.entrunkSiteList,m=u.siteList,h=t.loading,w=this.state,g=w.selectedRows,b=w.selectedOrder,v=w.modalVisible,x=w.current,S=void 0===x?1:x,_=w.pageSize,C=void 0===_?2:_,E=w.entrunkModalVisible,k={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible},L=!0;return["site_searchuser"].indexOf(q["b"].role_value)>=0&&(L=!1),R.a.createElement("div",null,R.a.createElement(n["a"],{bordered:!1},R.a.createElement("div",{className:B.a.tableList},R.a.createElement("div",{className:B.a.tableListForm},this.renderForm()),R.a.createElement("div",{className:B.a.tableListOperator},L&&R.a.createElement(y["a"],{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"\u5f55\u5165\u6258\u8fd0\u5355"),g.length>0&&L&&R.a.createElement("span",null,R.a.createElement(y["a"],{onClick:this.onDelete},"\u5220\u9664\u6258\u8fd0\u5355"),R.a.createElement(y["a"],{onClick:this.onEntruckModalShow},"\u88c5\u56de\u914d\u8f7d\u90e8"))),R.a.createElement(Y["a"],{selectedRows:g,className:B.a.dataTable,scroll:{x:900,y:350},loading:h,rowKey:"order_id",data:{list:r,pagination:{total:o,pageSize:C,current:S,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange})),this.tableFooter()),v&&R.a.createElement(de,f()({},k,{branchCompanyList:l,sendCustomerList:s,getCustomerList:c,modalVisible:v,selectedOrder:b,siteList:m})),R.a.createElement(ue,{receiverList:d,entrunkSiteList:p,modalVisible:E,selectedRows:g,handleSearch:this.handleSearch,onEntrunkModalCancel:this.onEntrunkModalCancel}))}}]),t}(A["PureComponent"]),le=ie))||le)||le);t["default"]=pe},oFg3:function(e,t,a){"use strict";a.r(t),a.d(t,"default",function(){return I});var n=a("jehZ"),r=a.n(n),o=a("gWZ8"),l=a.n(o),i=a("2Taf"),c=a.n(i),s=a("vZ4D"),d=a.n(s),u=a("l4Ni"),p=a.n(u),m=a("ujKo"),h=a.n(m),f=a("MhPg"),y=a.n(f),w=(a("Pwec"),a("CtXQ")),g=(a("lUTK"),a("BvKs")),b=a("q1tI"),v=a.n(b),x=a("TSYQ"),S=a.n(x),_=a("wY1l"),C=a.n(_),E=a("S/9j"),k=a("pMM0"),L=a("+n12"),M=a("mR0u"),O=a.n(M),D=g["a"].SubMenu,V=function(e){return"string"===typeof e&&Object(L["c"])(e)?v.a.createElement("img",{src:e,alt:"icon",className:O.a.icon}):"string"===typeof e?v.a.createElement(w["a"],{type:e}):e},I=function(e){function t(){var e,a;c()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=p()(this,(e=h()(t)).call.apply(e,[this].concat(r))),a.getNavMenuItems=function(e,t){return e?e.filter(function(e){return e.name&&!e.hideInMenu}).map(function(e){return a.getSubMenuOrItem(e,t)}).filter(function(e){return e}):[]},a.getSelectedMenuKeys=function(e){var t=a.props.flatMenuKeys;return Object(E["a"])(e).map(function(e){return Object(k["c"])(t,e).pop()})},a.getSubMenuOrItem=function(e){if(e.children&&!e.hideChildrenInMenu&&e.children.some(function(e){return e.name})){var t=e.name;return v.a.createElement(D,{title:e.icon?v.a.createElement("span",null,v.a.createElement("span",{className:"sidemenu-icon"},e.icon),v.a.createElement("span",{className:"sidemenu-text"},t)):t,key:e.path},a.getNavMenuItems(e.children))}return v.a.createElement(g["a"].Item,{key:e.path},a.getMenuItemPath(e))},a.getMenuItemPath=function(e){var t=e.name,n=a.conversionPath(e.path),r=V(e.icon),o=e.target;if(/^https?:\/\//.test(n))return v.a.createElement("a",{href:n,target:o},r,v.a.createElement("span",null,t));var l=a.props,i=l.location,c=l.isMobile,s=l.onCollapse;return v.a.createElement(C.a,{to:n,target:o,replace:n===i.pathname,onClick:c?function(){s(!0)}:void 0},r,v.a.createElement("span",null,t))},a.conversionPath=function(e){return e&&0===e.indexOf("http")?e:"/".concat(e||"").replace(/\/+/g,"/")},a}return y()(t,e),d()(t,[{key:"render",value:function(){var e=this.props,t=e.openKeys,a=e.theme,n=e.mode,o=e.location.pathname,i=e.className,c=e.collapsed,s=this.getSelectedMenuKeys(o);!s.length&&t&&(s=[t[t.length-1]]);var d={};t&&!c&&(d={openKeys:0===t.length?l()(s):t});var u=this.props,p=u.handleOpenChange,m=u.style,h=u.menuData,f=S()(i,{"top-nav-menu":"horizontal"===n});return v.a.createElement(g["a"],r()({key:"Menu",mode:n,theme:a,onOpenChange:p,selectedKeys:s,style:m,className:f},d),this.getNavMenuItems(h))}}]),t}(b["PureComponent"])},pMM0:function(e,t,a){"use strict";a.d(t,"b",function(){return l}),a.d(t,"c",function(){return i}),a.d(t,"a",function(){return c});var n=a("bALw"),r=a.n(n),o=a("S/9j"),l=function e(t){var a=[];return t.forEach(function(t){a.push(t.path),t.children&&(a=a.concat(e(t.children)))}),a},i=function(e,t){return e.filter(function(e){return!!e&&r()(e).test(t)})},c=function(e){var t=e.location.pathname,a=e.flatMenuKeys;return Object(o["a"])(t).map(function(e){return i(a,e)[0]}).filter(function(e){return e})}},qcUQ:function(e,t,a){"use strict";a.r(t);a("2qtc");var n,r,o,l,i=a("kLXV"),c=(a("IzEo"),a("bx4M")),s=(a("+L6B"),a("2/Rp")),d=(a("5NDa"),a("5rEg")),u=a("jehZ"),p=a.n(u),m=(a("miYZ"),a("tsqr")),h=a("p0pE"),f=a.n(h),y=a("d6i3"),w=a.n(y),g=a("1l/V"),b=a.n(g),v=a("2Taf"),x=a.n(v),S=a("vZ4D"),_=a.n(S),C=a("l4Ni"),E=a.n(C),k=a("ujKo"),L=a.n(k),M=a("MhPg"),O=a.n(M),D=(a("OaEy"),a("2fM7")),V=(a("y8nQ"),a("Vl3Y")),I=a("q1tI"),T=a.n(I),F=a("MuoO"),N=a("wd/R"),A=a.n(N),R=a("B797"),z=a("CkN6"),H=a("82qg"),P=a("SLv7"),Y=a.n(P),j=a("XS0u"),B=V["a"].Item,q=D["a"].Option,K=(n=Object(F["connect"])(function(e){var t=e.common,a=e.customer,n=e.company,r=e.unsettlegoods,o=e.site,l=e.car,i=e.receiver,c=e.loading;return{common:t,customer:a,company:n,unsettlegoods:r,site:o,car:l,receiver:i,loading:c.models.rule}}),r=V["a"].create(),n(o=r((l=function(e){function t(){var e,a;x()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=E()(this,(e=L()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,settleModalVisible:!1,signModalVisible:!1,cancelSignModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1,currentCompany:{},currentShipSite:{}},a.columns=[{title:"\u8d27\u5355\u53f7",width:"80px",dataIndex:"order_code",sorter:!0,align:"right",render:function(e){return"".concat(e)},needTotal:!0},{title:"\u53d1\u8d27\u5ba2\u6237",width:"80px",dataIndex:"sendcustomer_name",sorter:!0},{title:"\u6536\u83b7\u5ba2\u6237",width:"80px",dataIndex:"getcustomer_name",sorter:!0},{title:"\u5e94\u6536\u8d27\u6b3e",width:"80px",dataIndex:"order_amount",sorter:!0},{title:"\u5b9e\u6536\u8d27\u6b3e",width:"80px",dataIndex:"order_real"},{title:"\u6298\u540e\u8fd0\u8d39",width:"80px",dataIndex:"trans_discount",sorter:!0},{title:"\u8fd0\u8d39\u65b9\u5f0f",width:"80px",dataIndex:"trans_type",sorter:!0,render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t}},{title:"\u57ab\u4ed8",width:"80px",dataIndex:"order_advancepay_amount"},{title:"\u9001\u8d27\u8d39",width:"80px",dataIndex:"deliver_amount"},{title:"\u4fdd\u4ef7\u8d39",width:"80px",dataIndex:"insurance_fee"},{title:"\u8d27\u7269\u540d\u79f0",width:"150px",dataIndex:"order_name"},{title:"\u5f55\u7968\u65f6\u95f4",width:"170px",dataIndex:"create_date",render:function(e){return T.a.createElement("span",null,e&&A()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}},{title:"\u6ede\u7eb3\u91d1",width:"80px",dataIndex:"late_fee"},{title:"\u8d27\u8f66\u7f16\u53f7",width:"80px",dataIndex:"car_code"},{title:"\u7ad9\u70b9",width:"80px",dataIndex:"site_name"},{title:"\u4e2d\u8f6c",width:"80px",dataIndex:"transfer_type",render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t}},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.setCurrentCompany=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 2==j["a"].company_type?(a.setState({currentCompany:j["a"]}),j["a"]):e&&e.length>0?(a.setState({currentCompany:e[0]}),e[0]):{}},a.handleFormReset=function(){var e=a.props,t=e.form,n=e.dispatch;t.resetFields(),a.setState({formValues:{}}),n({type:"rule/fetch",payload:{}})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onGetCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchGetCustomerList()},a.onSendCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchSendCustomerList()},a.fetchGetCustomerList=function(){var e=b()(w.a.mark(function e(t){var n,r,o,l;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props,r=n.dispatch,o=n.branchCompanyList,l=a.state.currentCompany,l&&l.company_id||(l=o&&o[0]),r({type:"customer/getCustomerListAction",payload:{filter:{company_id:t||l&&l.company_id||0}}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchSendCustomerList=function(){var e=b()(w.a.mark(function e(t){var n;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/sendCustomerListAction",payload:{filter:{}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=b()(w.a.mark(function e(t,n){var r,o,l,i;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,o=r.dispatch,l=r.company.branchCompanyList,r.car.lastCar,o({type:"customer/resetCustomerPageNo",payload:{type:"Get"}}),a.fetchGetCustomerList(t),i=l.filter(function(e){if(e.company_id==t)return e}),i.length>0&&a.setState({currentCompany:i[0]});case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(n,o){if(!n){o.order_amount=-1,o.order_amount=-1;var l=Object.assign({filter:o},e);r({type:"unsettlegoods/getOrderListAction",payload:f()({pageNo:t||i,pageSize:c},l)}),r({type:"unsettlegoods/getOrderStatisticAction",payload:f()({},l)}),a.standardTable.cleanSelectedKeys()}})},a.handleStandardTableChange=function(){var e=b()(w.a.mark(function e(t,n,r){var o,l,i,c;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onSignOk=b()(w.a.mark(function e(){var t,n,r,o;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"unsettle/signAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(m["a"].success("\u7b7e\u5b57\u6210\u529f\uff01"),a.handleSearch(),a.onSignCancel()):m["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onSign=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({signModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onSignCancel=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({signModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettle=b()(w.a.mark(function e(){var t,n;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=a.state.selectedRows,n=Object(R["a"])(t),a.setState({accountStatistic:n,settleModalVisible:!0});case 3:case"end":return e.stop()}},e)})),a.onSettleCancel=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({settleModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettleOk=b()(w.a.mark(function e(){var t,n,r,o;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"unsettle/settleOrderAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(m["a"].success("\u6838\u5bf9\u6210\u529f\uff01"),a.onSettleCancel(),a.handleSearch()):m["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onCancelSign=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelSignModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onCancelSignCancel=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelSignModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelSignOk=b()(w.a.mark(function e(){var t,n,r,o;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"unsettle/cancelSignAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(m["a"].success("\u53d6\u6d88\u7b7e\u5b57\u6210\u529f\uff01"),a.handleSearch(),a.onCancelSignCancel()):m["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onPrint=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=b()(w.a.mark(function e(){var t,n,r;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"unsettlegoods/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(m["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):m["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=b()(w.a.mark(function e(){return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=b()(w.a.mark(function e(){var t,n,r;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"unsettle/downloadAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(m["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):m["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onUpdateOrderModalShow()},a.onRowClick=function(e,t,a){},a.onRefTable=function(e){a.standardTable=e},a.tableFooter=function(){var e=a.props.unsettlegoods,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=e.totalInsurancefee,l=e.totalAdvancepayAmount,i=e.totalDeliverAmount;return T.a.createElement("div",{className:Y.a.tableFooter},T.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),T.a.createElement("span",{className:Y.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),T.a.createElement("span",{className:Y.a.footerSplit},"\u57ab\u4ed8\u603b\u989d\uff1a",l||"0"),T.a.createElement("span",{className:Y.a.footerSplit},"\u9001\u8d27\u8d39\u603b\u989d\uff1a",i||"0"),T.a.createElement("span",{className:Y.a.footerSplit},"\u4fdd\u4ef7\u8d39\u603b\u989d\uff1a",o||"0"),T.a.createElement("span",{className:Y.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return O()(t,e),_()(t,[{key:"componentDidMount",value:function(){var e=b()(w.a.mark(function e(){var t,a,n,r,o;return w.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,t({type:"company/getBranchCompanyList",payload:f()({},j["a"])});case 3:return a=e.sent,e.next=6,t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100}});case 6:n=e.sent,t({type:"customer/sendCustomerListAction",payload:{pageNo:1,pageSize:100}}),r=this.setCurrentCompany(a),t({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:r.company_id}}}),n&&n.length>0&&(o=n.filter(function(e){return 3==e.site_type||2==e.site_type}),o.length>0&&this.setState({currentShipSite:o[0]})),t({type:"common/initOrderListAction"});case 12:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.customer,n=a.getCustomerList,r=a.sendCustomerList,o=e.company.branchCompanyList,l=e.site.entrunkSiteList,i=(this.state.currentShipSite,{}),c={};o.length>0&&1!=j["a"].company_type&&(c.initialValue=o[0].company_id||"");var u=1==j["a"].company_type;return T.a.createElement(V["a"],{onSubmit:this.handleSearch,layout:"inline"},T.a.createElement(B,p()({label:"\u5206\u516c\u53f8"},i),t("company_id",c)(T.a.createElement(D["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"},allowClear:u},o.map(function(e){return T.a.createElement(q,{key:e.company_id,value:e.company_id},e.company_name)})))),T.a.createElement(B,p()({label:"\u8fd0\u5355\u53f7"},i),t("order_code",{})(T.a.createElement(d["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),T.a.createElement(B,p()({label:"\u8d27\u8f66\u7f16\u53f7"},i),t("shipsite_id",{})(T.a.createElement(D["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onShipSiteSelect,style:{width:"100px"},allowClear:!0},(l||[]).map(function(e){return T.a.createElement(q,{key:e.site_id,value:e.site_id},e.site_name)}))),t("car_code",{})(T.a.createElement(d["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"80px"}}))),T.a.createElement(B,p()({label:"\u6536\u8d27\u4eba\u59d3\u540d"},i),t("getcustomer_id")(T.a.createElement(D["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onGetCustomerSelect,style:{width:"100px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onGetCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map(function(e){return T.a.createElement(q,{key:e.customer_id,value:e.customer_id},e.customer_name)})))),T.a.createElement(B,p()({label:"\u6536\u8d27\u4eba\u7535\u8bdd"},i),t("getcustomer_mobile",{})(T.a.createElement(d["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),T.a.createElement(B,p()({label:"\u53d1\u8d27\u4eba\u59d3\u540d"},i),t("sendcustomer_id")(T.a.createElement(D["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSendCustomerSelect,style:{width:"100px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onSendCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},r.map(function(e){return T.a.createElement(q,{key:e.get,value:e.customer_id},e.customer_name)})))),T.a.createElement(B,p()({label:"\u6536\u8d27\u4eba\u7535\u8bdd"},i),t("sendcustomer_mobile",{})(T.a.createElement(d["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),T.a.createElement(V["a"].Item,p()({},i,{className:Y.a.tableListOperator}),T.a.createElement(s["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),T.a.createElement(s["a"],{onClick:this.onDownload},"\u4e0b\u8f7d")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.unsettlegoods,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.company.branchCompanyList,t.car),l=(o.carList,o.lastCar,t.loading),s=this.state,d=s.selectedRows,u=s.accountStatistic,p=s.current,m=s.pageSize,h=s.updateOrderModalVisible,f=s.settleModalVisible,y=s.signModalVisible,w=s.cancelSignModalVisible,g=s.downloadModalVisible,b=s.printModalVisible,v=s.record;return T.a.createElement("div",null,T.a.createElement(c["a"],{bordered:!1},T.a.createElement("div",{className:Y.a.tableList},T.a.createElement("div",{className:Y.a.tableListForm},this.renderForm()),T.a.createElement(z["a"],{onRef:this.onRefTable,selectedRows:d,loading:l,className:Y.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:m,current:p,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,rowClassNameHandler:function(e,t){return 1==e.sign_status?Y.a.signColor:""}})),this.tableFooter()),T.a.createElement(H["a"],{modalVisible:h,record:v,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch}),T.a.createElement(i["a"],{title:"\u786e\u8ba4\u7ed3\u8d26",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:f,onOk:this.onSettleOk,onCancel:this.onSettleCancel},T.a.createElement("p",null,"\u7ed3\u7b97\u8d27\u6b3e\u6761\u6570".concat(d.length,"\uff0c\u7ed3\u7b97\u603b\u989d ").concat(u.totalAccount," ")),T.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u4e48\uff1f")),T.a.createElement(i["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:y,onOk:this.onSignOk,onCancel:this.onSignCancel},T.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7b7e\u5b57\u4e48\uff1f")),T.a.createElement(i["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:w,onOk:this.onCancelSignOk,onCancel:this.onCancelSignCancel},T.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u7b7e\u5b57\u4e48\uff1f")),T.a.createElement(i["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:b,onOk:this.onPrintOk,onCancel:this.onPrintCancel},T.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),T.a.createElement(i["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:g,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},T.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(I["PureComponent"]),o=l))||o)||o);t["default"]=K},rDVw:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i=a("bx4M"),c=(a("+L6B"),a("2/Rp")),s=(a("iQDF"),a("+eQT")),d=a("p0pE"),u=a.n(d),p=a("d6i3"),m=a.n(p),h=a("1l/V"),f=a.n(h),y=a("2Taf"),w=a.n(y),g=a("vZ4D"),b=a.n(g),v=a("l4Ni"),x=a.n(v),S=a("ujKo"),_=a.n(S),C=a("MhPg"),E=a.n(C),k=(a("OaEy"),a("2fM7")),L=(a("y8nQ"),a("Vl3Y")),M=a("q1tI"),O=a.n(M),D=a("MuoO"),V=a("wd/R"),I=a.n(V),T=(a("B797"),a("CkN6")),F=(a("82qg"),a("LTkr")),N=a.n(F),A=(a("S+eF"),a("XS0u")),R=L["a"].Item,z=k["a"].Option,H=(n=Object(D["connect"])(function(e){var t=e.customer,a=e.company,n=e.courier,r=e.site,o=e.search,l=e.receiver,i=e.loading;return{customer:t,company:a,courier:n,site:r,search:o,receiver:l,loading:i.models.rule}}),r=L["a"].create(),n(o=r((l=function(e){function t(){var e,a;w()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=x()(this,(e=_()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,settleModalVisible:!1,downModalVisible:!1,signModalVisible:!1,cancelDownAccountModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1,currentCompany:{}},a.columns=[{title:"\u6536\u652f",dataIndex:"account_type",width:"80px",render:function(e){return 0==e?"\u652f\u51fa":"\u6536\u5165"}},{title:"\u7c7b\u578b\u9879\u76ee",dataIndex:"account_name",width:"150px"},{title:"\u539f\u56e0",dataIndex:"account_reason",width:"100px"},{title:"\u91d1\u989d",dataIndex:"account_amount",width:"80px"},{title:"\u7528\u6237\u540d",dataIndex:"operator_name",width:"80px"},{title:"\u7ad9\u70b9",dataIndex:"site_name",width:"100px"},{title:"\u5206\u516c\u53f8",dataIndex:"company_name",width:"80px"},{title:"\u65e5\u671f",dataIndex:"account_date",width:"170px",render:function(e){return O.a.createElement("span",null,e&&I()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")}}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchCompanySiteList=f()(m.a.mark(function e(){var t;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,e.next=3,t({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:A["a"].company_id}}});case 3:case"end":return e.stop()}},e)})),a.fetchOperatorList=function(){var e=f()(m.a.mark(function e(t){var n,r,o;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=a.state.currentSite,o={},o.company_id=A["a"].company_id,r&&r.site_id&&(o.site_id=r.site_id),e.next=7,n({type:"courier/getOperatorListAction",payload:{pageNo:1,pageSize:100,filter:o}});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchGetCustomerList=function(){var e=f()(m.a.mark(function e(t){var n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=f()(m.a.mark(function e(t,a){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){n.account_date&&n.account_date.valueOf&&(n.account_date=["".concat(n.account_date.valueOf())]),n.company_id=A["a"].company_id,1==A["a"].company_type&&(n.site_id=A["c"].site_id);var o=Object.assign({filter:n},e);r({type:"search/getTodayAccountListAction",payload:u()({pageNo:t||i,pageSize:c},o)}),r({type:"search/getTodayAccountStatisticAction",payload:u()({},o)})}})},a.handleStandardTableChange=function(){var e=f()(m.a.mark(function e(t,n,r){var o,l,i,c;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.onRowDoubleClick=function(e,t,n){a.setState({record:e})},a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.search,t=e.accountTotal,n=e.totalAccount,r=e.totalIncomeAccount,o=e.totalExpenseAccount;return O.a.createElement("div",{className:N.a.tableFooter},O.a.createElement("span",null,"\u603b\u989d\uff1a",n||"0"),O.a.createElement("span",{className:N.a.footerSplit},"\u6536\u5165\u603b\u989d\uff1a",r||"0"),O.a.createElement("span",{className:N.a.footerSplit},"\u652f\u51fa\u603b\u989d\uff1a",o||"0"),O.a.createElement("span",{className:N.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return E()(t,e),b()(t,[{key:"componentDidMount",value:function(){var e=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.props.dispatch,e.next=3,this.fetchCompanySiteList();case 3:return e.next=5,this.fetchOperatorList();case 5:this.getOrderList();case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=(a.siteList,a.normalSiteList,e.courier.operatorList),r=void 0===n?[]:n,o={initialValue:A["a"].company_id||""};return O.a.createElement(L["a"],{onSubmit:this.handleSearch,layout:"inline"},2==A["a"].company_type&&O.a.createElement(R,{label:"\u5206\u516c\u53f8"},t("company_id",o)(O.a.createElement(k["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"200px"}},[A["a"]].map(function(e){return O.a.createElement(z,{key:e.company_id,value:e.company_id},e.company_name)})))),1==A["a"].company_type&&O.a.createElement(R,{label:"\u7ad9\u70b9"},t("site_id",{initialValue:A["c"].site_id})(O.a.createElement(k["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"}},[A["c"]].map(function(e){return O.a.createElement(z,{key:e.site_id,value:e.site_id},e.site_name)})))),O.a.createElement(R,{label:"\u7ecf\u529e\u4eba"},t("operator_id",{})(O.a.createElement(k["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"150px"},allowClear:!0},r.map(function(e){return O.a.createElement(z,{key:e.user_id,value:e.user_id},e.user_name)})))),O.a.createElement(R,{label:"\u65e5\u671f"},t("account_date",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u65e5\u671f"}],initialValue:I()((new Date).getTime())})(O.a.createElement(s["a"],{placeholder:"\u8bf7\u9009\u62e9",format:"YYYY-MM-DD",style:{width:"100%"}}))),O.a.createElement(R,null,O.a.createElement(c["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.search,n=a.accounts,r=a.accountTotal,o=t.loading,l=this.state,c=l.selectedRows,s=l.current,d=l.pageSize;return O.a.createElement("div",null,O.a.createElement(i["a"],{bordered:!1},O.a.createElement("div",{className:N.a.tableList},O.a.createElement("div",{className:N.a.tableListForm},this.renderForm()),O.a.createElement(T["a"],{selectedRows:c,loading:o,className:N.a.dataTable,scroll:{x:900,y:350},rowKey:"account_id",data:{list:n,pagination:{total:r,pageSize:d,current:s,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick})),this.tableFooter()))}}]),t}(M["PureComponent"]),o=l))||o)||o);t["default"]=H},rRaJ:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("miYZ"),a("tsqr")),p=a("d6i3"),m=a.n(p),h=a("1l/V"),f=a.n(h),y=(a("2qtc"),a("kLXV")),w=(a("14J3"),a("BMrR")),g=(a("jCWc"),a("kPKH")),b=a("jehZ"),v=a.n(b),x=(a("5NDa"),a("5rEg")),S=(a("+L6B"),a("2/Rp")),_=(a("O3gP"),a("lrIw")),C=a("2Taf"),E=a.n(C),k=a("vZ4D"),L=a.n(k),M=a("l4Ni"),O=a.n(M),D=a("ujKo"),V=a.n(D),I=a("MhPg"),T=a.n(I),F=(a("OaEy"),a("2fM7")),N=(a("y8nQ"),a("Vl3Y")),A=(a("iQDF"),a("+eQT")),R=a("q1tI"),z=a.n(R),H=a("MuoO"),P=(a("wd/R"),a("CkN6")),Y=a("9yR7"),j=a.n(Y),B=a("XS0u"),q=(A["a"].RangePicker,N["a"].Item),K=F["a"].Option,U=(n=N["a"].create(),n((o=function(e){function t(e){var a;return E()(this,t),a=O()(this,V()(t).call(this,e)),a.onAbnormalSelect=function(e,t){},a.onAddHandler=function(){var e=a.props,t=e.addFormDataHandle,n=e.form,r=e.record,o=void 0===r?{}:r;n.validateFields(function(e,a){if(!e){var n={courier:a};o.courier_id&&(n.ids=[o.courier_id],a.courier_id=o.courier_id),t(n)}})},a.renderCustomerOption=function(e){var t=_["a"].Option;return z.a.createElement(t,{key:e.expensetype_id,expensetype_id:e.expensetype_id,text:e.expensetype},e.expensetype)},a.state={abnormal_type_id:"",abnormal_type:""},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return T()(t,e),L()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelHandler,n=e.record,r=e.form;e.roleList;return z.a.createElement(y["a"],{destroyOnClose:!0,title:"\u6dfb\u52a0\u63a5\u8d27\u4eba",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[z.a.createElement(S["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),z.a.createElement(S["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:j.a.modalForm},z.a.createElement(N["a"],null,z.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(g["a"],null,z.a.createElement(q,v()({},this.formItemLayout,{label:"\u59d3\u540d"}),r.getFieldDecorator("courier_name",{initialValue:n.courier_name,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u59d3\u540d"}]})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),z.a.createElement(w["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(g["a"],null,z.a.createElement(q,v()({},this.formItemLayout,{label:"\u7535\u8bdd"}),r.getFieldDecorator("courier_mobile",{initialValue:n.courier_mobile,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7535\u8bdd"}]})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}})))))))}}]),t}(R["PureComponent"]),r=o))||r),Z=(l=Object(H["connect"])(function(e){var t=e.customer,a=e.courier,n=e.site,r=e.company,o=e.loading;return{customer:t,courier:a,site:n,company:r,loading:o.models.rule}}),i=N["a"].create(),l(c=i((s=function(e){function t(){var e,a;E()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=O()(this,(e=V()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],formValues:{},current:1,pageSize:20,record:{},currentCompany:{},currentSite:{},addModalVisible:!1},a.columns=[{title:"\u59d3\u540d",dataIndex:"courier_name",width:"100px"},{title:"\u7528\u6237\u7535\u8bdd",dataIndex:"courier_mobile",width:"150px"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchCompanySiteList=function(){var e=f()(m.a.mark(function e(t){var n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:B["a"].company_id}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchGetCustomerList=function(){var e=f()(m.a.mark(function e(t){var n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=f()(m.a.mark(function e(t,n){var r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,o=r.company.companyList,r.form,a.fetchCompanySiteList(t),l=o.filter(function(e){if(e.company_id==t)return e}),l.length>0&&a.setState({currentCompany:l[0]});case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onSiteSelect=function(){var e=f()(m.a.mark(function e(t,n){var r,o,l;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.site.siteList,o=void 0===r?[]:r,l=o.filter(function(e){if(e.site_id==t)return e}),l.length>0&&a.setState({currentSite:l[0]});case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=a.props,n=t.dispatch,r=t.form,o=a.state,l=o.current,i=o.pageSize,c=o.currentSite;r.validateFields(function(t,a){if(!t){var r={company_id:B["a"].company_id};c&&c.site_id&&(r.site_id=c.site_id),n({type:"courier/getCourierListAction",payload:{pageNo:e||l,pageSize:i,type:"receiver",filter:r}})}})},a.handleStandardTableChange=function(){var e=f()(m.a.mark(function e(t,n,r){var o,l,i,c;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.addFormDataHandle=function(){var e=f()(m.a.mark(function e(t){var n,r,o,l,i,c,s;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=t.courier,r=void 0===n?{}:n,o=t.ids,l=a.props.dispatch,i=a.state.currentSite,c=void 0===i?{}:i,r.company_id||(r.company_id=B["a"].company_id),!r.site_id&&c.site_id&&(r.site_id=c.site_id,r.site_name=c.site_name),e.next=7,l({type:"courier/updateCourierAction",payload:{courier:r,ids:o,type:"receiver"}});case 7:s=e.sent,s&&0==s.code?(u["a"].success("\u6dfb\u52a0\u6210\u529f\uff01"),a.handleSearch(),a.onCancelModalClick()):u["a"].error(s&&s.msg||"\u6dfb\u52a0\u5931\u8d25");case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onAddClick=f()(m.a.mark(function e(){var t,n;return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.currentSite,n=void 0===t?{}:t,n.site_id){e.next=4;break}return u["a"].info("\u8bf7\u9009\u62e9\u7ad9\u70b9"),e.abrupt("return");case 4:a.setState({addModalVisible:!0,record:{}});case 5:case"end":return e.stop()}},e)})),a.onCancelModalClick=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onModalShow=function(){a.setState({addModalVisible:!0})},a.onModalCancel=function(){a.setState({addModalVisible:!1})},a.onSiteChange=function(e){e||a.setState({currentSite:{}})},a.onCompanyChange=function(e){console.log("company",e),e||a.setState({currentCompany:{}})},a.onRowClick=function(e,t,a){},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onModalShow()},a}return T()(t,e),L()(t,[{key:"componentDidMount",value:function(){var e=f()(m.a.mark(function e(){return m.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.fetchCompanySiteList();case 1:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"render",value:function(){var e=this,t=this.props,a=t.site.siteList,n=t.courier,r=n.receiverList,o=n.receiverTotal,l=t.loading,i=this.state,c=i.selectedRows,s=i.current,u=i.pageSize,p=i.addModalVisible,m=i.record,h=(i.currentCompany,!0);return["site_searchuser"].indexOf(B["b"].role_value)>=0&&(h=!1),z.a.createElement("div",null,z.a.createElement(d["a"],{bordered:!1},z.a.createElement("div",{className:j.a.tableList},z.a.createElement("div",{className:j.a.tableListOperator},z.a.createElement(N["a"],{onSubmit:this.handleSearch,layout:"inline"},z.a.createElement(q,{label:"\u7ad9\u70b9"},z.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSiteSelect,onChange:this.onSiteChange,style:{width:"150px"},allowClear:!0},a.map(function(e){return z.a.createElement(K,{key:e.site_id,value:e.site_id},e.site_name)}))),z.a.createElement(q,null,z.a.createElement(S["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")),z.a.createElement(q,null,h&&z.a.createElement(S["a"],{icon:"plus",type:"primary",onClick:function(){return e.onAddClick(!0)}},"\u6dfb\u52a0")))),z.a.createElement(P["a"],{selectedRows:c,loading:l,className:j.a.dataTable,scroll:{x:900,y:350},rowKey:"courier_id",data:{list:r,pagination:{total:o,pageSize:u,current:s,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick}))),z.a.createElement(U,{modalVisible:p,addFormDataHandle:this.addFormDataHandle,onCancelHandler:this.onCancelModalClick,record:m,selectedRows:c}))}}]),t}(R["PureComponent"]),c=s))||c)||c);t["default"]=Z},rZM1:function(e,t,a){e.exports={standardTable:"antd-pro-components-standard-table-index-standardTable",tableAlert:"antd-pro-components-standard-table-index-tableAlert"}},s4P5:function(e,t,a){e.exports={modalForm:"antd-pro-components-edit-order-form-index-modalForm"}},sOv7:function(e,t,a){e.exports={"antd-pro-components-global-header-index-header":"antd-pro-pages-customer-customer-antd-pro-components-global-header-index-header",tableList:"antd-pro-pages-customer-customer-tableList",tableListOperator:"antd-pro-pages-customer-customer-tableListOperator",tableFooter:"antd-pro-pages-customer-customer-tableFooter",footerSplit:"antd-pro-pages-customer-customer-footerSplit",signColor:"antd-pro-pages-customer-customer-signColor",settleColor:"antd-pro-pages-customer-customer-settleColor",payColor:"antd-pro-pages-customer-customer-payColor",selectedColor:"antd-pro-pages-customer-customer-selectedColor",tableDetail:"antd-pro-pages-customer-customer-tableDetail",modalForm:"antd-pro-pages-customer-customer-modalForm",formItemFloat:"antd-pro-pages-customer-customer-formItemFloat",tableListForm:"antd-pro-pages-customer-customer-tableListForm",submitButtons:"antd-pro-pages-customer-customer-submitButtons",dataTable:"antd-pro-pages-customer-customer-dataTable","ant-form-item":"antd-pro-pages-customer-customer-ant-form-item","ant-select":"antd-pro-pages-customer-customer-ant-select",formItemNoBreak:"antd-pro-pages-customer-customer-formItemNoBreak"}},tbSg:function(e,t,a){e.exports={pageHeader:"antd-pro-components-page-header-index-pageHeader",wide:"antd-pro-components-page-header-index-wide",detail:"antd-pro-components-page-header-index-detail",row:"antd-pro-components-page-header-index-row",breadcrumb:"antd-pro-components-page-header-index-breadcrumb",tabs:"antd-pro-components-page-header-index-tabs",logo:"antd-pro-components-page-header-index-logo",title:"antd-pro-components-page-header-index-title",action:"antd-pro-components-page-header-index-action",content:"antd-pro-components-page-header-index-content",extraContent:"antd-pro-components-page-header-index-extraContent",main:"antd-pro-components-page-header-index-main"}},y2NC:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("miYZ"),a("tsqr")),p=a("p0pE"),m=a.n(p),h=(a("2qtc"),a("kLXV")),f=(a("14J3"),a("BMrR")),y=(a("jCWc"),a("kPKH")),w=a("jehZ"),g=a.n(w),b=(a("5NDa"),a("5rEg")),v=(a("+L6B"),a("2/Rp")),x=(a("O3gP"),a("lrIw")),S=a("d6i3"),_=a.n(S),C=a("1l/V"),E=a.n(C),k=a("2Taf"),L=a.n(k),M=a("vZ4D"),O=a.n(M),D=a("l4Ni"),V=a.n(D),I=a("ujKo"),T=a.n(I),F=a("MhPg"),N=a.n(F),A=(a("OaEy"),a("2fM7")),R=(a("y8nQ"),a("Vl3Y")),z=(a("iQDF"),a("+eQT")),H=a("q1tI"),P=a.n(H),Y=a("MuoO"),j=a("wd/R"),B=a.n(j),q=a("CkN6"),K=a("KbBV"),U=a.n(K),Z=a("XS0u"),G=z["a"].RangePicker,Q=R["a"].Item,X=A["a"].Option,W=(n=R["a"].create(),n((o=function(e){function t(e){var a;return L()(this,t),a=V()(this,T()(t).call(this,e)),a.onAbnormalSelect=function(e,t){a.setState({abnormal_type_id:t.props.abnormal_type_id,abnormal_type:t.props.text})},a.onAddHandler=function(){var e=a.props,t=e.addFormDataHandle,n=e.form,r=e.expenseTypes,o=void 0===r?[]:r,l=e.record;n.validateFields(function(){var e=E()(_.a.mark(function e(a,r){var i,c;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=2;break}return e.abrupt("return");case 2:return i=!0,c="",o.forEach(function(e){e.expensetype_id==r["expensetype_id"]&&(i=!1,c=e.expensetype)}),e.next=7,t({expense_id:l.expense_id||0,expense_money:Number(r.expense_money),expensetype_id:i?"":r.expensetype_id,expensetype:i?r.expensetype_id:c,expense_reason:r.expense_reason,remark:r.expense_reason});case 7:l.expense_id||n.setFieldsValue({expense_money:"",expense_reason:"",remark:""});case 8:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a.renderCustomerOption=function(e){var t=x["a"].Option;return P.a.createElement(t,{key:e.expensetype_id,expensetype_id:e.expensetype_id,value:"".concat(e.expensetype_id),text:e.expensetype},e.expensetype)},a.state={abnormal_type_id:"",abnormal_type:""},a.formItemLayout={labelCol:{xs:{span:18},sm:{span:5}},wrapperCol:{xs:{span:18},sm:{span:8}}},a}return N()(t,e),O()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.onCancelHandler,n=e.record,r=e.form,o=e.expenseTypes,l=void 0===o?[]:o;return P.a.createElement(h["a"],{destroyOnClose:!0,title:"\u6dfb\u52a0\u652f\u51fa",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[P.a.createElement(v["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),P.a.createElement(v["a"],{key:"btn-save",type:"primary",onClick:this.onAddHandler},"\u4fdd \u5b58")],width:800,className:U.a.modalForm},P.a.createElement(R["a"],null,P.a.createElement(f["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(y["a"],null,P.a.createElement(Q,g()({},this.formItemLayout,{label:"\u652f\u51fa\u91d1\u989d"}),r.getFieldDecorator("expense_money",{initialValue:n.expense_money,rules:[{required:!0,message:"\u8bf7\u586b\u5199\u652f\u51fa\u91d1\u989d"}]})(P.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),P.a.createElement(f["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(y["a"],null,P.a.createElement(Q,g()({},this.formItemLayout,{label:"\u652f\u51fa\u7c7b\u578b"}),r.getFieldDecorator("expensetype_id",{initialValue:"".concat(n.expensetype_id||""),rules:[{required:!0,message:"\u8bf7\u586b\u5199\u652f\u51fa\u7c7b\u578b"}]})(P.a.createElement(x["a"],{size:"large",style:{width:"280px"},dataSource:l.map(this.renderCustomerOption),placeholder:"\u8bf7\u8f93\u5165",optionLabelProp:"text",allowClear:!0}," "))))),P.a.createElement(f["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(y["a"],null,P.a.createElement(Q,g()({},this.formItemLayout,{label:"\u652f\u51fa\u539f\u56e0"}),r.getFieldDecorator("expense_reason",{initialValue:n.expense_reason})(P.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),P.a.createElement(f["a"],{gutter:{md:8,lg:24,xl:48}},P.a.createElement(y["a"],null,P.a.createElement(Q,{labelCol:{span:3,offset:2},label:"\u5907\u6ce8"},r.getFieldDecorator("remark",{initialValue:n.remark})(P.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}})))))))}}]),t}(H["PureComponent"]),r=o))||r),J=(l=Object(Y["connect"])(function(e){var t=e.customer,a=e.company,n=e.expense,r=e.site,o=e.car,l=e.receiver,i=e.loading;return{customer:t,company:a,expense:n,site:r,car:o,receiver:l,loading:i.models.rule}}),i=R["a"].create(),l(c=i((s=function(e){function t(){var e,a;L()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=V()(this,(e=T()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},currentCompany:{},currentSite:{},settleModalVisible:!1,addExpenseModalVisible:!1,signModalVisible:!1,cancelSignModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1},a.columns=[{title:"\u652f\u51fa\u65e5\u671f",dataIndex:"expense_date",width:"170px",sorter:!0,render:function(e){return P.a.createElement("span",null,e&&B()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss"))}},{title:"\u652f\u51fa\u91d1\u989d",dataIndex:"expense_money",sorter:!0,width:"80px"},{title:"\u652f\u51fa\u7c7b\u578b",dataIndex:"expensetype",width:"140px",sorter:!0},{title:"\u652f\u51fa\u539f\u56e0",dataIndex:"expense_reason",width:"120px",sorter:!0},{title:"\u7ad9\u70b9",dataIndex:"site_name",width:"80px"},{title:"\u5206\u516c\u53f8",dataIndex:"company_name",width:"80px",sorter:!0},{title:"\u64cd\u4f5c\u7528\u6237",dataIndex:"operator_name",width:"80px"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.fetchExpenseTypeList=E()(_.a.mark(function e(){var t,n,r;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n={},n.company_id=Z["a"].company_id||-1,1==Z["a"].company_type&&(n.site_id=Z["c"].site_id),e.next=6,t({type:"expense/getExpenseTypesAction",payload:n});case 6:return r=e.sent,e.abrupt("return",r);case 8:case"end":return e.stop()}},e)})),a.fetchCompanySiteList=function(){var e=E()(_.a.mark(function e(t){var n;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"site/getSiteListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchGetCustomerList=function(){var e=E()(_.a.mark(function e(t){var n;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:t}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=E()(_.a.mark(function e(t,n){var r,o,l,i;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,o=r.company.branchCompanyList,l=r.form,a.fetchCompanySiteList(t),a.fetchExpenseTypeList({companyId:t}),l.setFieldsValue({expense_type_id:""}),i=o.filter(function(e){if(e.company_id==t)return e}),i.length>0&&a.setState({currentCompany:i[0]});case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onSiteSelect=function(){var e=E()(_.a.mark(function e(t,n){var r,o,l;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props.site.normalSiteList,o=void 0===r?[]:r,l=o.filter(function(e){if(e.site_id==t)return e}),l.length>0&&a.setState({currentSite:l[0]}),a.fetchExpenseTypeList({siteId:t});case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){n.expense_date&&n.expense_date.length>0&&(n.expense_date=n.expense_date.map(function(e){return"".concat(e.valueOf())})),n.company_id=Z["a"].company_id;var o=Object.assign({filter:n},e);r({type:"expense/getExpensesAction",payload:m()({pageNo:t||i,pageSize:c},o)})}})},a.handleStandardTableChange=function(){var e=E()(_.a.mark(function e(t,n,r){var o,l,i,c;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.addFormDataHandle=function(){var e=E()(_.a.mark(function e(t){var n,r,o;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=a.props.dispatch,r=m()({},t,{company_id:Z["a"].company_id,company_name:Z["a"].company_name}),Z["c"].site_id&&Object.assign(r,{site_id:Z["c"].site_id,site_name:Z["c"].site_name}),e.next=5,n({type:"expense/addExpenseAction",payload:r});case 5:o=e.sent,o&&0==o.code?(u["a"].success(r.expense_id?"\u7f16\u8f91\u6210\u529f\uff01":"\u6dfb\u52a0\u6210\u529f\uff01"),r.expense_id&&a.onCancelExpenseClick()):u["a"].error(o&&o.msg||"\u6dfb\u52a0\u5931\u8d25");case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onAddExpenseClick=E()(_.a.mark(function e(){var t,n;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.currentSite,n=void 0===t?{}:t,1!=Z["a"].company_id||n.site_id){e.next=4;break}return h["a"].info({content:"\u8bf7\u5148\u9009\u62e9\u7ad9\u70b9"}),e.abrupt("return");case 4:if(Z["a"].company_id){e.next=7;break}return h["a"].info({content:"\u8bf7\u5148\u9009\u62e9\u516c\u53f8"}),e.abrupt("return");case 7:a.setState({addExpenseModalVisible:!0,record:{}});case 8:case"end":return e.stop()}},e)})),a.onCancelExpenseClick=E()(_.a.mark(function e(){return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({addExpenseModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onExpenseModalShow=function(){a.setState({addExpenseModalVisible:!0})},a.onExpenseModalCancel=function(){a.setState({addExpenseModalVisible:!1})},a.onSiteChange=function(e){console.log("site",e),e||a.setState({currentSite:{}})},a.onCompanyChange=function(e){console.log("company",e),e||a.setState({currentCompany:{}})},a.onUpdateOrder=function(){var e=E()(_.a.mark(function e(t,n){var r,o;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=a.props.dispatch,console.log(t,n),e.next=4,r({type:"order/updateOrderAction",payload:{orderIds:[t.order_id],order:{trans_real:n.trans_real,order_real:n.order_real}}});case 4:o=e.sent,0==o.code?(u["a"].success("\u4fee\u6539\u6210\u529f\uff01"),a.onExpenseModalCancel()):u["a"].error(o.msg);case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.onRowClick=function(e,t,a){},a.onRowDoubleClick=function(e,t,n){var r=B()(Number(e.expense_date)),o=B()(Number((new Date).getTime())),l=o.diff(r,"hours");l>=24?u["a"].error("\u8d85\u8fc724\u5c0f\u65f6\u8bb0\u5f55\u4e0d\u53ef\u7f16\u8f91"):(a.setState({record:e}),a.onExpenseModalShow())},a.tableFooter=function(){var e=a.props.expense,t=e.total,n=e.totalExpense;return P.a.createElement("div",{className:U.a.tableFooter},P.a.createElement("span",null,"\u652f\u51fa\u603b\u989d\uff1a",n||"0"),P.a.createElement("span",{className:U.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return N()(t,e),O()(t,[{key:"componentDidMount",value:function(){var e=E()(_.a.mark(function e(){var t;return _.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.props.dispatch,e.next=3,this.fetchCompanySiteList(Z["a"].company_id);case 3:return e.next=5,this.fetchExpenseTypeList({});case 5:return e.next=7,t({type:"expense/getExpenseDetailsAction",payload:{}});case 7:this.getOrderList();case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.site,n=(a.entrunkSiteList,a.normalSiteList,e.company.branchCompanyList),r=void 0===n?[]:n,o=e.expense.expenseTypes,l=void 0===o?[]:o,i={};return r.length>0&&(i.initialValue=r[0].company_id||""),P.a.createElement(R["a"],{onSubmit:this.handleSearch,layout:"inline"},1==Z["a"].company_type&&P.a.createElement(Q,{label:"\u7ad9\u70b9"},t("site_id",{initialValue:Z["c"].site_id})(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSiteSelect,onChange:this.onSiteChange,style:{width:"100px"}},[Z["c"]].map(function(e){return P.a.createElement(X,{key:e.site_id,value:e.site_id},e.site_name)})))),P.a.createElement(Q,{label:"\u652f\u51fa\u65e5\u671f"},t("expense_date",{})(P.a.createElement(G,{style:{width:"250px"}}))),P.a.createElement(Q,{label:"\u652f\u51fa\u7c7b\u578b"},t("expensetype_id")(P.a.createElement(A["a"],{placeholder:"\u8bf7\u9009\u62e9",style:{width:"100px"},allowClear:!0},l.map(function(e){return P.a.createElement(X,{key:e.expensetype_id,value:e.expensetype_id},e.expensetype)})))),P.a.createElement(Q,null,P.a.createElement(v["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.expense,n=a.expenseList,r=a.total,o=a.expenseTypes,l=(a.totalExpense,t.loading),i=this.state,c=i.selectedRows,s=i.current,u=i.pageSize,p=i.addExpenseModalVisible,m=i.downloadModalVisible,f=i.printModalVisible,y=i.record,w=!0;return["site_searchuser","site_admin"].indexOf(Z["b"].role_value)>=0&&(w=!1),P.a.createElement("div",null,P.a.createElement(d["a"],{bordered:!1},P.a.createElement("div",{className:U.a.tableList},P.a.createElement("div",{className:U.a.tableListForm},this.renderForm()),P.a.createElement("div",{className:U.a.tableListOperator},w&&P.a.createElement(v["a"],{icon:"plus",type:"primary",onClick:function(){return e.onAddExpenseClick(!0)}},"\u6dfb\u52a0")),P.a.createElement(q["a"],{selectedRows:c,loading:l,className:U.a.dataTable,scroll:{x:900,y:350},rowKey:"expense_id",data:{list:n,pagination:{total:r,pageSize:u,current:s,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick})),this.tableFooter()),P.a.createElement(W,{modalVisible:p,addFormDataHandle:this.addFormDataHandle,onCancelHandler:this.onCancelExpenseClick,expenseTypes:o,record:y,selectedRows:c}),P.a.createElement(h["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:f,onOk:this.onPrintOk,onCancel:this.onPrintCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),P.a.createElement(h["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:m,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},P.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(H["PureComponent"]),c=s))||c)||c);t["default"]=J},zHco:function(e,t,a){"use strict";var n=a("jehZ"),r=a.n(n),o=a("Y/ft"),l=a.n(o),i=a("q1tI"),c=a.n(i),s=a("LLXN"),d=a("wY1l"),u=a.n(d),p=(a("cWXX"),a("/ezw")),m=a("2Taf"),h=a.n(m),f=a("vZ4D"),y=a.n(f),w=a("l4Ni"),g=a.n(w),b=a("ujKo"),v=a.n(b),x=a("MhPg"),S=a.n(x),_=(a("Znn+"),a("ZTPi")),C=a("TSYQ"),E=a.n(C),k=a("tbSg"),L=a.n(k),M=(a("sPJy"),a("bE4q")),O=a("eHn4"),D=a.n(O),V=a("bALw"),I=a.n(V),T=a("S/9j"),F=function(e,t){var a=e[t];return a||Object.keys(e).forEach(function(n){I()(n).test(t)&&(a=e[n])}),a||{}},N=function(e){function t(){var e,a;h()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=g()(this,(e=v()(t)).call.apply(e,[this].concat(r))),a.state={breadcrumb:null},a.getBreadcrumbDom=function(){var e=a.conversionBreadcrumbList();a.setState({breadcrumb:e})},a.getBreadcrumbProps=function(){var e=a.props,t=e.routes,n=e.params,r=e.location,o=e.breadcrumbNameMap;return{routes:t,params:n,routerLocation:r,breadcrumbNameMap:o}},a.conversionFromProps=function(){var e=a.props,t=e.breadcrumbList,n=e.breadcrumbSeparator,r=e.itemRender,o=e.linkElement,l=void 0===o?"a":o;return c.a.createElement(M["a"],{className:L.a.breadcrumb,separator:n},t.map(function(e){var t=r?r(e):e.title;return c.a.createElement(M["a"].Item,{key:e.title},e.href?Object(i["createElement"])(l,D()({},"a"===l?"href":"to",e.href),t):t)}))},a.conversionFromLocation=function(e,t){var n=a.props,r=n.breadcrumbSeparator,o=n.home,l=n.itemRender,s=n.linkElement,d=void 0===s?"a":s,u=Object(T["a"])(e.pathname),p=u.map(function(e,a){var n=F(t,e);if(n.inherited)return null;var r=a!==u.length-1&&n.component,o=l?l(n):n.name;return n.name&&!n.hideInBreadcrumb?c.a.createElement(M["a"].Item,{key:e},Object(i["createElement"])(r?d:"span",D()({},"a"===d?"href":"to",e),o)):null});return p.unshift(c.a.createElement(M["a"].Item,{key:"home"},Object(i["createElement"])(d,D()({},"a"===d?"href":"to","/"),o||"Home"))),c.a.createElement(M["a"],{className:L.a.breadcrumb,separator:r},p)},a.conversionBreadcrumbList=function(){var e=a.props,t=e.breadcrumbList,n=e.breadcrumbSeparator,r=a.getBreadcrumbProps(),o=r.routes,l=r.params,i=r.routerLocation,s=r.breadcrumbNameMap;return t&&t.length?a.conversionFromProps():o&&l?c.a.createElement(M["a"],{className:L.a.breadcrumb,routes:o.filter(function(e){return e.breadcrumbName}),params:l,itemRender:a.itemRender,separator:n}):i&&i.pathname?a.conversionFromLocation(i,s):null},a.itemRender=function(e,t,n,r){var o=a.props.linkElement,l=void 0===o?"a":o,s=n.indexOf(e)===n.length-1;return s||!e.component?c.a.createElement("span",null,e.breadcrumbName):Object(i["createElement"])(l,{href:r.join("/")||"/",to:r.join("/")||"/"},e.breadcrumbName)},a}return S()(t,e),y()(t,[{key:"componentDidMount",value:function(){this.getBreadcrumbDom()}},{key:"componentDidUpdate",value:function(e){var t=this.props.location;if(t&&e.location){var a=e.location.pathname;a!==t.pathname&&this.getBreadcrumbDom()}}},{key:"render",value:function(){var e=this.state.breadcrumb;return e}}]),t}(i["PureComponent"]),A=_["a"].TabPane,R=function(e){function t(){var e,a;h()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=g()(this,(e=v()(t)).call.apply(e,[this].concat(r))),a.onChange=function(e){var t=a.props.onTabChange;t&&t(e)},a}return S()(t,e),y()(t,[{key:"render",value:function(){var e=this.props,t=e.title,a=e.logo,n=e.action,o=e.content,l=e.extraContent,i=e.tabList,s=e.className,d=e.tabActiveKey,u=e.tabDefaultActiveKey,m=e.tabBarExtraContent,h=e.loading,f=void 0!==h&&h,y=e.wide,w=void 0!==y&&y,g=e.hiddenBreadcrumb,b=void 0!==g&&g,v=E()(L.a.pageHeader,s),x={};return void 0!==u&&(x.defaultActiveKey=u),void 0!==d&&(x.activeKey=d),c.a.createElement("div",{className:v},c.a.createElement("div",{className:w?L.a.wide:""},c.a.createElement(p["a"],{loading:f,title:!1,active:!0,paragraph:{rows:3},avatar:{size:"large",shape:"circle"}},b?null:c.a.createElement(N,this.props),c.a.createElement("div",{className:L.a.detail},a&&c.a.createElement("div",{className:L.a.logo},a),c.a.createElement("div",{className:L.a.main},c.a.createElement("div",{className:L.a.row},t&&c.a.createElement("h1",{className:L.a.title},t),n&&c.a.createElement("div",{className:L.a.action},n)),c.a.createElement("div",{className:L.a.row},o&&c.a.createElement("div",{className:L.a.content},o),l&&c.a.createElement("div",{className:L.a.extraContent},l)))),i&&i.length?c.a.createElement(_["a"],r()({className:L.a.tabs},x,{onChange:this.onChange,tabBarExtraContent:m}),i.map(function(e){return c.a.createElement(A,{tab:e.tab,key:e.key})})):null)))}}]),t}(i["PureComponent"]),z=a("MuoO"),H=a("lh+i"),P=a.n(H),Y=function(e){function t(){return h()(this,t),g()(this,v()(t).apply(this,arguments))}return S()(t,e),y()(t,[{key:"render",value:function(){var e=this.props,t=e.contentWidth,a=e.children,n="".concat(P.a.main);return"Fixed"===t&&(n="".concat(P.a.main," ").concat(P.a.wide)),c.a.createElement("div",{className:n},a)}}]),t}(i["PureComponent"]),j=Object(z["connect"])(function(e){var t=e.setting;return{contentWidth:t.contentWidth}})(Y),B=a("Dnn4"),q=a.n(B),K=a("R1Dz"),U=function(e){var t=e.children,a=e.contentWidth,n=e.wrapperClassName,o=e.top,i=l()(e,["children","contentWidth","wrapperClassName","top"]);return c.a.createElement("div",{style:{margin:"-24px -24px 0"},className:n},o,c.a.createElement(K["a"].Consumer,null,function(e){return c.a.createElement(R,r()({wide:"Fixed"===a,home:c.a.createElement(s["FormattedMessage"],{id:"menu.home",defaultMessage:"Home"})},e,{key:"pageheader"},i,{linkElement:u.a,itemRender:function(e){return e.locale?c.a.createElement(s["FormattedMessage"],{id:e.locale,defaultMessage:e.title}):e.title}}))}),t?c.a.createElement("div",{className:q.a.content},c.a.createElement(j,null,t)):null)};Object(z["connect"])(function(e){var t=e.setting;return{contentWidth:t.contentWidth}})(U)},zzGq:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,r,o,l,i,c,s,d=a("bx4M"),u=(a("miYZ"),a("tsqr")),p=a("p0pE"),m=a.n(p),h=a("d6i3"),f=a.n(h),y=a("1l/V"),w=a.n(y),g=a("eHn4"),b=a.n(g),v=(a("2qtc"),a("kLXV")),x=(a("5NDa"),a("5rEg")),S=(a("14J3"),a("BMrR")),_=(a("jCWc"),a("kPKH")),C=(a("+L6B"),a("2/Rp")),E=a("2Taf"),k=a.n(E),L=a("vZ4D"),M=a.n(L),O=a("l4Ni"),D=a.n(O),V=a("ujKo"),I=a.n(V),T=a("MhPg"),F=a.n(T),N=(a("OaEy"),a("2fM7")),A=(a("y8nQ"),a("Vl3Y")),R=a("q1tI"),z=a.n(R),H=a("MuoO"),P=a("wd/R"),Y=a.n(P),j=a("B797"),B=a("CkN6"),q=a("82qg"),K=a("SLv7"),U=a.n(K),Z=(a("S+eF"),a("XS0u")),G=A["a"].Item,Q=N["a"].Option,X=(n=A["a"].create(),n((o=function(e){function t(e){var a;return k()(this,t),a=D()(this,I()(t).call(this,e)),a.onAgencyFeeSelect=function(e,t){a.setState({agencyFee:parseFloat(e)}),console.log(e),console.log(a.state)},a.onDownAccountHandler=function(){var e=a.props,t=e.downAccountHandle,n=e.form,r=a.state.agencyFee;n.validateFields(function(e,a){console.log(a),e||t({rate:r,bank_account:a.bank_account})})},a.state={agencyFee:0},a}return F()(t,e),M()(t,[{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.downCancel,n=e.selectedRows,r=e.form,o=Object(j["b"])(n),l=n.length>0?n[0]:{},i=this.state.agencyFee;return z.a.createElement(v["a"],{destroyOnClose:!0,title:"\u4e0b\u8d26",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:t,onCancel:function(){return a()},footer:[z.a.createElement(C["a"],{key:"btn-cancel",onClick:function(){return a()}},"\u53d6 \u6d88"),z.a.createElement(C["a"],{key:"btn-save",type:"primary",onClick:this.onDownAccountHandler},"\u4fdd \u5b58")],width:800,className:U.a.modalForm},z.a.createElement(A["a"],null,z.a.createElement(S["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(_["a"],null,z.a.createElement(G,{labelCol:{span:3,offset:2},label:"\u4e0b\u8d26\u6761\u6570"},n.length))),z.a.createElement(S["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(_["a"],null,z.a.createElement(G,{labelCol:{span:3,offset:2},label:"\u4e0b\u8d26\u603b\u91d1\u989d"},o.totalActualGoodsFund||"0"," - \u4ee3\u529e\u8d39 *",z.a.createElement(N["a"],{placeholder:"\u8bf7\u9009\u62e9",defaultValue:"0",onSelect:this.onAgencyFeeSelect,style:{width:"80px"}},z.a.createElement(Q,{value:"0"},"0\u2030"),z.a.createElement(Q,{value:"1"},"1\u2030"),z.a.createElement(Q,{value:"2"},"2\u2030"),z.a.createElement(Q,{value:"3"},"3\u2030"),z.a.createElement(Q,{value:"4"},"4\u2030"),z.a.createElement(Q,{value:"5"},"5\u2030")),o.totalTransFunds?z.a.createElement("span",null," `- (\u8fd0\u8d39) $",o.totalTransFunds,"`"):z.a.createElement("span",null),"="," ",o.totalActualGoodsFund-Math.ceil(o.totalActualGoodsFund*i/1e3)-o.totalTransFunds||0))),z.a.createElement(S["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(_["a"],null,z.a.createElement(G,{labelCol:{span:3,offset:2},label:"\u6237\u4e3b"},l.getcustomer_name||"")),z.a.createElement(_["a"],null,z.a.createElement(G,{labelCol:{span:3,offset:2},label:"\u8d26\u6237"},r.getFieldDecorator("bank_account",{initialValue:l.bank_account})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"280px"}}))))),z.a.createElement(S["a"],{gutter:{md:8,lg:24,xl:48}},z.a.createElement(_["a"],null,z.a.createElement(G,{labelCol:{span:3,offset:2},className:U.a.tableDetail,label:"\u660e\u7ec6"},z.a.createElement("table",null,z.a.createElement("thead",null,z.a.createElement("tr",null,z.a.createElement("th",null,"\u8fd0\u5355\u53f7"),z.a.createElement("th",null,"\u5b9e\u6536\u8d27\u6b3e"),z.a.createElement("th",null,"\u5e94\u6536\u8d27\u6b3e"))),z.a.createElement("tbody",null,n.map(function(e){return z.a.createElement("tr",null,z.a.createElement("td",null,e.order_code),z.a.createElement("td",null,e.order_real),z.a.createElement("td",null,e.order_amount))}))))))))}}]),t}(R["PureComponent"]),r=o))||r),W=(l=Object(H["connect"])(function(e){var t=e.common,a=e.customer,n=e.company,r=e.settle,o=e.site,l=e.car,i=e.receiver,c=e.loading;return{common:t,customer:a,company:n,settle:r,site:o,car:l,receiver:i,loading:c.models.rule}}),i=A["a"].create(),l(c=i((s=function(e){function t(){var e,a;k()(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return a=D()(this,(e=I()(t)).call.apply(e,[this].concat(r))),a.state={selectedRows:[],accountStatistic:{},formValues:{},current:1,pageSize:20,record:{},updateOrderModalVisible:!1,settleModalVisible:!1,downModalVisible:!1,signModalVisible:!1,cancelDownAccountModalVisible:!1,downloadModalVisible:!1,printModalVisible:!1,currentCompany:{},currentShipSite:{}},a.columns=[{title:"\u8d27\u5355\u53f7",dataIndex:"order_code",sorter:!0,align:"right",render:function(e){return"".concat(e)},needTotal:!0,width:"60px"},{title:"\u53d1\u8d27\u5ba2\u6237",dataIndex:"sendcustomer_name",width:"80px",sorter:!0},b()({title:"\u6536\u83b7\u5ba2\u6237",dataIndex:"getcustomer_name",sorter:!0,width:"80px"},"sorter",!0),{title:"\u5e94\u6536\u8d27\u6b3e",dataIndex:"order_amount",width:"80px",sorter:!0},{title:"\u5b9e\u6536\u8d27\u6b3e",dataIndex:"order_real",width:"80px",sorter:!0},{title:"\u6298\u540e\u8fd0\u8d39",dataIndex:"trans_discount",width:"80px"},{title:"\u8fd0\u8d39\u65b9\u5f0f",dataIndex:"trans_type",sorter:!0,width:"80px",render:function(e){var t="";return t=1===e?"\u73b0\u4ed8":2===e?"\u56de\u4ed8":"\u63d0\u4ed8",t}},{title:"\u57ab\u4ed8",dataIndex:"order_advancepay_amount",width:"80px"},{title:"\u9001\u8d27\u8d39",dataIndex:"deliver_amount",width:"80px"},{title:"\u4fdd\u4ef7\u8d39",dataIndex:"insurance_fee",width:"80px"},{title:"\u8d27\u7269\u540d\u79f0",dataIndex:"order_name",width:"150px"},{title:"\u5f55\u7968\u65f6\u95f4",dataIndex:"create_date",render:function(e){return z.a.createElement("span",null,e&&Y()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"170px"},{title:"\u7ed3\u7b97\u65f6\u95f4",dataIndex:"settle_date",render:function(e){return z.a.createElement("span",null,e&&Y()(Number(e||0)).format("YYYY-MM-DD HH:mm:ss")||"")},width:"170px"},{title:"\u7ed3\u7b97\u4eba",dataIndex:"settle_user_name",width:"80px"},{title:"\u7ad9\u70b9",dataIndex:"site_name",width:"80px"},{title:"\u4e2d\u8f6c",dataIndex:"transfer_type",render:function(e){var t="";return 1==e?t="\u8f6c\u51fa":2==e&&(t="\u8f6c\u5165"),t},width:"80px"},{title:"\u5907\u6ce8",width:"150px",dataIndex:"remark"}],a.setCurrentCompany=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return 2==Z["a"].company_type?(a.setState({currentCompany:Z["a"]}),Z["a"]):e&&e.length>0?(a.setState({currentCompany:e[0]}),e[0]):{}},a.handleFormReset=function(){var e=a.props,t=e.form,n=e.dispatch;t.resetFields(),a.setState({formValues:{}}),n({type:"rule/fetch",payload:{}})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.onGetCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchGetCustomerList()},a.onSendCustomerScroll=function(e){e.target.scrollHeight<=e.target.scrollTop+e.currentTarget.scrollHeight&&a.fetchSendCustomerList()},a.fetchGetCustomerList=function(){var e=w()(f.a.mark(function e(t){var n,r,o,l;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props,r=n.dispatch,o=n.branchCompanyList,l=a.state.currentCompany,l&&l.company_id||(l=o&&o[0]),r({type:"customer/getCustomerListAction",payload:{filter:{company_id:t||l&&l.company_id||0}}});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fetchSendCustomerList=function(){var e=w()(f.a.mark(function e(t){var n;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=a.props.dispatch,n({type:"customer/sendCustomerListAction",payload:{filter:{}}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onCompanySelect=function(){var e=w()(f.a.mark(function e(t,n){var r,o,l,i;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:r=a.props,o=r.dispatch,l=r.company.branchCompanyList,r.car.lastCar,o({type:"customer/resetCustomerPageNo",payload:{type:"Get"}}),i=l.filter(function(e){if(e.company_id==t)return e}),i.length>0&&a.setState({currentCompany:i[0]}),a.fetchGetCustomerList(t);case 5:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.handleSearch=function(e){e&&e.preventDefault(),a.getOrderList()},a.getOrderList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=a.props,r=n.dispatch,o=n.form,l=a.state,i=l.current,c=l.pageSize;o.validateFields(function(a,n){if(!a){var o=Object.assign({filter:n},e);r({type:"settle/getOrderListAction",payload:m()({pageNo:t||i,pageSize:c},o)}),r({type:"settle/getOrderStatisticAction",payload:m()({},o)})}})},a.handleStandardTableChange=function(){var e=w()(f.a.mark(function e(t,n,r){var o,l,i,c;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a.props.dispatch,o=a.state,o.formValues,l=o.pageSize,i={},c=1,r.field&&(i={sorter:"".concat(r.field,"|").concat(r.order)}),!t||t.pageSize==l){e.next=11;break}return c=1,e.next=9,a.setState({pageSize:t.pageSize});case 9:e.next=12;break;case 11:t&&t.current&&(c=t.current);case 12:return e.next=14,a.setState({current:c});case 14:a.getOrderList(i,c);case 15:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),a.downAccountHandle=function(){var e=w()(f.a.mark(function e(t){var n,r,o,l;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return console.log(t),n=a.props.dispatch,r=a.state.selectedRows,o=r.map(function(e){return e.order_id}),e.next=6,n({type:"settle/downAccountAction",payload:{order_id:o,rate:t.rate,bank_account:t.bank_account}});case 6:l=e.sent,0==l.code?(u["a"].success("\u4e0b\u8d26\u6210\u529f\uff01"),a.onDownCancel(),a.handleSearch()):u["a"].error(l.msg);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onDownAccount=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettle=w()(f.a.mark(function e(){var t,n,r;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=a.state.selectedRows,n=!0,t.forEach(function(e){e.order_status>=7&&(n=!1)}),n){e.next=6;break}return u["a"].error("\u5df2\u4e0b\u8d26\u8ba2\u5355\u4e0d\u80fd\u53d6\u6d88\u7ed3\u7b97"),e.abrupt("return");case 6:r=Object(j["a"])(t),a.setState({accountStatistic:r,settleModalVisible:!0});case 8:case"end":return e.stop()}},e)})),a.onSettleCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({settleModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onSettleOk=w()(f.a.mark(function e(){var t,n,r,o;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"settle/cancelSettleOrderAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(u["a"].success("\u53d6\u6d88\u7ed3\u7b97\u6210\u529f\uff01"),a.onSettleCancel(),a.handleSearch()):u["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onCancelSign=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelDownAccountModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onCancelDownAccountCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({cancelDownAccountModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onCancelDownAccountOk=w()(f.a.mark(function e(){var t,n,r,o;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.props.dispatch,n=a.state.selectedRows,r=n.map(function(e){return e.order_id}),e.next=5,t({type:"settle/cancelDownAccountAction",payload:{order_id:r}});case 5:o=e.sent,0==o.code?(u["a"].success("\u53d6\u6d88\u4e0b\u8d26\u6210\u529f\uff01"),a.handleSearch(),a.onCancelDownAccountCancel()):u["a"].error(o.msg);case 7:case"end":return e.stop()}},e)})),a.onPrint=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onPrintCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({printModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onPrintOk=w()(f.a.mark(function e(){var t,n,r;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"settle/printAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(u["a"].success("\u6253\u5370\u6210\u529f\uff01"),a.onPrintCancel()):u["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onDownload=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!0});case 1:case"end":return e.stop()}},e)})),a.onDownloadCancel=w()(f.a.mark(function e(){return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a.setState({downloadModalVisible:!1});case 1:case"end":return e.stop()}},e)})),a.onDownloadOk=w()(f.a.mark(function e(){var t,n,r;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=a.state.selectedRows,n=t.map(function(e){return e.order_id}),e.next=4,dispatch({type:"settle/downloadAction",payload:{order_id:n}});case 4:r=e.sent,0==r.code?(u["a"].success("\u4e0b\u8f7d\u6210\u529f\uff01"),a.onDownloadCancel()):u["a"].error(r.msg);case 6:case"end":return e.stop()}},e)})),a.onUpdateOrderModalShow=function(){a.setState({updateOrderModalVisible:!0})},a.onUpdateOrderModalCancel=function(){a.setState({updateOrderModalVisible:!1})},a.onRowDoubleClick=function(e,t,n){a.setState({record:e}),a.onUpdateOrderModalShow()},a.onRowClick=function(e,t,a){},a.tableFooter=function(){var e=a.props.settle,t=e.total,n=e.totalOrderAmount,r=e.totalTransAmount,o=e.totalInsurancefee,l=e.totalAdvancepayAmount,i=e.totalDeliverAmount;return z.a.createElement("div",{className:U.a.tableFooter},z.a.createElement("span",null,"\u8d27\u6b3e\u603b\u989d\uff1a",n||"0"),z.a.createElement("span",{className:U.a.footerSplit},"\u8fd0\u8d39\u603b\u989d\uff1a",r||"0"),z.a.createElement("span",{className:U.a.footerSplit},"\u57ab\u4ed8\u603b\u989d\uff1a",l||"0"),z.a.createElement("span",{className:U.a.footerSplit},"\u9001\u8d27\u8d39\u603b\u989d\uff1a",i||"0"),z.a.createElement("span",{className:U.a.footerSplit},"\u4fdd\u4ef7\u8d39\u603b\u989d\uff1a",o||"0"),z.a.createElement("span",{className:U.a.footerSplit},"\u7968\u6570\uff1a",t||"0"))},a}return F()(t,e),M()(t,[{key:"componentDidMount",value:function(){var e=w()(f.a.mark(function e(){var t,a,n,r,o;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.props.dispatch,a=[Z["a"]],2==Z["a"].company_type){e.next=6;break}return e.next=5,t({type:"company/getCompanyList",payload:{}});case 5:a=e.sent;case 6:return e.next=8,t({type:"site/getSiteListAction",payload:{}});case 8:n=e.sent,t({type:"customer/sendCustomerListAction",payload:{pageNo:1,pageSize:100}}),r=this.setCurrentCompany(a),t({type:"customer/getCustomerListAction",payload:{pageNo:1,pageSize:100,filter:{company_id:r.company_id}}}),n&&n.length>0&&(o=n.filter(function(e){return 3==e.site_type||2==e.site_type}),o.length>0&&this.setState({currentShipSite:o[0]})),t({type:"common/initOrderListAction"});case 14:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"renderSimpleForm",value:function(){var e=this.props,t=e.form.getFieldDecorator,a=e.customer,n=a.getCustomerList,r=a.sendCustomerList,o=e.company.branchCompanyList,l=e.site.entrunkSiteList,i=(this.state.currentShipSite,{});o.length>0&&1!=Z["a"].company_type&&(i.initialValue=o[0].company_id||"");var c=1==Z["a"].company_type;return z.a.createElement(A["a"],{onSubmit:this.handleSearch,layout:"inline"},z.a.createElement(G,{label:"\u5206\u516c\u53f8"},t("company_id",i)(z.a.createElement(N["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onCompanySelect,style:{width:"100px"},allowClear:c},o.map(function(e){return z.a.createElement(Q,{key:e.company_id,value:e.company_id},e.company_name)})))),z.a.createElement(G,{label:"\u8fd0\u5355\u53f7"},t("order_code",{})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"150px"}}))),z.a.createElement(G,{label:"\u8d27\u8f66\u7f16\u53f7"},t("shipsite_id",{})(z.a.createElement(N["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onShipSiteSelect,style:{width:"100px"},allowClear:!0},(l||[]).map(function(e){return z.a.createElement(Q,{key:e.site_id,value:e.site_id},e.site_name)}))),t("car_code",{})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"80px"}}))),z.a.createElement(G,{label:"\u6536\u8d27\u4eba\u59d3\u540d"},t("getcustomer_id")(z.a.createElement(N["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onGetCustomerSelect,style:{width:"100px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onGetCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},n.map(function(e){return z.a.createElement(Q,{key:e.customer_id,value:e.customer_id},e.customer_name)})))),z.a.createElement(G,{label:"\u6536\u8d27\u4eba\u7535\u8bdd"},t("getcustomer_mobile",{})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),z.a.createElement(G,{label:"\u53d1\u8d27\u4eba\u59d3\u540d"},t("sendcustomer_id")(z.a.createElement(N["a"],{placeholder:"\u8bf7\u9009\u62e9",onSelect:this.onSendCustomerSelect,style:{width:"100px"},allowClear:!0,showSearch:!0,optionLabelProp:"children",onPopupScroll:this.onSendCustomerScroll,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},r.map(function(e){return z.a.createElement(Q,{key:e.get,value:e.customer_id},e.customer_name)})))),z.a.createElement(G,{label:"\u6536\u8d27\u4eba\u7535\u8bdd"},t("sendcustomer_mobile",{})(z.a.createElement(x["a"],{placeholder:"\u8bf7\u8f93\u5165",style:{width:"130px"}}))),z.a.createElement(G,null,z.a.createElement(C["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2")))}},{key:"renderForm",value:function(){return this.renderSimpleForm()}},{key:"render",value:function(){var e=this,t=this.props,a=t.settle,n=a.orderList,r=a.total,o=(a.totalOrderAmount,a.totalTransAmount,t.loading),l=this.state,i=l.selectedRows,c=l.accountStatistic,s=l.current,u=l.pageSize,p=l.updateOrderModalVisible,m=l.settleModalVisible,h=l.downModalVisible,f=l.signModalVisible,y=l.cancelDownAccountModalVisible,w=l.downloadModalVisible,g=l.printModalVisible,b=l.record,x=!0;"site_admin"==Z["b"].role_value&&(x=!1);var S=!0;return["site_orderuser","site_pay","site_receipt","site_searchuser"].indexOf(Z["b"].role_value)>=0&&(S=!1),z.a.createElement("div",null,z.a.createElement(d["a"],{bordered:!1},z.a.createElement("div",{className:U.a.tableList},z.a.createElement("div",{className:U.a.tableListForm},this.renderForm()),z.a.createElement("div",{className:U.a.tableListOperator},i.length>0&&x&&z.a.createElement("span",null,S&&z.a.createElement(C["a"],{onClick:this.onSettle},"\u53d6\u6d88\u7ed3\u7b97"),z.a.createElement(C["a"],{onClick:this.onPrint},"\u6253\u5370"))),z.a.createElement(B["a"],{selectedRows:i,loading:o,className:U.a.dataTable,scroll:{x:900,y:350},rowKey:"order_id",data:{list:n,pagination:{total:r,pageSize:u,current:s,onShowSizeChange:function(t,a){e.setState({pageSize:a})}}},columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange,onClickHander:this.onRowClick,onDoubleClickHander:this.onRowDoubleClick,rowClassNameHandler:function(e,t){return 6===e.order_status?U.a.settleColor:7===e.order_status?U.a.payColor:""}})),this.tableFooter()),z.a.createElement(q["a"],{modalVisible:p,record:b,onCancelModal:this.onUpdateOrderModalCancel,handleSearch:this.handleSearch}),z.a.createElement(X,{modalVisible:h,downAccountHandle:this.downAccountHandle,downCancel:this.onDownCancel,selectedRows:i}),z.a.createElement(v["a"],{title:"\u53d6\u6d88\u7ed3\u7b97",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:m,onOk:this.onSettleOk,onCancel:this.onSettleCancel},z.a.createElement("p",null,"\u53d6\u6d88\u7ed3\u7b97\u8d27\u6b3e\u6761\u6570".concat(i.length,"\uff0c\u53d6\u6d88\u7ed3\u7b97\u603b\u989d ").concat(c.totalAccount," ")),z.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u7b97\u4e48\uff1f")),z.a.createElement(v["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:f,onOk:this.onSignOk,onCancel:this.onSignCancel},z.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7b7e\u5b57\u4e48\uff1f")),z.a.createElement(v["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:y,onOk:this.onCancelDownAccountOk,onCancel:this.onCancelDownAccountCancel},z.a.createElement("p",null,"\u60a8\u786e\u8ba4\u53d6\u6d88\u4e0b\u8d26\u4e48\uff1f")),z.a.createElement(v["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:g,onOk:this.onPrintOk,onCancel:this.onPrintCancel},z.a.createElement("p",null,"\u60a8\u786e\u8ba4\u7ed3\u8d26\u6253\u5370\u4e48\uff1f")),z.a.createElement(v["a"],{title:"\u786e\u8ba4",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",visible:w,onOk:this.onDownloadOk,onCancel:this.onDownloadCancel},z.a.createElement("p",null,"\u60a8\u786e\u8ba4\u8981\u4e0b\u8f7d\u4e48\uff1f")))}}]),t}(R["PureComponent"]),c=s))||c)||c);t["default"]=W}}]);